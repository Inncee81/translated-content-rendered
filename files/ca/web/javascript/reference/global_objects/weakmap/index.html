---
title: WeakMap
slug: Web/JavaScript/Reference/Global_Objects/WeakMap
tags:
  - ECMAScript6
  - Experimental
  - JavaScript
  - NeedsTranslation
  - TopicStub
  - WeakMap
translation_of: Web/JavaScript/Reference/Global_Objects/WeakMap
---
<div><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals">Objectes estandards</a></strong></li><li><strong><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/Web"><code>Web</code></a></strong></li><li><strong>Herència</strong></li><li><strong><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/Function"><code>Function</code></a></strong></li><li><a href="#"><strong>Propietats</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/arguments"><code>Function.arguments</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/caller"><code>Function.caller</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/displayName"><code>Function.displayName</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/displayName$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/length"><code>Function.length</code></a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/name"><code>Function.name</code></a></li></ol></li><li><a href="#"><strong>Mètodes</strong></a><ol><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>Function.prototype.apply()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/apply$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>Function.prototype.bind()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/bind$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>Function.prototype.call()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/call$translate" style="opacity: 0.5;">[Traduir]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/toSource"><code>Function.prototype.toSource()</code></a></s></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/toString"><code>Function.prototype.toString()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Function/toString$translate" style="opacity: 0.5;">[Traduir]</a></li></ol></li><li><strong><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/Object"><code>Object</code></a></strong></li><li><a href="#"><strong>Propietats</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/proto"><code>Object.prototype.__proto__</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/proto$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor"><code>Object.prototype.constructor</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor$translate" style="opacity: 0.5;">[Traduir]</a></li></ol></li><li><a href="#"><strong>Mètodes</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__"><code>Object.prototype.__defineGetter__()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__$translate" style="opacity: 0.5;">[Traduir]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineSetter__"><code>Object.prototype.__defineSetter__()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineSetter__$translate" style="opacity: 0.5;">[Traduir]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupGetter__"><code>Object.prototype.__lookupGetter__()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupGetter__$translate" style="opacity: 0.5;">[Traduir]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupSetter__"><code>Object.prototype.__lookupSetter__()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupSetter__$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty"><code>Object.prototype.hasOwnProperty()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/isPrototypeOf"><code>Object.prototype.isPrototypeOf()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/isPrototypeOf$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable"><code>Object.prototype.propertyIsEnumerable()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toLocaleString"><code>Object.prototype.toLocaleString()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toLocaleString$translate" style="opacity: 0.5;">[Traduir]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toSource"><code>Object.prototype.toSource()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toSource$translate" style="opacity: 0.5;">[Traduir]</a></s></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toString"><code>Object.prototype.toString()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/toString$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/valueOf"><code>Object.prototype.valueOf()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/valueOf$translate" style="opacity: 0.5;">[Traduir]</a></li><li><a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf"><code>Object.setPrototypeOf()</code></a> <a href="/ca/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf$translate" style="opacity: 0.5;">[Traduir]</a></li></ol></li></ol></section></div>

<p>L&apos;objecte <strong><code>WeakMap</code></strong> és una col·lecció de parelles clau/valor on les claus són dèbilment referenciades. Les claus han de ser objectes i els valors poden ser valors aribitraris.</p>

<h2 id="Sintaxi">Sintaxi</h2>

<pre class="syntaxbox notranslate"><code>new WeakMap([iterable])
</code></pre>

<h3 id="Paràmetres">Paràmetres</h3>

<dl>
 <dt><code>iterable</code></dt>
 <dd>Iterable és un Array o un altre objecte iterable el qual els seus elements són parelles clau/valor (Array de 2 elements). Cada parella clau/valor serà afegida al nou WeakMap. null és tractat com a undefined.</dd>
</dl>

<h2 id="Descripció">Descripció</h2>

<p>Les claus de WeakMaps són només de tipus <code>Object.</code> <a href="/ca/docs/Glossary/Primitiu">Primitive data types</a> com a claus no són permesos (e.g. a <a href="/ca/docs/Web/JavaScript/Referencia/Symbol"><code>Symbol</code></a> no pot ser una clau <code>WeakMap</code>).</p>

<p>La clau d&apos;un WeakMap es sostè dèbilment.  El que significa que, si no hi ha altres referències fortes a la clau, llavors la entrada sencera serà eliminada del WeakMap pel recol·lector de brossa (garbage collector).</p>

<h3 id="Per_què_WeakMap">Per què <em>Weak</em>Map?</h3>

<p>El programador expert en JavaScript s&apos;adonarà que aquesta API es podria implementar en JavaScript amb dos arrays (una per a claus, i una per valors) compartides pels quatre mètodes de l&apos;API. Tal implementació tindria dos inconvenients principals. El primer és que la cerca té un cost de O(n) (on n és el nombre de claus al mapa). El segon és que té problemes de fuita de memòria (memory leak). Amb els mapes mantinguts manualment, l&apos;array de claus mantindria referències a le objectes clau, evitant que aquests fóssin eliminats de memòria pel recol·lector de brossa. Als WeakMaps natius, les referències als objectes clau són &quot;dèbils&quot;, que vol dir que el recol·lector de brossa pot eliminar l&apos;objecte de memòria si aquest només és referenciat per referències dèbils.</p>

<p>Degut a que les referències són dèbils les claus del WeakMap no són enumerables (és a dir, no hi ha cap mètode que us retornarà un llistat de claus). Si aquest mètode existís, aquest dependria de l&apos;estat del recol·lector de brossa, introduïnt un comportament no determinista. Si voleu tenir un llistat amb les claus, l&apos;haureu de mantenir pel vostre compte.</p>

<h2 id="Propietats">Propietats</h2>

<dl>
 <dt><code>WeakMap.length</code></dt>
 <dd>El valor de la propietat <code>length</code> és 0.</dd>
 <dt><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/WeakMap/prototype"><code>WeakMap.prototype</code></a></dt>
 <dd>Representa el prototip pel constructor <code>WeakMap.</code> Permet l&apos;adició de propietats a tots els objectes <code>WeakMap.</code></dd>
</dl>

<h2 id="Instàncies_WeakMap">Instàncies <code>WeakMap</code></h2>

<p>Totes les instàncies <code>WeakMap</code> hereten de <a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/WeakMap/prototype"><code>WeakMap.prototype</code></a>.</p>

<h3 id="Propietats_2">Propietats</h3>



<h3 id="Mètodes">Mètodes</h3>



<h2 id="Exemples">Exemples</h2>

<h3 id="Utilitzar_WeakMap">Utilitzar <code>WeakMap</code></h3>

<pre class="brush: js notranslate">var wm1 = new WeakMap(),
    wm2 = new WeakMap(),
    wm3 = new WeakMap();
var o1 = {},
    o2 = function(){},
    o3 = window;

wm1.set(o1, 37);
wm1.set(o2, &quot;azerty&quot;);
wm2.set(o1, o2); // un valor pot ser qualsevol cosa, incloent un objecte object o una funció
wm2.set(o3, undefined);
wm2.set(wm1, wm2); // claus i valors poden ser qualsevol objecte. Fins i tot WeakMaps!

wm1.get(o2); // &quot;azerty&quot;
wm2.get(o2); // undefined, ja que no hi ha cap valor per o2 a wm2
wm2.get(o3); // undefined, al tenir assignat aquest valor

wm1.has(o2); // true
wm2.has(o2); // false
wm2.has(o3); // true (encara que el valor en si sigui &apos;undefined&apos;)

wm3.set(o1, 37);
wm3.get(o1); // 37

wm1.has(o1); // true
wm1.delete(o1);
wm1.has(o1); // false
</pre>

<h3 id="Implementar_una_classe_tipus_WeakMap_amb_un_mètode_.clear">Implementar una classe tipus <code>WeakMap</code> amb un mètode .clear()</h3>

<p>Amb fins expositius, l&apos;exemple següent utilitza el nou constructor <code>class</code> d&apos; ECMAScript 6, el qual no està àmpliament implementat.</p>

<pre class="brush: js notranslate">class ClearableWeakMap {
  constructor(init) {
    this._wm = new WeakMap(init)
  }
  clear() {
    this._wm = new WeakMap()
  }
  delete(k) {
    return this._wm.delete(k)
  }
  get(k) {
    return this._wm.get(k)
  }
  has(k) {
    return this._wm.has(k)
  }
  set(k, v) {
    this._wm.set(k, v)
    return this
  }
}
</pre>

<h2 id="Especificacions">Especificacions</h2>

<table class="standard-table">
 <thead>
  <tr>
   <th scope="col">Especificació</th>
   <th scope="col">Estat</th>
   <th scope="col">Comentaris</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td><a class="external" href="https://www.ecma-international.org/ecma-262/6.0/#sec-weakmap-objects" hreflang="en" lang="en">ECMAScript 2015 (6th Edition, ECMA-262)<br><small lang="ca">The definition of &apos;WeakMap&apos; in that specification.</small></a></td>
   <td><span class="spec-Standard">Standard</span></td>
   <td>Definició inicial.</td>
  </tr>
 </tbody>
</table>

<h2 id="Compatibilitat_amb_navegadors">Compatibilitat amb navegadors</h2>

<div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/ca/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Desktop</a></li>
        <li><a>Mobile</a></li>
    </ul>
</div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Característica</th>
   <th>Chrome</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari</th>
  </tr>
  <tr>
   <td>Suport bàsic</td>
   <td>36</td>
   <td><a href="/en-US/Firefox/Releases/6">6.0</a> (6.0)</td>
   <td>11</td>
   <td>23</td>
   <td>7.1</td>
  </tr>
  <tr>
   <td><code>new WeakMap(iterable)</code></td>
   <td>38</td>
   <td><a href="/en-US/Firefox/Releases/36">36</a> (36)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td>25</td>
   <td><span style="color: #f00;">No support</span></td>
  </tr>
  <tr>
   <td><code>clear()</code></td>
   <td>36</td>
   <td><a href="/en-US/Firefox/Releases/20">20.0</a> (20.0)</td>
   <td>11</td>
   <td>23</td>
   <td>7.1</td>
  </tr>
  <tr>
   <td>Constructor argument: <code>new WeakMap(null)</code></td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><a href="/en-US/Firefox/Releases/37">37</a> (37)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
  <tr>
   <td>Monkey-patched <code>set()</code> in constructor</td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><a href="/en-US/Firefox/Releases/37">37</a> (37)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
  <tr>
   <td><code>WeakMap()</code> without <code>new</code> throws</td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><a href="/en-US/Firefox/Releases/42">42</a> (42)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Característica</th>
   <th>Chrome for Android</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
  </tr>
  <tr>
   <td>Suport bàsic</td>
   <td>35</td>
   <td>6.0 (6.0)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: #f00;">No support</span></td>
   <td>8</td>
  </tr>
  <tr>
   <td><code>new WeakMap(iterable)</code></td>
   <td>38</td>
   <td>36.0 (36)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: #f00;">No support</span></td>
  </tr>
  <tr>
   <td><code>clear()</code></td>
   <td>35</td>
   <td>20.0 (20.0)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: #f00;">No support</span></td>
   <td>8</td>
  </tr>
  <tr>
   <td>Constructor argument: <code>new WeakMap(null)</code></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>37.0 (37)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
  <tr>
   <td>Monkey-patched <code>set()</code> in constructor</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>37.0 (37)</td>
   <td><span style="color: #f00;">No support</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
  <tr>
   <td><code>WeakMap()</code> without <code>new</code> throws</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>42.0 (42)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
  </tr>
 </tbody>
</table>
</div>

<h2 id="Vegeu_també">Vegeu també</h2>

<ul>
 <li><a class="link-https" href="https://bugzilla.mozilla.org/show_bug.cgi?id=547941">Bug de WeakMap a Mozilla</a></li>
 <li><a href="http://fitzgeraldnick.com/weblog/53/">Amagant detalls d&apos;implementació amb els WeakMaps de l&apos;ECMAScript 6</a></li>
 <li><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/Map"><code>Map</code></a></li>
 <li><a href="/ca/docs/Web/JavaScript/Referencia/Objectes_globals/Set"><code>Set</code></a></li>
 <li><a href="/ca/docs/Web/JavaScript/Referencia/WeakSet"><code>WeakSet</code></a></li>
</ul>
