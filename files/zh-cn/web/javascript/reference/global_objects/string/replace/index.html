---
title: String.prototype.replace()
slug: Web/JavaScript/Reference/Global_Objects/String/replace
tags:
  - JavaScript
  - Method
  - Prototype
  - Regular
  - String
translation_of: Web/JavaScript/Reference/Global_Objects/String/replace
---
<div><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects">JavaScript 标准库</a></strong></li><li><strong><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String"><code>String</code></a></strong></li><li data-default-state="open"><a href="#"><strong>属性</strong></a><ol><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/length"><code>String.length</code></a></li></ol></li><li data-default-state="open"><a href="#"><strong>方法</strong></a><ol><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fromCharCode"><code>String.fromCharCode()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint"><code>String.fromCodePoint()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/anchor"><code>String.prototype.anchor()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/big"><code>String.prototype.big()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/blink"><code>String.prototype.blink()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/bold"><code>String.prototype.bold()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/charAt"><code>String.prototype.charAt()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt"><code>String.prototype.charCodeAt()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt"><code>String.prototype.codePointAt()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/concat"><code>String.prototype.concat()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith"><code>String.prototype.endsWith()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fixed"><code>String.prototype.fixed()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fontcolor"><code>String.prototype.fontcolor()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fontsize"><code>String.prototype.fontsize()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/includes"><code>String.prototype.includes()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf"><code>String.prototype.indexOf()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/italics"><code>String.prototype.italics()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/lastIndexOf"><code>String.prototype.lastIndexOf()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/link"><code>String.prototype.link()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare"><code>String.prototype.localeCompare()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/match"><code>String.prototype.match()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/matchAll"><code>String.prototype.matchAll()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/normalize"><code>String.prototype.normalize()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd"><code>String.prototype.padEnd()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/padStart"><code>String.prototype.padStart()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/repeat"><code>String.prototype.repeat()</code></a></li><li><em><code>String.prototype.replace()</code></em></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll"><code>String.prototype.replaceAll()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/search"><code>String.prototype.search()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/slice"><code>String.prototype.slice()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/small"><code>String.prototype.small()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/split"><code>String.prototype.split()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith"><code>String.prototype.startsWith()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/strike"><code>String.prototype.strike()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/sub"><code>String.prototype.sub()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/substr"><code>String.prototype.substr()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/substring"><code>String.prototype.substring()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/sup"><code>String.prototype.sup()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toLocaleLowerCase"><code>String.prototype.toLocaleLowerCase()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toLocaleUpperCase"><code>String.prototype.toLocaleUpperCase()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase"><code>String.prototype.toLowerCase()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toSource"><code>String.prototype.toSource()</code></a></s></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toString"><code>String.prototype.toString()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toUpperCase"><code>String.prototype.toUpperCase()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/Trim"><code>String.prototype.trim()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/TrimRight"><code>String.prototype.trimRight()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/TrimLeft"><code>String.prototype.trimStart()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/valueOf"><code>String.prototype.valueOf()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/@@iterator"><code>String.prototype[@@iterator]()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/raw"><code>String.raw()</code></a></li></ol></li><li><strong>继承</strong></li><li><strong><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function"><code>Function</code></a></strong></li><li><a href="#"><strong>属性</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/arguments"><code>Function.arguments</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/caller"><code>Function.caller</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/displayName"><code>Function.displayName</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/length"><code>Function.length</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/name"><code>Function.name</code></a></li></ol></li><li><a href="#"><strong>方法</strong></a><ol><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply"><code>Function.prototype.apply()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>Function.prototype.bind()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call"><code>Function.prototype.call()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/toSource"><code>Function.prototype.toSource()</code></a></s></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/toString"><code>Function.prototype.toString()</code></a></li></ol></li><li><strong><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object"><code>Object</code></a></strong></li><li><a href="#"><strong>属性</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/proto"><code>Object.prototype.__proto__</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor"><code>Object.prototype.constructor</code></a></li></ol></li><li><a href="#"><strong>方法</strong></a><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineGetter__"><code>Object.prototype.__defineGetter__()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/__defineSetter__"><code>Object.prototype.__defineSetter__()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupGetter__"><code>Object.prototype.__lookupGetter__()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/__lookupSetter__"><code>Object.prototype.__lookupSetter__()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty"><code>Object.prototype.hasOwnProperty()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/isPrototypeOf"><code>Object.prototype.isPrototypeOf()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/propertyIsEnumerable"><code>Object.prototype.propertyIsEnumerable()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/toLocaleString"><code>Object.prototype.toLocaleString()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This API has not been standardized."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/toSource"><code>Object.prototype.toSource()</code></a></s></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/toString"><code>Object.prototype.toString()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/valueOf"><code>Object.prototype.valueOf()</code></a></li><li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf"><code>Object.setPrototypeOf()</code></a></li></ol></li></ol></section></div>

<p><strong><code>replace()</code></strong> 方法返回一个由替换值（<code>replacement</code>）替换部分或所有的模式（<code>pattern</code>）匹配项后的新字符串。模式可以是一个字符串或者一个<a href="/zh-CN/docs/Web/JavaScript/Reference/RegExp">正则表达式</a>，替换值可以是一个字符串或者一个每次匹配都要调用的回调函数。<strong>如果<code>pattern</code>是字符串，则仅替换第一个匹配项。</strong></p>

<p>原字符串不会改变。</p>

<div><iframe class="interactive interactive-js" frameborder="0" height="250" src="https://interactive-examples.mdn.mozilla.net/pages/js/string-replace.html" title="MDN Web Docs Interactive Example" width="100%"></iframe></div>

<p class="hidden">The source for this interactive example is stored in a GitHub repository. If you&apos;d like to contribute to the interactive examples project, please clone <a href="https://github.com/mdn/interactive-examples">https://github.com/mdn/interactive-examples</a> and send us a pull request.</p>

<h2 id="语法">语法</h2>

<pre class="syntaxbox notranslate"><code><var>str</var>.replace(<var>regexp</var>|<var>substr</var>, <var>newSubStr</var>|<var>function</var>)</code></pre>

<h3 id="参数">参数</h3>

<dl>
 <dt><code>regexp </code>(pattern)</dt>
 <dd>一个<a href="/zh-CN/docs/Web/JavaScript/Reference/RegExp"><code>RegExp</code></a> 对象或者其字面量。该正则所匹配的内容会被第二个参数的返回值替换掉。</dd>
</dl>

<dl>
 <dt><code>substr </code>(pattern)</dt>
 <dd>一个将被 <code>newSubStr</code> 替换的 <a href="/zh-CN/docs/Web/JavaScript/Reference/String"><code>字符串</code></a>。其被视为一整个字符串，而不是一个正则表达式。仅第一个匹配项会被替换。</dd>
</dl>

<dl>
 <dt><code>newSubStr</code> (replacement)</dt>
 <dd>用于替换掉第一个参数在原字符串中的匹配部分的<a href="/zh-CN/docs/Web/JavaScript/Reference/String"><code>字符串</code></a>。该字符串中可以内插一些特殊的变量名。参考下面的<a href="#使用字符串作为参数">使用字符串作为参数</a>。</dd>
</dl>

<dl>
 <dt><code>function</code> (replacement)</dt>
 <dd>一个用来创建新子字符串的函数，该函数的返回值将替换掉第一个参数匹配到的结果。参考下面的<a href="#指定一个函数作为参数">指定一个函数作为参数</a>。</dd>
</dl>

<h3 id="返回值">返回值</h3>

<p>一个部分或全部匹配由替代模式所取代的新的字符串。</p>

<h2 id="描述">描述</h2>

<p>该方法并不改变调用它的字符串本身，而只是返回一个新的替换后的字符串。</p>

<p>在进行全局的搜索替换时，正则表达式需包含 <code>g</code> 标志。</p>

<h3 id="使用字符串作为参数">使用字符串作为参数</h3>

<p>替换字符串可以插入下面的特殊变量名：</p>

<table class="fullwidth-table">
 <tbody>
  <tr>
   <td class="header">变量名</td>
   <td class="header">代表的值</td>
  </tr>
  <tr>
   <td><code>$$</code></td>
   <td>插入一个 &quot;$&quot;。</td>
  </tr>
  <tr>
   <td><code>$&amp;</code></td>
   <td>插入匹配的子串。</td>
  </tr>
  <tr>
   <td><code>$`</code></td>
   <td>插入当前匹配的子串左边的内容。</td>
  </tr>
  <tr>
   <td><code>$&apos;</code></td>
   <td>插入当前匹配的子串右边的内容。</td>
  </tr>
  <tr>
   <td style="white-space: nowrap;"><code>$<em>n</em></code></td>
   <td>
    <p>假如第一个参数是 <a href="/zh-CN/docs/Web/JavaScript/Reference/RegExp"><code>RegExp</code></a>对象，并且 n 是个小于100的非负整数，那么插入第 n 个括号匹配的字符串。提示：索引是从1开始。如果不存在第 n个分组，那么将会把匹配到到内容替换为字面量。比如不存在第3个分组，就会用“$3”替换匹配到的内容。</p>
   </td>
  </tr>
  <tr>
   <td style="white-space: nowrap;"><code><em>$&lt;Name&gt;</em></code></td>
   <td> 这里<em><code>Name</code></em> 是一个分组名称。如果在正则表达式中并不存在分组（或者没有匹配），这个变量将被处理为空字符串。只有在支持命名分组捕获的浏览器中才能使用。</td>
  </tr>
 </tbody>
</table>

<h3 id="指定一个函数作为参数">指定一个函数作为参数</h3>

<p>你可以指定一个函数作为第二个参数。在这种情况下，当匹配执行后，该函数就会执行。 函数的返回值作为替换字符串。 (注意：上面提到的特殊替换参数在这里不能被使用。) 另外要注意的是，如果第一个参数是正则表达式，并且其为全局匹配模式，那么这个方法将被多次调用，每次匹配都会被调用。</p>

<p>下面是该函数的参数：</p>

<table class="fullwidth-table">
 <tbody>
  <tr>
   <td class="header">变量名</td>
   <td class="header">代表的值</td>
  </tr>
  <tr>
   <td><code>match</code></td>
   <td>匹配的子串。（对应于上述的$&amp;。）</td>
  </tr>
  <tr>
   <td><code>p1,p2, ...</code></td>
   <td>
    <p>假如replace()方法的第一个参数是一个<a href="/zh-CN/docs/Web/JavaScript/Reference/RegExp"><code>RegExp</code></a> 对象，则代表第n个括号匹配的字符串。（对应于上述的$1，$2等。）例如，如果是用 <code>/(\a+)(\b+)/</code> 这个来匹配，<code>p1</code> 就是匹配的 <code>\a+</code>，<code>p2</code> 就是匹配的 <code>\b+</code>。</p>
   </td>
  </tr>
  <tr>
   <td><code>offset</code></td>
   <td>
    <p>匹配到的子字符串在原字符串中的偏移量。（比如，如果原字符串是 <code>&apos;abcd&apos;</code>，匹配到的子字符串是 <code>&apos;bc&apos;</code>，那么这个参数将会是 1）</p>
   </td>
  </tr>
  <tr>
   <td><code>string</code></td>
   <td>被匹配的原字符串。</td>
  </tr>
  <tr>
   <td>NamedCaptureGroup</td>
   <td>命名捕获组匹配的对象</td>
  </tr>
 </tbody>
</table>

<p>(精确的参数个数依赖于 <code>replace()</code> 的第一个参数是否是一个正则表达式（<a href="/zh-CN/docs/Web/JavaScript/Reference/RegExp"><code>RegExp</code></a>）对象，以及这个正则表达式中指定了多少个括号子串，如果这个正则表达式里使用了命名捕获， 还会添加一个命名捕获的对象)</p>

<p>下面的例子将会使 <code>newString</code> 变成 <code>&apos;abc - 12345 - #$*%&apos;</code>：</p>

<pre class="brush: js notranslate">function replacer(match, p1, p2, p3, offset, string) {
  // p1 is nondigits, p2 digits, and p3 non-alphanumerics
  return [p1, p2, p3].join(&apos; - &apos;);
}
var newString = &apos;abc12345#$*%&apos;.replace(/([^\d]*)(\d*)([^\w]*)/, replacer);
console.log(newString);  // abc - 12345 - #$*%
</pre>

<h2 id="Examples" name="Examples">示例</h2>

<h3 id="在_replace_中使用正则表达式">在 <code>replace()</code> 中使用正则表达式</h3>

<p>在下面的例子中，<code>replace()</code> 中使用了正则表达式及忽略大小写标示。</p>

<pre class="brush: js notranslate">var str = &apos;Twas the night before Xmas...&apos;;
var newstr = str.replace(/xmas/i, &apos;Christmas&apos;);
console.log(newstr);  // Twas the night before Christmas...
</pre>

<h3 id="在_replace_中使用_global_和_ignore_选项">在 <code>replace()</code> 中使用 <code>global</code> 和 <code>ignore</code> 选项</h3>

<p>下面的例子中,正则表达式包含有全局替换(g)和忽略大小写(i)的选项,这使得replace方法用&apos;oranges&apos;替换掉了所有出现的&quot;apples&quot;.</p>

<pre class="brush: js notranslate">var re = /apples/gi;
var str = &quot;Apples are round, and apples are juicy.&quot;;
var newstr = str.replace(re, &quot;oranges&quot;);

// oranges are round, and oranges are juicy.
console.log(newstr);
</pre>

<h3 id="交换字符串中的两个单词">交换字符串中的两个单词</h3>

<p>下面的例子演示了如何交换一个字符串中两个单词的位置，这个脚本使用$1 和 $2 代替替换文本。</p>

<pre class="brush: js notranslate">var re = /(\w+)\s(\w+)/;
var str = &quot;John Smith&quot;;
var newstr = str.replace(re, &quot;$2, $1&quot;);
// Smith, John
console.log(newstr);
</pre>

<h3 id="使用行内函数来修改匹配到的字符。">使用行内函数来修改匹配到的字符。</h3>

<p>在这个例子中，所有出现的大写字母转换为小写，并且在匹配位置前加一个连字符。重要的是，在返回一个替换了的字符串前，在匹配元素前进行添加操作是必要的。</p>

<p>在返回前，替换函数允许匹配片段作为参数，并且将它和连字符进行连接作为新的片段。</p>

<pre class="brush: js notranslate">function styleHyphenFormat(propertyName) {
  function upperToHyphenLower(match) {
    return &apos;-&apos; + match.toLowerCase();
  }
  return propertyName.replace(/[A-Z]/g, upperToHyphenLower);
}
</pre>

<p>运行 <code>styleHyphenFormat(&apos;borderTop&apos;)</code><code>，</code><span>将</span><span>返回 &apos;border-top&apos;。</span></p>

<p>因为我们想在最终的替换中进一步转变匹配结果，所以我们必须使用一个函数。这迫使我们在使用<a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase"><code>toLowerCase()</code></a>方法前进行评估。如果我们尝试不用一个函数进行匹配，那么使用<a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase"><code>toLowerCase()</code></a> 方法将不会有效。</p>

<pre class="brush: js notranslate">var newString = propertyName.replace(/[A-Z]/g, &apos;-&apos; + &apos;$&amp;&apos;.toLowerCase());  // won&apos;t work
</pre>

<p>这是因为 <code>&apos;$&amp;&apos;.toLowerCase()</code> 会先被解析成字符串字面量（这会导致相同的&apos;$&amp;&apos;)而不是当作一个模式。</p>

<h3 id="将华氏温度转换为对等的摄氏温度">将华氏温度转换为对等的摄氏温度</h3>

<p>下面的例子演示如何将华氏温度转换为对等的摄氏温度。华氏温度用一个数字加一个&quot;F&quot;来表示，这个函数将返回一个数字加&quot;C&quot;来表示的摄氏温度。例如，如果输入是 212F，这个函数将返回 100C。如果输入的数字是 0F，这个方法将返回 &quot;-17.77777777777778C&quot;。</p>

<p>正则表达式test检查任何数字是否以 F 结尾。华氏温度通过第二个参数p1进入函数。这个函数基于华氏温度作为字符串传递给f2c函数设置成摄氏温度。然后f2c()返回摄氏温度。这个函数与Perl的 s///e 标志相似。</p>

<pre class="brush: js notranslate">function f2c(x)
{
  function convert(str, p1, offset, s)
  {
    return ((p1-32) * 5/9) + &quot;C&quot;;
  }
  var s = String(x);
  var test = /(\d+(?:\.\d*)?)F\b/g;
  return s.replace(test, convert);
}
</pre>

<h3 id="使用行内函数和正则来避免循环">使用行内函数和正则来避免循环</h3>

<p>下例把某种模式的字符串转换为一个对象数组（其元素为对象）。</p>

<p><strong>输入：</strong><br>
 一个由 x，- 和 _ 组成的字符串。</p>

<pre class="notranslate">x-x_

---x---x---x---

-xxx-xx-x-

_x_x___x___x___
</pre>

<p><strong>输出：</strong></p>

<p>一个数组对象。&apos;x&apos; 产生一个 &apos;on&apos; 状态，&apos;-&apos;（连接符）产生一个 &apos;off&apos; 状态，而 &apos;_&apos; （下划线）表示 &apos;on&apos; 状态的长度。</p>

<pre class="brush: js notranslate">[
  { on: true, length: 1 },
  { on: false, length: 1 },
  { on: true, length: 2 }
  ...
]</pre>

<p>代码片段：</p>

<pre class="brush: js notranslate">var str = &apos;x-x_&apos;;
var retArr = [];
str.replace(/(x_*)|(-)/g, function(match, p1, p2) {
  if (p1) { retArr.push({ on: true, length: p1.length }); }
  if (p2) { retArr.push({ on: false, length: 1 }); }
});

console.log(retArr);</pre>

<p>该代码片段生成了一个数组，包含三个期望格式的对象，避免了使用 for 循环语句。</p>

<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a class="external" href="https://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf" hreflang="en" lang="en" title="ECMAScript 3rd Edition (ECMA-262)">ECMAScript 3rd Edition (ECMA-262)</a></td>
   <td><span class="spec-Standard">Standard</span></td>
   <td>Initial definition. Implemented in JavaScript 1.2.</td>
  </tr>
  <tr>
   <td><a class="external" href="https://www.ecma-international.org/ecma-262/5.1/#sec-15.5.4.11" hreflang="en" lang="en">ECMAScript 5.1 (ECMA-262)<br><small lang="zh-CN">String.prototype.replace</small></a></td>
   <td><span class="spec-Standard">Standard</span></td>
   <td></td>
  </tr>
  <tr>
   <td><a class="external" href="https://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype.replace" hreflang="en" lang="en">ECMAScript 2015 (6th Edition, ECMA-262)<br><small lang="zh-CN">String.prototype.replace</small></a></td>
   <td><span class="spec-Standard">Standard</span></td>
   <td></td>
  </tr>
  <tr>
   <td><a class="external" href="https://tc39.es/ecma262/#sec-string.prototype.replace" hreflang="en" lang="en">ECMAScript (ECMA-262)<br><small lang="zh-CN">String.prototype.replace</small></a></td>
   <td><span class="spec-Living">Living Standard</span></td>
   <td></td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<p class="hidden">The compatibility table in this page is generated from structured data. If you&apos;d like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>

<div class="bc-data" id="bcd:javascript.builtins.String.replace"></div>

<h3 id="Firefox_备注">Firefox 备注</h3>

<ul>
 <li><code>flags</code> 是一个仅在 Gecko 中可用的非标准的第三方参数：<code><var>str</var>.replace(<var>regexp</var>|<var>substr</var>, <var>newSubStr</var>|<var>function, flags</var>)</code></li>
 <li>从 Gecko 27 (Firefox 27 / Thunderbird 27 / SeaMonkey 2.24) 开始，这个方法就被整合到了ECMAScript规范中。当 replace() 被使用全局 g 标志的正则表达式调用时，<a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/lastIndex"><code>RegExp.lastIndex</code></a> 属性将被重置为 0（<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=501739">bug 501739</a>）。</li>
 <li>从 Gecko 39 (Firefox 39 / Thunderbird 39 / SeaMonkey 2.36) 开始，<code>flags</code> 参数便被弃用，且在调用时会抛出一个控制台警告（<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1142351">bug 1142351</a>）。</li>
 <li>从 Gecko 47 (Firefox 47 / Thunderbird 47 / SeaMonkey 2.44) 开始，在非发行版本中已不再支持非标准的 <code>flags</code> 参数，并且不久后会完全移除该参数（<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1245801">bug 1245801</a>）。</li>
 <li>从 Gecko 49 (Firefox 49 / Thunderbird 49 / SeaMonkey 2.46) 开始，不再支持非标准的 <code>flags</code> 参数（<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1108382">bug 1108382</a>）。</li>
</ul>

<h2 id="参见">参见</h2>

<ul>
 <li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/match"><code>String.prototype.match()</code></a></li>
 <li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec"><code>RegExp.prototype.exec()</code></a></li>
 <li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test"><code>RegExp.prototype.test()</code></a></li>
</ul>
