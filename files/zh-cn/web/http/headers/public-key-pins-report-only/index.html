---
title: Public-Key-Pins-Report-Only
slug: Web/HTTP/Headers/Public-Key-Pins-Report-Only
tags:
  - HPKP
  - HTTP
  - 头部
  - 安全
translation_of: Web/HTTP/Headers/Public-Key-Pins-Report-Only
---
<div>HTTP响应头部<code><strong>Public-Key-Pins-Report-Only</strong></code>用于设置在公钥固定不匹配时，发送错误信息到<code>report-uri。</code> 但和<a href="/zh-CN/docs/Web/HTTP/Headers/Public-Key-Pins" title="Public-Key-Pins 是一个响应首部，其包含该Web 服务器用来进行加密的 public key （公钥）信息 ，以此来降低使用伪造证书进行 MITM  （中间人攻击）的风险。如果锚定的加密串与服务器返回的公钥不匹配，那么浏览器将会认定响应不合法，并且不会将结果展示给用户。"><code>Public-Key-Pins</code></a>不同的是，即便公钥固定异常, 其允许浏览器继续访问服务器。</div>

<p> </p>

<p>更多信息可以查看<a href="/zh-CN/docs/Web/HTTP/Headers/Public-Key-Pins" title="Public-Key-Pins 是一个响应首部，其包含该Web 服务器用来进行加密的 public key （公钥）信息 ，以此来降低使用伪造证书进行 MITM  （中间人攻击）的风险。如果锚定的加密串与服务器返回的公钥不匹配，那么浏览器将会认定响应不合法，并且不会将结果展示给用户。"><code>Public-Key-Pins</code></a>参考页面和<a href="/en-US/docs/Web/HTTP/Public_Key_Pinning">HTTP Public Key Pinning</a>文章</p>

<p> </p>

<table class="properties">
 <tbody>
  <tr>
   <th scope="row">Header type</th>
   <td><a href="/zh-CN/docs/Glossary/Response_header">Response header</a></td>
  </tr>
  <tr>
   <th scope="row"><a href="/zh-CN/docs/Glossary/%E7%A6%81%E6%AD%A2%E4%BF%AE%E6%94%B9%E7%9A%84%E6%B6%88%E6%81%AF%E9%A6%96%E9%83%A8">Forbidden header name</a></th>
   <td>no</td>
  </tr>
 </tbody>
</table>

<h2 id="语法">语法</h2>

<pre class="syntaxbox notranslate">Public-Key-Pins-Report-Only: pin-sha256=&quot;&lt;pin-value&gt;&quot;;
                             max-age=&lt;expire-time&gt;;
                             includeSubDomains;
                             report-uri=&quot;&lt;uri&gt;&quot;</pre>

<h2 id="指令">指令</h2>

<dl>
 <dt><code>pin-sha256=&quot;&lt;pin-value&gt;&quot;</code></dt>
 <dd>引号里面的是内容是以Base64编码的 <a href="/en-US/docs/Glossary/SPKI">SPKI</a>(公钥) 指纹。你可以为多个不同的公钥都设定对应的pins。 一些浏览器将来可能也支持非SHA-256 的哈希算法。</dd>
 <dt>max-age=&lt;expire-time&gt;</dt>
 <dd>该指令对 Public-Key-Pins-Report-Only无效，客户端会忽略也不会缓存此头部。</dd>
 <dt> </dt>
 <dt><code>includeSubDomains </code><span class="optional optionalInline notecard inline">可选</span></dt>
 <dd>如果该选项被指定，该规则也会应用到网站的所有子域名</dd>
 <dt><code>report-uri=&quot;&lt;uri&gt;&quot;</code></dt>
</dl>

<p>     设置Pin验证失败报告的URL地址。这个指令应该和该头部一起使用，否则这个头部将是一个空操作。</p>

<dl>
 <dt> </dt>
</dl>

<h2 id="例子">例子</h2>

<pre class="notranslate">Public-Key-Pins-Report-Only:
  pin-sha256=&quot;cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=&quot;;
  pin-sha256=&quot;M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=&quot;;
  includeSubDomains;
  report-uri=&quot;https://www.example.org/hpkp-report&quot;</pre>

<p>在这个例子里面，<strong>pin-sha256=&quot;cUPcTAZWKaASuYWhhneDttWpY3oBAkE3h2+soZS7sWs=&quot; </strong>固定了该服务器的公钥.。第二个声明<strong>pin-sha256=&quot;M8HztCzM3elUxkcjR2S5P4hhyBNf6lHkmjAHKhpGPWE=&quot;</strong> 也固定了服务器的备用公钥。同时通过<strong>includeSubDomains</strong> 的声明使得该设置对所有子域名都生效。最后， <strong>report-uri=&quot;https://www.example.org/hpkp-report&quot;</strong> 则是定义了在验证失败时将异常信息发送到该服务器。</p>

<h2 id="标准">标准</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Title</th>
  </tr>
  <tr>
   <td><a href="https://tools.ietf.org/html/rfc7469#section-2.1">RFC 7469, section 2.1: Public-Key-Pins-Report-Only</a></td>
   <td>Public Key Pinning Extension for HTTP</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容">浏览器兼容</h2>

<p class="hidden">The compatibility table in this page is generated from structured data. If you&apos;d like to contribute to the data, please check out <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> and send us a pull request.</p>

<div class="bc-data" id="bcd:http.headers.Public-Key-Pins-Report-Only"></div>

<h2 id="更多">更多</h2>

<ul>
 <li><a href="/zh-CN/docs/Web/HTTP/Headers/Public-Key-Pins"><code>Public-Key-Pins</code></a></li>
</ul>
