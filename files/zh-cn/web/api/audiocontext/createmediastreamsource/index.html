---
title: AudioContext.createMediaStreamSource()
slug: Web/API/AudioContext/createMediaStreamSource
translation_of: Web/API/AudioContext/createMediaStreamSource
---
<section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/Web_Audio_API">Web Audio API</a></strong></li><li><strong><a href="/zh-CN/docs/Web/API/AudioContext"><code>AudioContext</code></a></strong></li><li class="toggle"><details open><summary>Constructor</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/AudioContext"><code>AudioContext()</code></a></li></ol></details></li><li class="toggle"><details open><summary>属性</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/baseLatency"><code>baseLatency</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/outputLatency"><code>outputLatency</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/outputLatency$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>方法</summary><ol><li><a href="/zh-CN/docs/Web/API/AudioContext/baseLatency"><code>baseLatency</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/close"><code>close()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/API/AudioContext/createJavaScriptNode"><code>createJavaScriptNode()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createJavaScriptNode$translate" style="opacity: 0.5;">[我来译!]</a></s></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaElementSource"><code>createMediaElementSource()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamDestination"><code>createMediaStreamDestination()</code></a></li><li><em><code>createMediaStreamSource()</code></em></li><li><a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamTrackSource"><code>createMediaStreamTrackSource()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createMediaStreamTrackSource$translate" style="opacity: 0.5;">[我来译!]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="This is an obsolete API and is no longer guaranteed to work."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/zh-CN/docs/Web/API/AudioContext/createWaveTable"><code>createWaveTable()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/createWaveTable$translate" style="opacity: 0.5;">[我来译!]</a></s></li><li><a href="/zh-CN/docs/Web/API/AudioContext/getOutputTimestamp"><code>getOutputTimestamp()</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/getOutputTimestamp$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/outputLatency"><code>outputLatency</code></a> <a href="/zh-CN/docs/Web/API/AudioContext/outputLatency$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/resume"><code>resume()</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContext/suspend"><code>suspend()</code></a></li></ol></details></li><li class="toggle"><details open><summary>继承</summary><ol><li><a href="/zh-CN/docs/Web/API/EventTarget"><code>EventTarget</code></a></li></ol></details></li><li class="toggle"><details open><summary>Related pages for Web Audio API</summary><ol><li><a href="/zh-CN/docs/Web/API/AnalyserNode"><code>AnalyserNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioBuffer"><code>AudioBuffer</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioBufferSourceNode"><code>AudioBufferSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioContextOptions"><code>AudioContextOptions</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioDestinationNode"><code>AudioDestinationNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioListener"><code>AudioListener</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioNode"><code>AudioNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioNodeOptions"><code>AudioNodeOptions</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioParam"><code>AudioParam</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioProcessingEvent"><code>AudioProcessingEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioScheduledSourceNode"><code>AudioScheduledSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorklet"><code>AudioWorklet</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletGlobalScope"><code>AudioWorkletGlobalScope</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletNode"><code>AudioWorkletNode</code></a></li><li><a href="/zh-CN/docs/Web/API/AudioWorkletProcessor"><code>AudioWorkletProcessor</code></a></li><li><a href="/zh-CN/docs/Web/API/BaseAudioContext"><code>BaseAudioContext</code></a></li><li><a href="/zh-CN/docs/Web/API/BiquadFilterNode"><code>BiquadFilterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ChannelMergerNode"><code>ChannelMergerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ChannelSplitterNode"><code>ChannelSplitterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ConstantSourceNode"><code>ConstantSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/ConvolverNode"><code>ConvolverNode</code></a></li><li><a href="/zh-CN/docs/Web/API/DelayNode"><code>DelayNode</code></a></li><li><a href="/zh-CN/docs/Web/API/DynamicsCompressorNode"><code>DynamicsCompressorNode</code></a></li><li><a href="/zh-CN/docs/Web/API/GainNode"><code>GainNode</code></a></li><li><a href="/zh-CN/docs/Web/API/IIRFilterNode"><code>IIRFilterNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaElementAudioSourceNode"><code>MediaElementAudioSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaStreamAudioDestinationNode"><code>MediaStreamAudioDestinationNode</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode"><code>MediaStreamAudioSourceNode</code></a></li><li><a href="/zh-CN/docs/Web/API/OfflineAudioCompletionEvent"><code>OfflineAudioCompletionEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/OfflineAudioContext"><code>OfflineAudioContext</code></a></li><li><a href="/zh-CN/docs/Web/API/OscillatorNode"><code>OscillatorNode</code></a></li><li><a href="/zh-CN/docs/Web/API/PannerNode"><code>PannerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/PeriodicWave"><code>PeriodicWave</code></a></li><li><a href="/zh-CN/docs/Web/API/StereoPannerNode"><code>StereoPannerNode</code></a></li><li><a href="/zh-CN/docs/Web/API/WaveShaperNode"><code>WaveShaperNode</code></a></li></ol></details></li></ol></section>

<div>
<p><a href="/zh-CN/docs/Web/API/AudioContext" title="AudioContext接口表示由音频模块连接而成的音频处理图，每个模块对应一个AudioNode。AudioContext可以控制它所包含的节点的创建，以及音频处理、解码操作的执行。做任何事情之前都要先创建AudioContext对象，因为一切都发生在这个环境之中。"><code>AudioContext</code></a>接口的<code>createMediaStreamSource()方法用于创建一个新的</code><a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode" title="MediaElementSourceNode没有输入，并且只有一个输出。创建之后使用 AudioContext.createMediaStreamSource方法。输出通道的数量和AudioMediaStreamTrack的通道数量相同。如果没有有效的媒体流，输出通道就变成一个静音的通道。"><code>MediaStreamAudioSourceNode</code></a> 对象, 需要传入一个媒体流对象(MediaStream对象)(可以从 <a href="/zh-CN/docs/Web/API/Navigator/getUserMedia" title="Navigator.getUserMedia()方法提醒用户需要使用音频（0或者1）和（0或者1）视频输入设备，比如相机，屏幕共享，或者麦克风。如果用户给予许可，successCallback回调就会被调用，MediaStream对象作为回调函数的参数。如果用户拒绝许可或者没有媒体可用，errorCallback就会被调用，类似的，PermissionDeniedError 或者NotFoundError对象作为它的参数。注意，有可能以上两个回调函数都不被调用，因为不要求用户一定作出选择（允许或者拒绝）。"><code>navigator.getUserMedia</code></a> 获得MediaStream对象实例), 然后来自MediaStream的音频就可以被播放和操作。</p>
</div>

<p>更多关于媒体流音频源(media stream audio source nodes)的细节, 请参考<a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode" title="MediaElementSourceNode没有输入，并且只有一个输出。创建之后使用 AudioContext.createMediaStreamSource方法。输出通道的数量和AudioMediaStreamTrack的通道数量相同。如果没有有效的媒体流，输出通道就变成一个静音的通道。"><code>MediaStreamAudioSourceNode</code></a> 页面.</p>

<h2 id="语法">语法</h2>

<pre class="brush: js">var audioCtx = new AudioContext();
var source = audioCtx.createMediaStreamSource(stream);</pre>

<h3 id="参数">参数</h3>

<dl>
 <dt>stream</dt>
 <dd>一个<a href="/zh-CN/docs/Web/API/MediaStream" title="MediaStream 接口是一个媒体内容的流.。一个流包含几个轨道，比如视频和音频轨道。"><code>MediaStream</code></a> 对象，把他传入一个音频处理器进行操作</dd>
</dl>

<h3 id="返回">返回</h3>

<p> <a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode" title="MediaElementSourceNode没有输入，并且只有一个输出。创建之后使用 AudioContext.createMediaStreamSource方法。输出通道的数量和AudioMediaStreamTrack的通道数量相同。如果没有有效的媒体流，输出通道就变成一个静音的通道。"><code>MediaStreamAudioSourceNode</code></a></p>

<h2 id="示例">示例</h2>

<p>本例中，我们从 <a href="/zh-CN/docs/Web/API/Navigator/getUserMedia" title="Navigator.getUserMedia()方法提醒用户需要使用音频（0或者1）和（0或者1）视频输入设备，比如相机，屏幕共享，或者麦克风。如果用户给予许可，successCallback回调就会被调用，MediaStream对象作为回调函数的参数。如果用户拒绝许可或者没有媒体可用，errorCallback就会被调用，类似的，PermissionDeniedError 或者NotFoundError对象作为它的参数。注意，有可能以上两个回调函数都不被调用，因为不要求用户一定作出选择（允许或者拒绝）。"><code>navigator.getUserMedia</code></a>获取媒体 (audio + video) 流,，把它传入 <a href="/zh-CN/docs/Web/HTML/Element/video" title="HTML &lt;video&gt; 元素 用于在HTML或者XHTML文档中嵌入媒体播放器，用于支持文档内的视频播放。"><code>&lt;video&gt;</code></a>中播放，并把视频调成静音，然后把获取到的audio传入 <a href="/zh-CN/docs/Web/API/MediaStreamAudioSourceNode" title="MediaElementSourceNode没有输入，并且只有一个输出。创建之后使用 AudioContext.createMediaStreamSource方法。输出通道的数量和AudioMediaStreamTrack的通道数量相同。如果没有有效的媒体流，输出通道就变成一个静音的通道。"><code>MediaStreamAudioSourceNode</code></a>。接下来我们把获取到的audio传入<a href="/zh-CN/docs/Web/API/BiquadFilterNode" title="BiquadFilterNode接口表示一个简单低阶滤波器(双二阶滤波器), 通过 AudioContext.createBiquadFilter() 方法创建. 它是一个能表示不同类型的过滤器，声调控制设备，图形均衡器的AudioNode ."><code>BiquadFilterNode</code></a> (可以把声音转化为低音)，输出到 <a href="/zh-CN/docs/Web/API/AudioDestinationNode" title="AudioDestinationNode可以通过AudioContext.destination属性来查看。"><code>AudioDestinationNode</code></a>.</p>

<p><a href="/zh-CN/docs/Web/HTML/Element/video" title="HTML &lt;video&gt; 元素 用于在HTML或者XHTML文档中嵌入媒体播放器，用于支持文档内的视频播放。"><code>&lt;video&gt;</code></a> 元素下面滑动杆控制低音过滤器过滤的程度，滑动杆的值越大，低音更明显</p>

<div class="note">
<p><span style="font-size: 14px;"><strong>注意：你可以查看</strong></span> <a href="https://mdn.github.io/webaudio-examples/stream-source-buffer/">在线演示</a>，或者 <a href="https://github.com/mdn/webaudio-examples/tree/master/stream-source-buffer">查看源码</a>。</p>
</div>

<pre class="brush: js;highlight[23]">var pre = document.querySelector(&apos;pre&apos;);
var video = document.querySelector(&apos;video&apos;);
var myScript = document.querySelector(&apos;script&apos;);
var range = document.querySelector(&apos;input&apos;);

// getUserMedia获取流
// 把流放入MediaStreamAudioSourceNode
// 输出到video元素

if (navigator.mediaDevices) {
    console.log(&apos;getUserMedia supported.&apos;);
    navigator.mediaDevices.getUserMedia ({audio: true, video: true})
    .then(function(stream) {
        video.srcObject = stream;
        video.onloadedmetadata = function(e) {
            video.play();
            video.muted = true;
        };

        // 创建MediaStreamAudioSourceNode
        // Feed the HTMLMediaElement into it
        var audioCtx = new AudioContext();
        var source = audioCtx.createMediaStreamSource(stream);

        // 创建二阶滤波器
        var biquadFilter = audioCtx.createBiquadFilter();
        biquadFilter.type = &quot;lowshelf&quot;;
        biquadFilter.frequency.value = 1000;
        biquadFilter.gain.value = range.value;

        // 把AudioBufferSourceNode连接到gainNode
        // gainNode连接到目的地, 所以我们可以播放
        // 音乐并用鼠标调节音量
        source.connect(biquadFilter);
        biquadFilter.connect(audioCtx.destination);

        // Get new mouse pointer coordinates when mouse is moved
        // then set new gain value

        range.oninput = function() {
            biquadFilter.gain.value = range.value;
        }
    })
    .catch(function(err) {
        console.log(&apos;The following gUM error occured: &apos; + err);
    });
} else {
   console.log(&apos;getUserMedia not supported on your browser!&apos;);
}

// dump script to pre element

pre.innerHTML = myScript.innerHTML;</pre>

<div class="note">
<p><span style="font-size: 14px;"><strong>注意</strong></span>: 调用<code>createMediaStreamSource()</code>, 来自于媒体流的音频回放将被重新传到AudioContext的处理器中。所以播放/暂停流仍然是可以通过media元素的API和自带的控制器控制。</p>
</div>



<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a class="external" href="https://webaudio.github.io/web-audio-api/#widl-AudioContext-createMediaStreamSource-MediaStreamAudioSourceNode-MediaStream-mediaStream" hreflang="en" lang="en">Web Audio API<br><small lang="zh-CN">createMediaStreamSource()</small></a></td>
   <td><span class="spec-WD">Working Draft</span></td>
   <td></td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<div><div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/zh-CN/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Desktop</a></li>
        <li><a>Mobile</a></li>
    </ul>
</div></div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Chrome</th>
   <th>Edge</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari (WebKit)</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>10.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes">webkit</a></span></td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><a href="/en-US/Firefox/Releases/25">25.0</a> (25.0) </td>
   <td><span style="color: #f00;">未实现</span></td>
   <td>15.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes">webkit</a></span><br>
    22 (unprefixed)</td>
   <td>6.0<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes">webkit</a></span></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Android</th>
   <th>Edge</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>Firefox OS</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
   <th>Chrome for Android</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td>26.0</td>
   <td>1.2</td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>33.0</td>
  </tr>
 </tbody>
</table>
</div>

<h2 id="查看更多">查看更多</h2>

<ul>
 <li><a href="/en-US/docs/Web_Audio_API/Using_Web_Audio_API">Using the Web Audio API</a></li>
</ul>
