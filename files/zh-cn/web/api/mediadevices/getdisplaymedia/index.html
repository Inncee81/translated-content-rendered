---
title: MediaDevices.getDisplayMedia()
slug: Web/API/MediaDevices/getDisplayMedia
tags:
  - API
  - 会谈
  - 分享
  - 参考
  - 多媒体
  - 多媒体设备
  - 屏幕
  - 屏幕捕捉
  - 屏幕捕捉API
  - 捕捉
  - 方法
  - 显示
  - 获取显示多媒体
  - 视频
translation_of: Web/API/MediaDevices/getDisplayMedia
---
<div><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/Screen_Capture_API">Screen Capture API</a></strong></li><li class="toggle"><details open><summary>Guides</summary><ol><li><a href="/zh-CN/docs/Web/API/Screen_Capture_API/%E4%BD%BF%E7%94%A8%E5%B1%8F%E5%B9%95%E6%8D%95%E8%8E%B7API">使用屏幕捕获API</a></li></ol></details></li><li class="toggle"><details open><summary>属性</summary><ol><li><a href="/zh-CN/docs/Web/API/MediaTrackConstraints/cursor"><code>MediaTrackConstraints.cursor</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackConstraints/displaySurface"><code>MediaTrackConstraints.displaySurface</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackConstraints/logicalSurface"><code>MediaTrackConstraints.logicalSurface</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSettings/cursor"><code>MediaTrackSettings.cursor</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSettings/displaySurface"><code>MediaTrackSettings.displaySurface</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSettings/logicalSurface"><code>MediaTrackSettings.logicalSurface</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/cursor"><code>MediaTrackSupportedConstraints.cursor</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/displaySurface"><code>MediaTrackSupportedConstraints.displaySurface</code></a></li><li><a href="/zh-CN/docs/Web/API/MediaTrackSupportedConstraints/logicalSurface"><code>MediaTrackSupportedConstraints.logicalSurface</code></a></li></ol></details></li><li class="toggle"><details open><summary>方法</summary><ol><li><a href="/zh-CN/docs/Web/API/MediaDevices/getDisplayMedia"><code>MediaDevices.getDisplayMedia()</code></a></li></ol></details></li></ol></section></div>

<p>这个 <a href="/zh-CN/docs/Web/API/MediaDevices"><code>MediaDevices</code></a>  接口的 <code><strong>getDisplayMedia() 方法提示用户去选择和授权捕获展示的内容或部分内容（如一个窗口）在一个</strong></code>  <a href="/zh-CN/docs/Web/API/MediaStream"><code>MediaStream</code></a> 里. 然后，这个媒体流可以通过使用 <a href="/en-US/docs/Web/API/MediaStream_Recording_API">MediaStream Recording API</a> 被记录或者作为<a href="/en-US/docs/Web/API/WebRTC_API">WebRTC</a> 会话的一部分被传输。</p>

<p>去 <a href="/en-US/docs/Web/API/Screen_Capture_API/Using_Screen_Capture">Using the Screen Capture API</a> 查找更多详情和例子.</p>

<h2 id="语法">语法</h2>

<pre class="syntaxbox notranslate">var <em>promise</em> = navigator.mediaDevices.getDisplayMedia(<em>constraints</em>);
</pre>

<h3 id="参数">参数</h3>

<dl>
 <dt><code>constraints</code> <span class="optional optionalInline notecard inline">可选</span></dt>
 <dd>一个可选的<a href="/zh-CN/docs/Web/API/MediaStreamConstraints"><code>MediaStreamConstraints</code></a>对象，它指定了返回的<a href="/zh-CN/docs/Web/API/MediaStream"><code>MediaStream</code></a>的要求。 因为<code>getDisplayMedia()</code>需要视频轨道，所以即使<code>constraints</code> 对象没有明确请求视频轨道，返回的流也会有一个。</dd>
</dl>

<h3 id="返回值">返回值</h3>

<p>一个被解析为 <a href="/zh-CN/docs/Web/API/MediaStream"><code>MediaStream</code></a> 的 <a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>，其中包含一个视频轨道。视频轨道的内容来自用户选择的屏幕区域以及一个可选的音频轨道。</p>

<div class="note notecard">
<p><strong>Note:</strong> 浏览器对音频的支持程度各不相同，既取决于是否支持，也取决于音频源. 点击 <a href="#Browser_compatibility">compatibility table</a> 来查看各个浏览器的支持性.</p>
</div>

<h3 id="异常">异常</h3>

<p>来自返回的promise的拒绝是通过将<a href="/zh-CN/docs/Web/API/DOMException"><code>DOMException</code></a>错误对象传递给promise的失败处理程序来进行的。可能的错误是：</p>

<dl>
 <dt><code>AbortError</code> ［中止错误］</dt>
 <dd>发生了与以下任何其他异常不匹配的错误或故障。</dd>
 <dt><code>InvalidStateError</code> ［拒绝错误］</dt>
 <dd>调用 <code>getDisplayMedia()</code> 的context中的 <a href="/zh-CN/docs/Web/API/Document"><code>document</code></a> 不是完全激活的; 例如，也许它不是最前面的标签。</dd>
 <dt><code>NotAllowedError</code> ［拒绝错误］</dt>
 <dd>用户拒绝授予访问屏幕区域的权限，或者不允许当前浏览实例访问屏幕共享。</dd>
 <dt><code>NotFoundError</code> ［找不到错误］</dt>
 <dd>没有可用于捕获的屏幕视频源。</dd>
 <dt><code>NotReadableError</code> ［无法读取错误］</dt>
 <dd>用户选择了屏幕，窗口，标签或其他屏幕数据源，但发生了硬件或操作系统级别错误或锁定，从而预先占用了共享所选源。</dd>
 <dt><code>OverconstrainedError</code> ［转换错误］</dt>
 <dd>创建流后，由于无法生成兼容的流导致应用指定的 <code>constraints</code> 失效。</dd>
 <dt><code>TypeError</code> ［类型错误］</dt>
 <dd>指定的 <code>constraints</code> 包括调用 <code>getDisplayMedia()</code> 时不允许的<code>constraints</code>。 这些不受支持的<code>constraints</code>是 <code>advanced</code> 的，任何约束又有一个名为 <code>min</code> 或 <code>exact</code> 的成员。</dd>
</dl>

<h2 id="示例">示例</h2>

<p>在下面的示例中，我们创建了一个 <code>startCapture()</code> 方法，该方法在给定由 <code>displayMediaOptions</code> 参数指定的一组选项的情况下启动屏幕捕获。 选项以 <a href="/zh-CN/docs/Web/API/MediaStreamConstraints"><code>MediaStreamConstraints</code></a>对象的形式指定，该对象指定首选流配置和从中捕获视频的显示表面</p>

<pre class="brush: js notranslate">async function startCapture(displayMediaOptions) {
  let captureStream = null;

  try {
    captureStream = await navigator.mediaDevices.getDisplayMedia(displayMediaOptions);
  } catch(err) {
    console.error(&quot;Error: &quot; + err);
  }
  return captureStream;
}</pre>

<p>这里使用 <a href="/zh-CN/docs/Web/JavaScript/Reference/await"><code>await</code></a> 来进行异步等待 <code>getDisplayMedia()</code>来进行 <a href="/zh-CN/docs/Web/API/MediaStream"><code>MediaStream</code></a>解析，其中包含指定选项所请求的显示内容。 之后，流被返回给调用者以供其使用，可能是使用 <a href="/zh-CN/docs/Web/API/RTCPeerConnection/addTrack"><code>RTCPeerConnection.addTrack()</code></a>添加到WebRTC调用来从流中添加视频轨道。</p>

<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">规范</th>
   <th scope="col">状态</th>
   <th scope="col">备注</th>
  </tr>
  <tr>
   <td><a class="external" href="https://w3c.github.io/mediacapture-screen-share/#dom-mediadevices-getdisplaymedia" hreflang="en" lang="en">Screen Capture<br><small lang="zh-CN">MediaDevices.getDisplayMedia()</small></a></td>
   <td><span class="spec-WD">Working Draft</span></td>
   <td>初始定义</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<div>
<div class="hidden">此页面上的兼容性表是根据结构化数据生成的。 如果您想为数据做出贡献，请查看 <a href="https://github.com/mdn/browser-compat-data">https://github.com/mdn/browser-compat-data</a> 并向我们发送拉取请求。</div>

<div class="bc-data" id="bcd:api.MediaDevices.getDisplayMedia"></div>
</div>

<h2 id="参考">参考</h2>

<ul>
 <li><a href="/en-US/docs/Web/API/Screen_Capture_API">Screen Capture API</a></li>
 <li><a href="/en-US/docs/Web/API/Screen_Capture_API/Using_Screen_Capture">Using the Screen Capture API</a></li>
 <li><a href="/en-US/docs/Web/API/Media_Streams_API">Media Capture and Streams API</a></li>
 <li><a href="/en-US/docs/Web/API/WebRTC_API">WebRTC API</a></li>
 <li><a href="/zh-CN/docs/Web/API/MediaDevices/getUserMedia"><code>getUserMedia()</code></a>: Capturing media from a camera and/or microphone</li>
</ul>
