---
title: VisualViewport
slug: Web/API/VisualViewport
tags:
  - API
  - Experimental
  - Interface
  - NeedsTranslation
  - Reference
  - TopicStub
  - Visual Viewport API
  - VisualViewport
  - viewport
translation_of: Web/API/VisualViewport
---
<div class="experimental indicator-warning notecard">
    <p><strong>这是一个实验中的功能</strong><br>此功能某些浏览器尚在开发中，请参考<a href="#Browser_compatibility">浏览器兼容性表格</a>以得到在不同浏览器中适合使用的前缀。由于该功能对应的标准文档可能被重新修订，所以在未来版本的浏览器中该功能的语法和行为可能随之改变。</p>
</div><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/Visual_Viewport_API">Visual Viewport API</a></strong></li><li><strong><a href="/zh-CN/docs/Web/API/VisualViewport"><code>VisualViewport</code></a></strong></li><li class="toggle"><details open><summary>属性</summary><ol><li><a href="/zh-CN/docs/Web/API/VisualViewport/height"><code>height</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/height$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/offsetleft"><code>offsetleft</code></a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/offsetTop"><code>offsetTop</code></a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/pageLeft"><code>pageLeft</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/pageLeft$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/pageTop"><code>pageTop</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/pageTop$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/scale"><code>scale</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/scale$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/VisualViewport/width"><code>width</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/width$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>Events</summary><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/VisualViewport/onresize"><code>onresize</code></a> <a href="/zh-CN/docs/Web/API/VisualViewport/onresize$translate" style="opacity: 0.5;">[我来译!]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/VisualViewport/onscroll"><code>onscroll</code></a></li></ol></details></li><li class="toggle"><details open><summary>Related pages for Visual Viewport</summary><ol><li><a href="/zh-CN/docs/Web/API/Window/visualViewport"><code>Window.visualViewport</code></a></li></ol></details></li></ol></section>

<p> <a href="https://wiki.developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API">Visual Viewport API</a> 提供了当前页面的视觉视口接口，即 <strong><code>VisualViewport</code></strong> 。对于每个页面容器来说（如 iframe），都存在有一个独立的 window 对象。每个页面容器的 window 对象都有一个独立的 <code>VisualViewport</code> 属性。</p>

<p>你可以使用 <a href="/zh-CN/docs/Web/API/Window/visualViewport"><code>Window.visualViewport</code></a> 获得对应 window 的视觉视口 API。</p>

<div class="note notecard">
<p><strong>注意</strong>：与布局视口（layout viewport）不同的是：只有最上层的 window 才有视觉视口（visual viewport）这一概念。因此只有最上层 window 的 <code>VisualViewport</code> 属性才是有效的，其他层的视觉视口属性可看作是布局视口属性的别名。比如，对于一个 <a href="/zh-CN/docs/Web/HTML/Element/iframe" title="browsing context"><code>&lt;iframe&gt;</code></a> ，其对应的视觉视口属性 <a href="/zh-CN/docs/Web/API/VisualViewport/width"><code>VisualViewport.width</code></a> 相当于对应的布局视口属性，如 <a href="/zh-CN/docs/Web/API/Element/clientWidth"><code>document.documentElement.clientWidth</code></a>.</p>
</div>

<h2 id="属性">属性</h2>

<p><em><code>VisualViewport</code></em> 从其父元素继承属性 <em><a href="/zh-CN/docs/Web/API/EventTarget"><code>EventTarget</code></a></em>。</p>

<dl>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/offsetLeft"><code>VisualViewport.offsetLeft</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回视觉视口的左边框到布局视口的左边框的 CSS 像素距离。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/offsetTop"><code>VisualViewport.offsetTop</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回视觉视口的上边框到布局视口的上边框的 CSS 像素距离。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/pageLeft"><code>VisualViewport.pageLeft</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回相对于初始的 viewport 属性的 X 轴坐标所对应的 CSS 像素数。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/pageTop"><code>VisualViewport.pageTop</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回相对于初始的 viewport 属性的 Y 轴坐标所对应的 CSS 像素数。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/width"><code>VisualViewport.width</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回视觉视口的宽度所对应的 CSS 像素数。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/height"><code>VisualViewport.height</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回视觉视口的高度所对应的 CSS 像素数。</dd>
 <dt><a href="/zh-CN/docs/Web/API/VisualViewport/scale"><code>VisualViewport.scale</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>返回当前视觉视口所应用的缩放比例。</dd>
</dl>

<h2 id="Events">Events</h2>

<p>通过使用 <code><a href="https://wiki.developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener">addEventListener()</a></code> 或者将监听回调函数赋值给对应的 <code>on<em>eventname</em></code> 属性，可以为对应的视口事件添加监听。</p>

<dl>
 <dt><code><a href="https://wiki.developer.mozilla.org/en-US/docs/Web/API/VisualViewport/resize_event">resize</a></code></dt>
 <dd>当视觉视口被改变时触发。</dd>
 <dd>也可以为 <a href="/zh-CN/docs/Web/API/VisualViewport/onresize"><code>VisualViewport.onresize</code></a> 属性赋值来添加监听。</dd>
 <dt><code><a href="https://wiki.developer.mozilla.org/en-US/docs/Web/API/VisualViewport/scroll_event">scroll</a></code></dt>
 <dd>当视觉视口滑动时触发。</dd>
 <dd>也可以为 <a href="/zh-CN/docs/Web/API/VisualViewport/onscroll"><code>VisualViewport.onscroll</code></a> 属性赋值来添加监听。</dd>
</dl>

<h2 id="例子">例子</h2>

<h3 class="highlight-spanned" id="缩放检测并隐藏元素"><span class="highlight-span">缩放检测并隐藏元素</span></h3>

<p>这个例子取自 <a href="https://github.com/WICG/visual-viewport">Visual Viewport README</a>，展示了如何在用户缩放时隐藏某个盒子（或元素）。这对于增强一个页面在缩放时的用户体验有重要意义。同样，你也可以查看另一个 <a href="https://wicg.github.io/visual-viewport/examples/hide-on-zoom.html">例子</a> 。</p>

<pre class="brush: js line-numbers language-js notranslate"><code class="language-js"><span class="keyword token">var</span> bottomBar <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">&apos;bottombar&apos;</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> viewport <span class="operator token">=</span> window<span class="punctuation token">.</span>visualViewport<span class="punctuation token">;</span>

<span class="keyword token">function</span> <span class="function token">resizeHandler</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
   <span class="keyword token">if</span> <span class="punctuation token">(</span>viewport<span class="punctuation token">.</span>scale <span class="operator token">&gt;</span> <span class="number token">1.3</span><span class="punctuation token">)</span>
     bottomBar<span class="punctuation token">.</span>style<span class="punctuation token">.</span>display <span class="operator token">=</span> <span class="string token">&quot;none&quot;</span><span class="punctuation token">;</span>
   <span class="keyword token">else</span>
     bottomBar<span class="punctuation token">.</span>style<span class="punctuation token">.</span>display <span class="operator token">=</span> <span class="string token">&quot;block&quot;</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

window<span class="punctuation token">.</span>visualViewport<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">&apos;resize&apos;</span><span class="punctuation token">,</span> resizeHandler<span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<h3 class="highlight-spanned" id="模拟_position_属性：device-fixed"><span class="highlight-span">模拟 position 属性：device-fixed</span></h3>

<p>这个例子同样取自 <a href="https://github.com/WICG/visual-viewport">Visual Viewport README</a> ，展示了如何使用视觉视口 API，从而模拟 <code>position: device-fixed</code> 的 CSS 属性。类似于 <code>position: fixed</code> ，这一属性可将被设置的元素固定在视觉视口特定位置。此外，你也可以查看另一个 <a href="https://wicg.github.io/visual-viewport/examples/fixed-to-viewport.html">例子</a> 。</p>

<pre class="brush: js line-numbers language-js notranslate"><code class="language-js"><span class="keyword token">var</span> bottomBar <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">&apos;bottombar&apos;</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> viewport <span class="operator token">=</span> window<span class="punctuation token">.</span>visualViewport<span class="punctuation token">;</span>
<span class="keyword token">function</span> <span class="function token">viewportHandler</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> layoutViewport <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">&apos;layoutViewport&apos;</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

  <span class="comment token">// Since the bar is position: fixed we need to offset it by the visual</span>
  <span class="comment token">// viewport&apos;s offset from the layout viewport origin.</span>
  <span class="keyword token">var</span> offsetLeft <span class="operator token">=</span> viewport<span class="punctuation token">.</span>offsetLeft<span class="punctuation token">;</span>
  <span class="keyword token">var</span> offsetTop <span class="operator token">=</span> viewport<span class="punctuation token">.</span>height
              <span class="operator token">-</span> layoutViewport<span class="punctuation token">.</span><span class="function token">getBoundingClientRect</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">.</span>height
              <span class="operator token">+</span> viewport<span class="punctuation token">.</span>offsetTop<span class="punctuation token">;</span>

  <span class="comment token">// You could also do this by setting style.left and style.top if you</span>
  <span class="comment token">// use width: 100% instead.</span>
  bottomBar<span class="punctuation token">.</span>style<span class="punctuation token">.</span>transform <span class="operator token">=</span> <span class="string token">&apos;translate(&apos;</span> <span class="operator token">+</span>
                              offsetLeft <span class="operator token">+</span> <span class="string token">&apos;px,&apos;</span> <span class="operator token">+</span>
                              offsetTop <span class="operator token">+</span> <span class="string token">&apos;px) &apos;</span> <span class="operator token">+</span>
                              <span class="string token">&apos;scale(&apos;</span> <span class="operator token">+</span> <span class="number token">1</span><span class="operator token">/</span>viewport<span class="punctuation token">.</span>scale <span class="operator token">+</span> <span class="string token">&apos;)&apos;</span>
<span class="punctuation token">}</span>
window<span class="punctuation token">.</span>visualViewport<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">&apos;scroll&apos;</span><span class="punctuation token">,</span> viewportHandler<span class="punctuation token">)</span><span class="punctuation token">;</span>
window<span class="punctuation token">.</span>visualViewport<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">&apos;resize&apos;</span><span class="punctuation token">,</span> viewportHandler<span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<div class="note notecard">
<p><strong>注意</strong>：应小心使用上述方案，使用这种方式模拟的 <code>position: device-fixed</code> 可能会导致其他元素在滚动页面时出现闪烁。</p>
</div>

<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">规范</th>
   <th scope="col">状态</th>
   <th scope="col">提交</th>
  </tr>
  <tr>
   <td><a class="external" href="https://wicg.github.io/visual-viewport/#the-visualviewport-interface" hreflang="en" lang="en">Visual Viewport API<br><small lang="zh-CN">VisualViewport</small></a></td>
   <td><span class="spec-Draft">Draft</span></td>
   <td>Initial definition.</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<div class="bc-data" id="bcd:api.VisualViewport"></div>

<h2 id="参照">参照</h2>

<ul>
 <li><a href="https://github.com/bokand/bokand.github.io/blob/master/web_viewports_explainer.md">Web 视口说明</a> — 解释了什么是浏览器视口和视觉视口和布局视口的区别。</li>
</ul>
