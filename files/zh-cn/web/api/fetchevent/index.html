---
title: FetchEvent
slug: Web/API/FetchEvent
translation_of: Web/API/FetchEvent
---
<p></p><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/Service_Worker_API">Service Worker API</a></strong></li><li><strong><a href="/zh-CN/docs/Web/API/FetchEvent"><code>FetchEvent</code></a></strong></li><li class="toggle"><details open><summary>Constructor</summary><ol><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/FetchEvent"><code>FetchEvent()</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/FetchEvent$translate">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>属性</summary><ol><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><span class="sidebar-icon"><span title="This deprecated API should no longer be used, but will probably still work."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/client"><code>client</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/client$translate">[我来译!]</a></li><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/clientId"><code>clientId</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/clientId$translate">[我来译!]</a></li><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/isReload"><code>isReload</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/isReload$translate">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/FetchEvent/navigationPreload"><code>navigationPreload</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/navigationPreload$translate">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/FetchEvent/replacesClientId"><code>replacesClientId</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/replacesClientId$translate">[我来译!]</a></li><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/request"><code>request</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/request$translate">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/FetchEvent/resultingClientId"><code>resultingClientId</code></a> <a style="opacity: 0.5;" href="/zh-CN/docs/Web/API/FetchEvent/resultingClientId$translate">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>方法</summary><ol><li><span class="sidebar-icon"><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span></span><a href="/zh-CN/docs/Web/API/FetchEvent/respondWith"><code>respondWith()</code></a></li></ol></details></li><li class="toggle"><details open><summary>继承</summary><ol><li><a href="/zh-CN/docs/Web/API/Event"><code>Event</code></a></li></ol></details></li><li class="toggle"><details open><summary>Events</summary><ol><li><a href="/zh-CN/docs/Web/Events/statechange"><code>statechange</code></a></li><li><a href="/zh-CN/docs/Web/Events/updatefound"><code>updatefound</code></a></li><li><a href="/zh-CN/docs/Web/Events/controllerchange"><code>controllerchange</code></a></li><li><a href="/zh-CN/docs/Web/Events/error"><code>error</code></a></li><li><a href="/zh-CN/docs/Web/Events/message"><code>message</code></a></li><li><a href="/zh-CN/docs/Web/Events/install"><code>install</code></a></li><li><a href="/zh-CN/docs/Web/Events/activate"><code>activate</code></a></li><li><a href="/zh-CN/docs/Web/Events/fetch"><code>fetch</code></a></li></ol></details></li><li class="toggle"><details open><summary>Related pages for Service Workers API</summary><ol><li><a href="/zh-CN/docs/Web/API/Cache"><code>Cache</code></a></li><li><a href="/zh-CN/docs/Web/API/CacheStorage"><code>CacheStorage</code></a></li><li><a href="/zh-CN/docs/Web/API/Client"><code>Client</code></a></li><li><a href="/zh-CN/docs/Web/API/Clients"><code>Clients</code></a></li><li><a href="/zh-CN/docs/Web/API/ExtendableEvent"><code>ExtendableEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/InstallEvent"><code>InstallEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/Navigator/serviceWorker"><code>Navigator.serviceWorker</code></a></li><li><a href="/zh-CN/docs/Web/API/NotificationEvent"><code>NotificationEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/PeriodicSyncEvent"><code>PeriodicSyncEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/PeriodicSyncManager"><code>PeriodicSyncManager</code></a></li><li><a href="/zh-CN/docs/Web/API/PeriodicSyncRegistration"><code>PeriodicSyncRegistration</code></a></li><li><a href="/zh-CN/docs/Web/API/ServiceWorker"><code>ServiceWorker</code></a></li><li><a href="/zh-CN/docs/Web/API/ServiceWorkerContainer"><code>ServiceWorkerContainer</code></a></li><li><a href="/zh-CN/docs/Web/API/ServiceWorkerGlobalScope"><code>ServiceWorkerGlobalScope</code></a></li><li><a href="/zh-CN/docs/Web/API/ServiceWorkerRegistration"><code>ServiceWorkerRegistration</code></a></li><li><a href="/zh-CN/docs/Web/API/SyncEvent"><code>SyncEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/SyncManager"><code>SyncManager</code></a></li><li><a href="/zh-CN/docs/Web/API/SyncRegistration"><code>SyncRegistration</code></a></li><li><a href="/zh-CN/docs/Web/API/WindowClient"><code>WindowClient</code></a></li></ol></details></li></ol></section><div class="experimental indicator-warning notecard">
    <p><span title="这是一个实验性的 API，请尽量不要在生产环境中使用它。"><i class="icon-beaker"> </i></span> <strong>这是一个实验中的功能</strong><br>此功能某些浏览器尚在开发中，请参考<a href="#Browser_compatibility">浏览器兼容性表格</a>以得到在不同浏览器中适合使用的前缀。由于该功能对应的标准文档可能被重新修订，所以在未来版本的浏览器中该功能的语法和行为可能随之改变。</p>
</div><p></p>

<p>使用<code>ServiceWorker</code>技术时,页面的提取动作会在ServiceWorker作用域(<code>ServiceWorkerGlobalScope</code>)中触发fetch事件.</p>

<p>使用 <a href="/zh-CN/docs/Web/API/ServiceWorkerGlobalScope/onfetch" title="此页面仍未被本地化, 期待您的翻译!"><code>ServiceWorkerGlobalScope.onfetch</code></a>或addEventListener监听.<br>
 该事件回调会注入<code>FetchEvent</code>参数.它携带了有关请求和结果响应的信息以及方法<a href="/zh-CN/docs/Web/API/FetchEvent/respondWith" title="FetchEvent 接口的 respondWith() 方法旨在包裹代码，这些代码为来自受控页面的request生成自定义的response。这些代码通过返回一个 Response 、 network error 或者 Fetch的方式resolve。"><code>FetchEvent.respondWith()</code></a> ,允许我们向受控页面提供任意响应.</p>

<h2 id="构造函数">构造函数</h2>

<dl>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/FetchEvent" title="此页面仍未被本地化, 期待您的翻译!"><code>FetchEvent.FetchEvent()</code></a></dt>
 <dd>Creates a new <code>FetchEvent</code> object.</dd>
</dl>

<h2 id="属性">属性</h2>

<p><em>Inherits properties from its ancestor, <a href="/zh-CN/docs/Web/API/Event" title="此页面仍未被本地化, 期待您的翻译!"><code>Event</code></a></em>.</p>

<dl>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/isReload" title="此页面仍未被本地化, 期待您的翻译!"><code>FetchEvent.isReload</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>Returns a <a href="/zh-CN/docs/Web/JavaScript/Reference/Boolean" title="此页面仍未被本地化, 期待您的翻译!"><code>Boolean</code></a> that is <code>true</code> if the event was dispatched with the user&apos;s intention for the page to reload, and <code>false</code> otherwise. Typically, pressing the refresh button in a browser is a reload, while clicking a link and pressing the back button is not.</dd>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/request" title="此页面仍未被本地化, 期待您的翻译!"><code>FetchEvent.request</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>Returns the <a href="/zh-CN/docs/Web/API/Request" title="你可以使用  Request.Request() ?构造函数创建一个Request 对象，但是你可能会遇到一个 Request 对象作为其它 API 的操作被返回，比如一个 service worker的FetchEvent.request。"><code>Request</code></a> that triggered the event handler.</dd>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/clientId" title="此页面仍未被本地化, 期待您的翻译!"><code>FetchEvent.clientId</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>Returns the id of the client that the current service worker is controlling.</dd>
</dl>

<h3 id="Deprecated_properties">Deprecated properties</h3>

<dl>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/client" title="此页面仍未被本地化, 期待您的翻译!"><code>FetchEvent.client</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></dt>
 <dd>Returns the <a href="/zh-CN/docs/Web/API/Client" title="Client 接口表示一个可执行的上下文，如Worker或SharedWorker。Window 客户端由更具体的WindowClient表示。 你可以从Clients.matchAll() 和Clients.get()等方法获取Client/WindowClient对象。"><code>Client</code></a> that the current service worker is controlling.</dd>
</dl>

<h2 id="方法">方法</h2>

<p><em>Inherits methods from its parent, </em><em><a href="/zh-CN/docs/Web/API/ExtendableEvent" title="The ExtendableEvent interface extends the lifetime of the install and activate events dispatched on the global scope as part of the service worker lifecycle. This ensures that any functional events (like FetchEvent) are not dispatched until it upgrades database schemas and deletes the outdated cache entries."><code>ExtendableEvent</code></a></em>.</p>

<dl>
 <dt><a href="/zh-CN/docs/Web/API/FetchEvent/respondWith" title="FetchEvent 接口的 respondWith() 方法旨在包裹代码，这些代码为来自受控页面的request生成自定义的response。这些代码通过返回一个 Response 、 network error 或者 Fetch的方式resolve。"><code>FetchEvent.respondWith()</code></a></dt>
 <dd>Resolves by returning a <a href="/zh-CN/docs/Web/API/Response" title="Fetch API 的Response接口呈现了对一次请求的响应数据"><code>Response</code></a> or a <a href="http://fetch.spec.whatwg.org/#concept-network-error">network error</a>  to <code style="font-style: normal;"><a href="http://fetch.spec.whatwg.org/#concept-fetch">Fetch</a></code>.</dd>
 <dt><a href="/zh-CN/docs/Web/API/ExtendableEvent/waitUntil" title="ExtendableEvent.waitUntil() 方法扩展了事件的生命周期。在服务工作线程中，延长事件的寿命从而阻止浏览器在事件中的异步操作完成之前终止服务工作线程。"><code>ExtendableEvent.waitUntil()</code></a></dt>
 <dd>
 <p>Extends the lifetime of the event.  It is intended to be called in the <code><a href="/zh-CN/docs/Web/Reference/Events/install" title="/zh-CN/docs/Web/Reference/Events/install">install</a></code> <a href="/zh-CN/docs/Web/API/EventHandler" title="此页面仍未被本地化, 期待您的翻译!"><code>EventHandler</code></a> for the <a href="/zh-CN/docs/Web/API/ServiceWorkerRegistration/installing" title="此页面仍未被本地化, 期待您的翻译!"><code>installing</code></a> worker and on the <code><a href="/zh-CN/docs/Web/Reference/Events/active" title="/zh-CN/docs/Web/Reference/Events/active">active</a></code> <a href="/zh-CN/docs/Web/API/EventHandler" title="此页面仍未被本地化, 期待您的翻译!"><code>EventHandler</code></a> for the <a href="/zh-CN/docs/Web/API/ServiceWorkerRegistration/active" title="The active property of the ServiceWorkerRegistration interface returns a service worker whose ServiceWorker.state is activating or activated. This property is initially set to null."><code>active</code></a> worker.</p>
 </dd>
</dl>

<h2 id="示例">示例</h2>

<p>This code snippet is from the <a href="https://github.com/GoogleChrome/samples/blob/gh-pages/service-worker/prefetch/service-worker.js">service worker fetch sample</a> (<a href="https://googlechrome.github.io/samples/service-worker/prefetch/">run the fetch sample live</a>). In an earlier part of the code,  an <a href="/zh-CN/docs/Web/API/InstallEvent" title="该参数传递到 oninstall 事件处理程序，InstallEvent接口表示一个 ServiceWorker 的 ServiceWorkerGlobalScope 上分派的安装操作。作为 ExtendableEvent 的一个子类，它确保在安装期间不调度诸如 FetchEvent 之类的功能事件。"><code>InstallEvent</code></a> controls caching of a number of resources. The <a href="/zh-CN/docs/Web/API/ServiceWorkerGlobalScope/onfetch" title="此页面仍未被本地化, 期待您的翻译!"><code>ServiceWorkerGlobalScope.onfetch</code></a> event handler then listens for the <code><a href="/zh-CN/docs/Web/Reference/Events/fetch" title="/zh-CN/docs/Web/Reference/Events/fetch">fetch</a></code> event. When fired, <a href="/zh-CN/docs/Web/API/FetchEvent/respondWith" title="FetchEvent 接口的 respondWith() 方法旨在包裹代码，这些代码为来自受控页面的request生成自定义的response。这些代码通过返回一个 Response 、 network error 或者 Fetch的方式resolve。"><code>FetchEvent.respondWith()</code></a> returns a promise back to the controlled page. This promise resolves to the first matching URL request in the <a href="/zh-CN/docs/Web/API/Cache" title="Cache 接口为缓存的 Request / Response  对象对提供存储机制，例如，作为ServiceWorker 生命周期的一部分。请注意，Cache 接口像 workers 一样，是暴露在 window 作用域下的。尽管它被定义在 service worker 的标准中,  但是它不必一定要配合 service worker 使用."><code>Cache</code></a> object. If no match is found (i.e. that resource wasn&apos;t cached in the install phase), the code fetches a response from the network.</p>

<p>The code also handles exceptions thrown from the <a href="/zh-CN/docs/Web/API/ServiceWorkerGlobalScope/fetch" title="此页面仍未被本地化, 期待您的翻译!"><code>ServiceWorkerGlobalScope.fetch()</code></a> operation. Note that a HTTP error response (e.g., 404) doesn&apos;t trigger an exception. It returns a normal response object that has the appropriate error code set.</p>

<pre class="brush: js">self.addEventListener(&apos;fetch&apos;, function(event) {
  console.log(&apos;Handling fetch event for&apos;, event.request.url);

  event.respondWith(
    caches.match(event.request).then(function(response) {
      if (response) {
        console.log(&apos;Found response in cache:&apos;, response);

        return response;
      }
      console.log(&apos;No response found in cache. About to fetch from network...&apos;);

      return fetch(event.request).then(function(response) {
        console.log(&apos;Response from network is:&apos;, response);

        return response;
      }).catch(function(error) {
        console.error(&apos;Fetching failed:&apos;, error);

        throw error;
      });
    })
  );
});</pre>

<h2 id="规范">规范</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a lang="en" href="https://w3c.github.io/ServiceWorker/#fetch-event-section" class="external" hreflang="en">Service Workers<br><small lang="zh-CN">FetchEvent</small></a></td>
   <td><span class="spec-WD">Working Draft</span></td>
   <td>Initial definition.</td>
  </tr>
 </tbody>
</table>

<h2 id="浏览器兼容性">浏览器兼容性</h2>

<div><div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/zh-CN/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Desktop</a></li>
        <li><a>Mobile</a></li>
    </ul>
</div></div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Chrome</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari (WebKit)</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>40.0</td>
   <td><a href="/en-US/Firefox/Releases/44">44.0</a> (44.0)[<sup>1]</sup></td>
   <td><span style="color: #f00;">未实现</span></td>
   <td>24</td>
   <td><span style="color: #f00;">未实现</span></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Android</th>
   <th>Android Webview</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>Firefox OS</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
   <th>Chrome for Android</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td><span style="color: #f00;">未实现</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td>44.0 (44.0)</td>
   <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td>
   <td><span style="color: #f00;">未实现</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></td>
   <td><span style="color: #f00;">未实现</span></td>
   <td>44.0</td>
  </tr>
 </tbody>
</table>
</div>

<p>[1] Service workers (and <a href="/en-US/docs/Web/API/Push_API">Push</a>) have been disabled in the <a href="https://www.mozilla.org/en-US/firefox/organizations/">Firefox 45 and 52 Extended Support Releases</a> (ESR.)</p>

<h2 id="请参见">请参见</h2>

<ul>
 <li><a href="/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a></li>
 <li><a href="/en-US/docs/Web/API/Fetch_API">Fetch API</a></li>
</ul>
