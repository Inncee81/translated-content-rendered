---
title: IDBDatabase
slug: Web/API/IDBDatabase
tags:
  - IDBDatabase
translation_of: Web/API/IDBDatabase
---
<section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/zh-CN/docs/Web/API/IndexedDB_API">IndexedDB API</a></strong></li><li><strong><a href="/zh-CN/docs/Web/API/IDBDatabase"><code>IDBDatabase</code></a></strong></li><li class="toggle"><details open><summary>属性</summary><ol><li><a href="/zh-CN/docs/Web/API/IDBDatabase/name"><code>name</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/name$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/objectStoreNames"><code>objectStoreNames</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/objectStoreNames$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/onabort"><code>onabort</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/onabort$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/onclose"><code>onclose</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/onclose$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/onerror"><code>onerror</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/onerror$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/onversionchange"><code>onversionchange</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/version"><code>version</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/version$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>方法</summary><ol><li><a href="/zh-CN/docs/Web/API/IDBDatabase/close"><code>close()</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/close$translate" style="opacity: 0.5;">[我来译!]</a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/createObjectStore"><code>createObjectStore()</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/deleteObjectStore"><code>deleteObjectStore()</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabase/transaction"><code>transaction()</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/transaction$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>Events</summary><ol><li><a href="/zh-CN/docs/Web/API/IDBDatabase/versionchange_event"><code>versionchange</code></a> <a href="/zh-CN/docs/Web/API/IDBDatabase/versionchange_event$translate" style="opacity: 0.5;">[我来译!]</a></li></ol></details></li><li class="toggle"><details open><summary>继承</summary><ol><li><a href="/zh-CN/docs/Web/API/EventTarget"><code>EventTarget</code></a></li></ol></details></li><li class="toggle"><details open><summary>Related pages for IndexedDB</summary><ol><li><a href="/zh-CN/docs/Web/API/IDBCursor"><code>IDBCursor</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBCursorSync"><code>IDBCursorSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBCursorWithValue"><code>IDBCursorWithValue</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabaseException"><code>IDBDatabaseException</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBDatabaseSync"><code>IDBDatabaseSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBEnvironment"><code>IDBEnvironment</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBEnvironmentSync"><code>IDBEnvironmentSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBFactory"><code>IDBFactory</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBFactorySync"><code>IDBFactorySync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBIndex"><code>IDBIndex</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBIndexSync"><code>IDBIndexSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBKeyRange"><code>IDBKeyRange</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBObjectStore"><code>IDBObjectStore</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBObjectStoreSync"><code>IDBObjectStoreSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBOpenDBRequest"><code>IDBOpenDBRequest</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBRequest"><code>IDBRequest</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBTransaction"><code>IDBTransaction</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBTransactionSync"><code>IDBTransactionSync</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBVersionChangeEvent"><code>IDBVersionChangeEvent</code></a></li><li><a href="/zh-CN/docs/Web/API/IDBVersionChangeRequest"><code>IDBVersionChangeRequest</code></a></li></ol></details></li></ol></section>

<div>
<p>IndexedDB 中的 <strong><code>IDBDatabase</code></strong> 接口提供一个到 <a href="/en-US/docs/IndexedDB#database_connection">数据库的连接</a>; 你可以使用 <code>IDBDatabase</code> 对象在数据库中打开一个<a href="/en-US/docs/IndexedDB#gloss_transaction">transaction</a> , 然后进行操作或者删除数据库中的对象。这是唯一一个能够访问和管理数据库版本的接口。 </p>



<div class="note notecard"><strong>Note:</strong> 此特性在 <a href="/zh-CN/docs/Web/API/Web_Workers_API">Web Worker</a> 中可用。</div>
</div>

<div class="note">
<p><strong>注意</strong>:在IndexedDB中所做的所有事情总是发生在<a href="/en-US/docs/IndexedDB/Basic_Concepts_Behind_IndexedDB#gloss_transaction">事务</a>的上下文中，表示与数据库中的数据的交互。IndexedDB中的所有对象——包括对象存储、索引和游标——都与特定事务绑定。因此，在事务之外您不能执行命令、访问数据或打开任何东西。</p>
</div>

<div class="note">
<p><strong>注意</strong>：请注意，从Firefox 40开始，IndexedDB事务具有宽松的持久性保证以提高性能（请参阅<a class="external external-icon" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1112702" rel="noopener" title="FIXED: Switch IndexedDB transactions to be non-durable by default">bug 1112702</a>）以前在<code>readwrite</code>事务中<a class="new" href="/zh-CN/docs/Web/API/IDBTransaction/oncomplete" rel="nofollow" title="此页面仍未被本地化, 期待您的翻译!"><code>IDBTransaction.oncomplete</code></a>被触发只有当所有数据都保证已刷新到磁盘时。在Firefox 40+中，<code>complete</code>事件在操作系统被告知写入数据之后被触发，但可能在该数据实际上被刷新到磁盘之前。该<code>complete</code>因此，事件可以比以前更快地传递，但是，如果操作系统崩溃或者在将数据刷新到磁盘之前系统电源丢失，则整个事务将丢失的可能性很小。由于这种灾难性事件很少见，大多数消费者不应该进一步关注自己。<font>如果由于某种原因必须确保持久性（例如，您要存储以后无法重新计算的关键数据），则可以<code>complete</code>通过使用实验（非标准）<code>readwriteflush</code>模式创建事务来强制事务在传递事件之前刷新到磁盘（请参阅<a class="new" href="/zh-CN/docs/Web/API/IDBDatabase/transaction" rel="nofollow" title="此页面仍未被本地化, 期待您的翻译!"><code>IDBDatabase.transaction</code></a>）。</font></p>
</div>

<h2 id="方法"><font>方法</font></h2>

<p><font>继承自: <a href="/en-US/docs/DOM/EventTarget">EventTarget</a></font></p>

<dl>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/close"><code>IDBDatabase.close()</code></a></font></dt>
 <dd><font>在一个单独的线程中关闭数据库连接并立即返回。</font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/createObjectStore"><code>IDBDatabase.createObjectStore()</code></a></font></dt>
 <dd><font>创建并返回一个新的 object store 或者 index。</font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/deleteObjectStore"><code>IDBDatabase.deleteObjectStore()</code></a></font></dt>
 <dd><font>根据给定的名字，删除在当前连接的数据库中的 object store 和 相关的索引。 </font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/transaction"><code>IDBDatabase.transaction()</code></a></font></dt>
 <dd><font>立即返回一个包含<a href="/zh-CN/docs/Web/API/IDBTransaction/objectStore"><code>IDBTransaction.objectStore</code></a> 方法的 transaction 对象。你可以用这个对象来操作object store。这个操作是在一个单独的线程中执行的。</font></dd>
</dl>

<h2 id="属性"><font>属性</font></h2>

<dl>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/name"><code>IDBDatabase.name</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></font></dt>
 <dd><font><a href="/zh-CN/docs/Web/API/DOMString"><code>DOMString</code></a>类型，当前连接数据库名  。</font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/version"><code>IDBDatabase.version</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></font></dt>
 <dd><font><a href="/en-US/docs/NSPR_API_Reference/Long_Long_(64-bit)_Integers">64-bit </a>整型数，当前连接数据库的版本 。当数据第一次被创建时，这个属性是一个空的字符串。 </font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/objectStoreNames"><code>IDBDatabase.objectStoreNames</code></a> <span class="readOnly readOnlyInline notecard inline" title="该属性的值无法更改">只读 </span></font></dt>
 <dd><font><a href="/zh-CN/docs/Web/API/DOMStringList"><code>DOMStringList</code></a>类型，当前连接连接数据库中所有的object store 名字列表。</font></dd>
</dl>

<h3 id="Event_handlers"><font>Event handlers</font></h3>

<dl>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/onabort"><code>IDBDatabase.onabort</code></a></font></dt>
 <dd><font>在中断数据库访问时触发。</font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/onerror"><code>IDBDatabase.onerror</code></a></font></dt>
 <dd><font>当访问数据库失败时触发。</font></dd>
 <dt><font><a href="/zh-CN/docs/Web/API/IDBDatabase/onversionchange"><code>IDBDatabase.onversionchange</code></a></font></dt>
 <dd>
 <p><font>当数据库结构发生更改时触发</font></p>

 <p><font>(<a href="/zh-CN/docs/Web/API/IDBOpenDBRequest/onupgradeneeded"><code>IDBOpenDBRequest.onupgradeneeded</code></a>事件或</font>在其他地方请求<font><code> </code><a href="/zh-CN/docs/Web/API/IDBFactory/deleteDatabase"><code>IDBFactory.deleteDatabase</code></a> 时（</font>最可能在同一台计算机上的另一个窗口/选项卡中<font>）</font>这与版本更改事务（请参阅参考资料<font><a href="/zh-CN/docs/Web/API/IDBVersionChangeEvent"><code>IDBVersionChangeEvent</code></a>)</font>不同，但它是相关的。</p>
 </dd>
</dl>

<h2 id="example" name="example"><font>示例</font></h2>

<p><font>在下面的代码中, 异步打开了一个数据库连接 (<a href="/zh-CN/docs/Web/API/IDBFactory"><code>IDBFactory</code></a>), 并处理成功或者异常事件, 如果触发了upgrade事件就需要创建一个新的object store  (<a href="/zh-CN/docs/Web/API/IDBdatabase"><code>IDBdatabase</code></a>)。如果想看完整的例子, 可以使用 <a href="https://github.com/mdn/to-do-notifications/">To-do Notifications</a> 应用(<a href="http://mdn.github.io/to-do-notifications/">view example live</a>.)</font></p>

<pre class="brush: js;highlight:[13,24,26,27,28,32] notranslate"><font>
// 我们先打开一个数据库
  var DBOpenRequest = window.indexedDB.open(&quot;toDoList&quot;, 4);

  // 当数据库打开出错/成功时，以下两个事件处理程序将分别对IDBDatabase对象进行下一步操作
  DBOpenRequest.onerror = function(event) {
    note.innerHTML += &apos;&lt;li&gt;Error loading database.&lt;/li&gt;&apos;;
  };

  DBOpenRequest.onsuccess = function(event) {
    note.innerHTML += &apos;&lt;li&gt;Database initialised.&lt;/li&gt;&apos;;

    // 将打开数据库的结果存储在db变量中，该变量将在后面的代码中被频繁使用
    db = DBOpenRequest.result;

    // 运行displayData()方法，用IDB中已经存在的所有待办事项列表数据填充到任务列表中
    displayData();
  };

  // 当试图打开一个尚未被创建的数据库，或者试图连接一个数据库还没被创立的版本时，onupgradeneeded事件会被触发

  DBOpenRequest.onupgradeneeded = function(event) {
    var db = event.target.result;

    db.onerror = function(event) {
      note.innerHTML += &apos;&lt;li&gt;Error loading database.&lt;/li&gt;&apos;;
    };

    // 使用IDBDatabase.createObjectStore方法，可创建一个对象存储区

    var objectStore = db.createObjectStore(&quot;toDoList&quot;, { keyPath: &quot;taskTitle&quot; });

    // 定义objectStore将包含哪些数据项

    objectStore.createIndex(&quot;hours&quot;, &quot;hours&quot;, { unique: false });
    objectStore.createIndex(&quot;minutes&quot;, &quot;minutes&quot;, { unique: false });
    objectStore.createIndex(&quot;day&quot;, &quot;day&quot;, { unique: false });
    objectStore.createIndex(&quot;month&quot;, &quot;month&quot;, { unique: false });
    objectStore.createIndex(&quot;year&quot;, &quot;year&quot;, { unique: false });

    objectStore.createIndex(&quot;notified&quot;, &quot;notified&quot;, { unique: false });

    note.innerHTML += &apos;&lt;li&gt;Object store created.&lt;/li&gt;&apos;;
  };</font></pre>

<p><font>下一行打开数据库上的事务，然后打开一个对象存储，然后我们可以在其中操作数据。</font></p>

<pre class="brush: js notranslate"><font>
    var objectStore = db.transaction(&apos;toDoList&apos;).objectStore(&apos;toDoList&apos;); </font></pre>

<h2 id="规范"><font>规范</font></h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col"><font>Specification</font></th>
   <th scope="col"><font>Status</font></th>
   <th scope="col"><font>Comment</font></th>
  </tr>
  <tr>
   <td><font><a class="external" href="https://www.w3.org/TR/IndexedDB/#idl-def-IDBDatabase" hreflang="en" lang="en">Indexed Database API 2.0<br><small lang="zh-CN">IDBDatabase</small></a></font></td>
   <td><font><span class="spec-REC">Recommendation</span></font></td>
   <td><font> </font></td>
  </tr>
 </tbody>
</table>

<h2 id="Browser_compatibility" name="Browser_compatibility"><font>浏览器兼容性</font></h2>

<div><font><div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/zh-CN/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Desktop</a></li>
        <li><a>Mobile</a></li>
    </ul>
</div></font></div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th><font>Feature</font></th>
   <th><font>Chrome</font></th>
   <th><font>Firefox (Gecko)</font></th>
   <th><font>Internet Explorer</font></th>
   <th><font>Opera</font></th>
   <th><font>Safari (WebKit)</font></th>
  </tr>
  <tr>
   <td><font>Basic support</font></td>
   <td><font>23<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes">webkit</a></span><br>
    24</font></td>
   <td><font>10 <span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/zh-CN/docs/Web/Guide/Prefixes">moz</a></span><br>
    <a href="/en-US/Firefox/Releases/16">16.0</a> (16.0)</font></td>
   <td><font>10, partial</font></td>
   <td><font>15</font></td>
   <td><font>7.1</font></td>
  </tr>
  <tr>
   <td><font>Available in workers</font></td>
   <td><font><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></font></td>
   <td><font>37.0 (37.0)</font></td>
   <td><font><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></font></td>
   <td><font><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></font></td>
   <td><font><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></font></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th><font>Feature</font></th>
   <th><font>Android</font></th>
   <th><font>Firefox Mobile (Gecko)</font></th>
   <th><font>Firefox OS</font></th>
   <th><font>IE Phone</font></th>
   <th><font>Opera Mobile</font></th>
   <th><font>Safari Mobile</font></th>
  </tr>
  <tr>
   <td><font>Basic support</font></td>
   <td><font>4.4</font></td>
   <td><font>22.0 (22.0)</font></td>
   <td><font>1.0.1</font></td>
   <td><font>10</font></td>
   <td><font>22</font></td>
   <td><font>8</font></td>
  </tr>
  <tr>
   <td><font>Available in workers</font></td>
   <td><font><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></font></td>
   <td><font>37.0 (37.0)</font></td>
   <td><font><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></font></td>
   <td><font><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></font></td>
   <td><font><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></font></td>
   <td><font><span style="color: rgb(255, 153, 0);" title="Compatibility unknown; please update this.">?</span></font></td>
  </tr>
 </tbody>
</table>
</div>

<div class="warning notecard">
<p><font>Be careful in Chrome as it still implements the old specification along with the new one. Similarly it still has the prefixed <code>webkitIndexedDB</code> property even if the unprefixed <code>indexedDB</code> is present.</font></p>
</div>

<h2 id="See_also"><font>See also</font></h2>

<ul>
 <li><font><a href="/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB">Using IndexedDB</a></font></li>
 <li><font>Starting transactions: <a href="/zh-CN/docs/Web/API/IDBDatabase"><code>IDBDatabase</code></a></font></li>
 <li><font>Using transactions: <a href="/zh-CN/docs/Web/API/IDBTransaction"><code>IDBTransaction</code></a></font></li>
 <li><font>Setting a range of keys: <a href="/zh-CN/docs/Web/API/IDBKeyRange"><code>IDBKeyRange</code></a></font></li>
 <li><font>Retrieving and making changes to your data: <a href="/zh-CN/docs/Web/API/IDBObjectStore"><code>IDBObjectStore</code></a></font></li>
 <li><font>Using cursors: <a href="/zh-CN/docs/Web/API/IDBCursor"><code>IDBCursor</code></a></font></li>
 <li><font>Reference example: <a class="external" href="https://github.com/mdn/to-do-notifications/tree/gh-pages">To-do Notifications</a> (<a class="external" href="http://mdn.github.io/to-do-notifications/">view example live</a>.)</font></li>
</ul>

<p><font> </font></p>
