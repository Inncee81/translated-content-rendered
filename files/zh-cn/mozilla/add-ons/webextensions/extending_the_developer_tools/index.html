---
title: 扩展开发人员工具
slug: Mozilla/Add-ons/WebExtensions/Extending_the_developer_tools
tags:
  - Add-ons
  - DevTools
  - Guide
  - WebExtensions
translation_of: Mozilla/Add-ons/WebExtensions/Extending_the_developer_tools
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions"><strong>浏览器扩展程序</strong></a></li>
    <li class="toggle">
      <details>
        <summary>开始</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_are_WebExtensions">什么是扩展程序?</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_first_WebExtension">你的第一个扩展程序</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Your_second_WebExtension">你的第二个扩展程序</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Anatomy_of_a_WebExtension">详解扩展程序</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Examples">扩展程序示例</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/What_next_">接下来呢?</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>概念</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Using_the_JavaScript_APIs">使用 JavaScript APIs</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_scripts">Content scripts</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Match_patterns">匹配样式</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_files">处理文件</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Internationalization">国际化</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices">安全最佳实践</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Content_Security_Policy">内容安全举措</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Native_messaging">本地消息</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>用户界面</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface">用户界面</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Accessibility_guidelines">无障碍指南</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Browser_action">工具栏按钮</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Page_actions">地址栏按钮</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Sidebars">侧边栏</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Context_menu_items">上下文菜单项</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Options_pages">选项页面</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Extension_pages">扩展页面</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Notifications">通知</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/Omnibox">地址栏建议</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/user_interface/devtools_panels">开发人员工具面板</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>怎么做</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Intercept_HTTP_requests">拦截HTTP 请求</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Modify_a_web_page">修改网页</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Safely_inserting_external_content_into_a_page">插入外部内容</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Sharing_objects_with_page_scripts">Share objects with page scripts</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Add_a_button_to_the_toolbar">向工具栏添加按钮</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Implement_a_settings_page">应用设置页面</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Working_with_the_Tabs_API">使用Tabs API</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Bookmarks_API">使用Bookmarks API</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_the_Cookies_API">使用Cookies API</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Work_with_contextual_identities">使用上下文身份</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Build_a_cross_browser_extension">构建跨浏览器扩展</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/onboarding_upboarding_offboarding_best_practices">Onboard, upboard, and offboard users</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>移植</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Firefox_differentiators">Firefox的优势</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Porting_a_Google_Chrome_extension">移植Google Chrome扩展程序</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Porting_a_legacy_Firefox_add-on">移植旧版Firefox扩展</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_the_Add-on_SDK">与附加SDK的比较</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Comparison_with_XUL_XPCOM_extensions">与XUL / XPCOM扩展的比较</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Differences_between_API_implementations">API实现之间的差异</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Chrome_incompatibilities">Chrome不兼容</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Differences_between_desktop_and_Android">桌面版和Android之间的区别</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>Firefox工作流程</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Development_Tools">开发者工具</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Choose_a_Firefox_version_for_web_extension_develop">选择Firefox版本</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/User_experience_best_practices">用户体验</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Prompt_users_for_data_and_privacy_consents">提示用户输入数据和隐私权</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Temporary_Installation_in_Firefox">Firefox中临时安装</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Debugging">调试</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Testing_persistent_and_restart_features">测试持久性和重新启动功能</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Test_permission_requests">测试许可请求</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Developing_WebExtensions_for_Firefox_for_Android">为Android的Firefox开发</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Getting_started_with_web-ext">Web-ext入门</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/web-ext_command_reference">web-ext命令参考</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/WebExtensions_and_the_Add-on_ID">扩展和附加ID</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Request_the_right_permissions">请求正确的权限</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Best_practices_for_updating_your_extension">更新扩展程序的最佳做法</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>JavaScript APIs</summary>
        <ol><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Browser_support_for_JavaScript_APIs">Browser support for JavaScript APIs</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/alarms">alarms</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/bookmarks">bookmarks</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/browserAction">browserAction</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/captivePortal">captivePortal</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/%E5%89%AA%E5%88%87%E6%9D%BF">%E5%89%AA%E5%88%87%E6%9D%BF</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts">contentScripts</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/contextMenus">contextMenus</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/cookies">cookies</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow">devtools.inspectedWindow</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/downloads">downloads</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/history">history</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/idle">idle</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/proxy">proxy</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime">runtime</a></li><li><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/sessions">sessions</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/storage">storage</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs">tabs</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation">webNavigation</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/webRequest">webRequest</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/windows">windows</a></li></ol>
      </details>
    </li>

    <li class="toggle">
      <details>
      <summary>Manifest keys</summary>
      <ol><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_specific_settings">applications</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/browser_action">browser_action</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/content_scripts">content_scripts</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/default_locale">default_locale</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/developer">developer</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/%E4%B8%BB%E9%A1%B5%E5%9C%B0%E5%9D%80">homepage_url</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/manifest_version">manifest_version</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/version">version</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/web_accessible_resources">web_accessible_resources</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/author">作者 - author</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/name">名称 - name</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/background">后台 - background</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/description">描述 - description</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/permissions">权限 - permissions</a></li><li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/manifest.json/short_name">短名称 - short_name</a></li></ol>
      </details>
    </li>
    <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Distribution_options">发行选项</a></li>
    <li><a href="/zh-CN/docs/Mozilla/Add-ons/Themes"><strong>主题</strong></a></li>
    <li class="toggle">
      <details>
        <summary>浏览器主题</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Themes/Theme_concepts">浏览器主题的概念</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Themes/Using_the_AMO_theme_generator">使用AMO主题生成器</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution"><strong>发布和分发</strong></a></li>
    <li class="toggle">
      <details>
        <summary>发布附加组件</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Developer_accounts">开发者帐户</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution">签名和分发概述</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Package_your_extension_">打包您的扩展</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution/Submitting_an_add-on">提交附加组件</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Source_Code_Submission">提交源代码</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution/Resources_for_publishers">为发布者准备的资源</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Listing">创建一个有吸引力的清单</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution/Make_money_from_browser_extensions">通过浏览器扩展盈利</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution/Promoting_your_extension_or_theme">宣传您的扩展程序或主题</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/AMO/Policy/Reviews">附加政策</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/AMO/Policy/Agreement">开发者协议</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/AMO/Policy/Featured">精选插件</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/Distribution/Retiring_your_extension">下架您的扩展程序</a></li>
        </ol>
      </details>
    </li>
    <li class="toggle">
      <details>
        <summary>分发附加组件</summary>
        <ol>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Sideloading_add-ons">用于旁加载</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_for_desktop_apps">用于桌面应用</a></li>
          <li><a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/Alternative_distribution_options/Add-ons_in_the_enterprise">用于企业</a></li>
        </ol>
      </details>
    </li>
    <li><a href="/zh-CN/docs/Mozilla/Add-ons/Contact_us"><strong>联系我们</strong></a></li>
    <li class="toggle">
      <details>
        <summary>渠道</summary>
        <ol>
          <li><a href="https://blog.mozilla.org/addons">Add-ons博客</a></li>
          <li><a href="https://discourse.mozilla.org/c/add-ons">Add-ons论坛</a></li>
          <li><a href="https://chat.mozilla.org/#/room/%23addons:mozilla.org">Add-ons chat</a></li>
        </ol>
      </details>
    </li>
  </ol>
</section></div>

<div class="note notecard">
<p>本页介绍了火狐 Firefox 55中存在的开发工具接口（dectools APIs)。 虽然该接口Api基于 Chrome 开发工具Api，仍有许多功能尚未实现在火狐中实现，因此未记录在本页内容中。产看当前缺失的功能，请参阅链接<a href="https://developer.mozilla.org/en-US/Add-ons/WebExtensions/Using_the_devtools_APIs#Limitations_of_the_devtools_APIs">开发工具Api的限制.</a></p>
</div>

<p>您可以使用WebExtensions API扩展浏览器的内置开发人员工具。要创建devtools扩展，请在manifest.json中包含“ devtools_page”键：</p>

<pre class="brush: json notranslate">&quot;devtools_page&quot;: &quot;devtools/devtools-page.html&quot;</pre>

<p>此项的值是指向与您的扩展程序捆绑在一起的HTML文件的URL。该URL应相对于manifest.json文件本身。</p>

<p>HTML文件在扩展中定义了一个特殊页面，称为devtools页面。</p>

<h2 id="devtools页面">devtools页面</h2>

<p>当打开浏览器devtools时，将加载devtools页面，并在关闭浏览器时将其卸载。请注意，由于devtools窗口与单个选项卡相关联，因此很可能同时存在多个devtools窗口-因此有多个devtools页面。</p>

<p>devtools页面没有任何可见的DOM，但可以包含使用&lt;script&gt;标记的JavaScript源。源必须与扩展本身捆绑在一起。来源可以访问：:</p>

<ul>
 <li>可通过全局窗口对象访问的普通DOM API</li>
 <li>与内容脚本中相同的WebExtension API</li>
 <li>The devtools APIs:
  <ul>
   <li><code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.inspectedWindow">devtools.inspectedWindow</a></code></li>
   <li><code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.network">devtools.network</a></code></li>
   <li><code><a href="/en-US/docs/Mozilla/Add-ons/WebExtensions/API/devtools.panels">devtools.panels</a></code></li>
  </ul>
 </li>
</ul>

<p>请注意，devtools页面无法访问任何其他WebExtension API，并且后台页面无法访问devtools API。相反，devtools页面和后台页面必须使用运行时消息传递API进行通信。这是一个例子:</p>

<pre class="brush: html notranslate">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;script src=&quot;devtools.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

<p>devtools.js文件将保存创建您的dev工具扩展的实际代码。</p>

<h2 id="创建面板">创建面板</h2>

<p>devtools窗口中包含许多单独的工具-JavaScript调试器，网络监视器等。顶部的一排标签可让用户在不同的工具之间切换。承载每个工具的用户界面的窗口称为“面板”</p>

<p>使用devtools.panels.create（）API，可以在devtools窗口中创建自己的面板：</p>

<pre class="brush: js notranslate">browser.devtools.panels.create(
  &quot;My Panel&quot;,                      // title
  &quot;icons/star.png&quot;,                // icon
  &quot;devtools/panel/panel.html&quot;      // content
).then((newPanel) =&gt; {
  newPanel.onShown.addListener(initialisePanel);
  newPanel.onHidden.addListener(unInitialisePanel);
});</pre>

<p>这需要三个必选参数：面板的标题，图标和内容。它返回一个Promise，该Promise解析为代表新面板的devtools.panels.ExtensionPanel对象。</p>

<h2 id="与目标窗口互动">与目标窗口互动</h2>

<p>开发人员工具始终附加到特定的浏览器选项卡。这称为开发人员工具的“目标”或“检查的窗口”。您可以使用devtools.inspectedWindow API与检查的窗口进行交互。</p>

<h3 id="Running_code_in_the_target_window">Running code in the target window</h3>

<p>devtools.inspectedWindow.eval（）提供了一种在检查的窗口中运行代码的方法。</p>

<p>这有点像使用<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript" title="将 JavaScript 代码注入页面。"><code>tabs.executeScript()</code></a>注入内容脚本，但有一个重要区别：</p>

<ul>
 <li>与内容脚本不同，使用devtools.inspectedWindow.eval（）加载的脚本不会获得“ DOM的清晰视图”：也就是说，它们可以看到页面脚本对页面所做的更改。</li>
</ul>

<div class="note notecard">
<p>请注意，DOM的清晰视图是一项安全功能，旨在通过重新定义本机DOM功能的行为来帮助防止恶意页面欺骗扩展。这意味着您需要非常小心地使用eval（），并应尽可能使用普通的内容脚本。</p>
</div>

<p>devtools.inspectedWindow.eval（）加载的脚本也看不到内容脚本定义的任何JavaScript变量。</p>

<h3 id="Working_with_content_scripts">Working with content scripts</h3>

<p>devtools文档无法直接访问<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript" title="将 JavaScript 代码注入页面。"><code>tabs.executeScript()</code></a>，因此，如果需要注入内容脚本，devtools文档必须向后台脚本发送一条消息，要求其注入剧本。 devtools.inspectedWindow.tabId提供目标选项卡的ID：devtools文档可以将其传递给后台脚本，而后台脚本又可以将其传递给<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/tabs/executeScript" title="将 JavaScript 代码注入页面。"><code>tabs.executeScript()</code></a>：</p>

<pre class="brush: js notranslate">// devtools-panel.js

const scriptToAttach = &quot;document.body.innerHTML = &apos;Hi from the devtools&apos;;&quot;;

window.addEventListener(&quot;click&quot;, () =&gt; {
  browser.runtime.sendMessage({
    tabId: browser.devtools.inspectedWindow.tabId,
    script: scriptToAttach
  });
});</pre>

<pre class="brush: js notranslate">// background.js

function handleMessage(request, sender, sendResponse) {
  browser.tabs.executeScript(request.tabId, {
    code: request.script
  });
}

browser.runtime.onMessage.addListener(handleMessage);</pre>

<p>如果您需要在目标窗口中运行的内容脚本和devtools文档之间交换消息，则最好使用<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/connect" title="此页面仍未被本地化, 期待您的翻译!"><code>runtime.connect()</code></a>和<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onConnect" title="当使用扩展处理或content script建立连接时触发."><code>runtime.onConnect()</code></a>，以在后台页面和devtools文档之间建立连接。然后，后台页面可以维护选项卡ID和<a href="/zh-CN/docs/Mozilla/Add-ons/WebExtensions/API/runtime/Port" title="此页面仍未被本地化, 期待您的翻译!"><code>runtime.Port</code></a>对象之间的映射，并使用此映射在两个作用域之间路由消息。</p>

<p><img alt src="https://mdn.mozillademos.org/files/14923/devtools-content-scripts.png" style="display: block; height: 416px; margin-left: auto; margin-right: auto; width: 600px;"></p>

<h2 id="devtools_API的局限性">devtools API的局限性</h2>

<p>这些API基于Chrome devtools API，但与Chrome相比，许多功能仍缺失。本节列出了从Firefox 54开始尚未实现的功能。请注意，devtools API正在积极开发中，我们希望在将来的版本中增加对其中大多数功能的支持。</p>

<h3 id="devtools.inspectedWindow">devtools.inspectedWindow</h3>

<p>The following are not supported:</p>

<ul>
 <li><code>inspectedWindow.getResources()</code></li>
 <li><code>inspectedWindow.onResourceAdded</code></li>
 <li><code>inspectedWindow.onResourceContentCommitted</code></li>
</ul>

<p>None of the options to <code>inspectedWindow.eval()</code> are supported.</p>

<p>使用inspectedWindow.eval（）注入的脚本不能使用控制台的所有命令行帮助器功能，但是都支持$ 0和inspect（...）（从Firefox 55开始）。</p>

<h3 id="devtools.panels">devtools.panels</h3>

<p>The following are not supported:</p>

<ul>
 <li><code>panels.elements</code></li>
 <li><code>panels.sources</code></li>
 <li><code>panels.setOpenResourceHandler()</code></li>
 <li><code>panels.openResource()</code></li>
 <li><code>panels.ExtensionPanel.createStatusBarButton()</code></li>
 <li><code>panels.Button</code></li>
 <li><code>panels.ElementsPanel</code></li>
 <li><code>panels.SourcesPanel</code></li>
</ul>

<h2 id="Examples">Examples</h2>

<p>The <a href="https://github.com/mdn/webextensions-examples">webextensions-examples</a> repo on GitHub, contains several examples of extensions that use devtools panels:</p>

<ul>
 <li>
  <p><a href="https://github.com/mdn/webextensions-examples/blob/master/devtools-panels/">devtools-panels</a> use devtools panels:</p>
 </li>
</ul>
