---
title: HTTP 条件付きリクエスト
slug: Web/HTTP/Conditional_requests
tags:
  - Conditional Requests
  - Guide
  - HTTP
translation_of: Web/HTTP/Conditional_requests
---
<p></p><section class="Quick_links" id="Quick_Links">
  <ol>
    <li><a href="/ja/docs/Web/HTTP"><strong><em>HTTP</em></strong></a></li>
    <li><strong>Guides:</strong></li>
    <li class="toggle">
        <details>
            <summary>Resources and URIs</summary>
            <ol>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/Identifying_resources_on_the_Web">Identifying resources on the Web</a></li>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">Data URIs</a></li>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/MIME_Types">Introduction to MIME Types</a></li>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Complete_list_of_MIME_types">Complete list of MIME Types</a></li>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/Choosing_between_www_and_non-www_URLs">Choosing between www and non-www URLs</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP guide</summary>
            <ol>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP">Basics of HTTP</a></li>
                <li><a href="/ja/docs/Web/HTTP/Overview">Overview of HTTP</a></li>
                <li><a href="/ja/docs/Web/HTTP/Basics_of_HTTP/Evolution_of_HTTP">Evolution of HTTP</a></li>
                <li><a href="/ja/docs/Web/HTTP/Messages">HTTP Messages</a></li>
                <li><a href="/ja/docs/Web/HTTP/Session">A typical HTTP session</a></li>
                <li><a href="/ja/docs/Web/HTTP/Connection_management_in_HTTP_1.x">Connection management in HTTP/1.x</a></li>
                <li><a href="/ja/docs/Web/HTTP/Protocol_upgrade_mechanism">Protocol upgrade mechanism</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP security</summary>
            <ol>
                <li><a href="/ja/docs/Web/HTTP/CSP">Content Security Policy (CSP)</a></li>
                <li><a href="/ja/docs/Web/HTTP/Public_Key_Pinning">HTTP Public Key Pinning (HPKP)</a></li>
                <li><a href="/ja/docs/Web/HTTP/Headers/Strict-Transport-Security">HTTP Strict Transport Security (HSTS)</a></li>
                <li><a href="/ja/docs/Web/HTTP/Cookies#Secure_and_HttpOnly_cookies">Cookie security</a></li>
                <li><a href="/ja/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a></li>
                <li><a href="/ja/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a></li>
                <li><a href="/ja/docs/Web/HTTP/Headers/X-XSS-Protection">X-XSS-Protection</a></li>
                <li><a href="https://wiki.mozilla.org/Security/Guidelines/Web_Security">Mozilla web security guidelines</a></li>
                <li><a href="https://observatory.mozilla.org/">Mozilla Observatory</a></li>
            </ol>
        </details>
    </li>

    <li><a href="/ja/docs/Web/HTTP/CORS">HTTP access control (CORS)</a></li>
    <li><a href="/ja/docs/Web/HTTP/Authentication">HTTP authentication</a></li>
    <li><a href="/ja/docs/Web/HTTP/Caching">HTTP caching</a></li>
    <li><a href="/ja/docs/Web/HTTP/Compression">HTTP compression</a></li>
    <li><a href="/ja/docs/Web/HTTP/Conditional_requests">HTTP conditional requests</a></li>
    <li><a href="/ja/docs/Web/HTTP/Content_negotiation">HTTP content negotiation</a></li>
    <li><a href="/ja/docs/Web/HTTP/Cookies">HTTP cookies</a></li>
    <li><a href="/ja/docs/Web/HTTP/Range_requests">HTTP range requests</a></li>
    <li><a href="/ja/docs/Web/HTTP/Redirections">HTTP redirects</a></li>
    <li><a href="/ja/docs/Web/HTTP/Resources_and_specifications">HTTP specifications</a></li>
    <li><a href="/ja/docs/Web/HTTP/Feature_Policy">Feature policy</a></li>
    <li><strong>References:</strong></li>
    <li class="toggle">
        <details>
            <summary>HTTP headers</summary>
            <ol><li><a href="/ja/docs/Web/HTTP/Headers/Accept"><code>Accept</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Accept-Charset"><code>Accept-Charset</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Accept-Encoding"><code>Accept-Encoding</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Accept-Language"><code>Accept-Language</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Accept-Ranges"><code>Accept-Ranges</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Allow-Headers"><code>Access-Control-Allow-Headers</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Allow-Methods"><code>Access-Control-Allow-Methods</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Expose-Headers"><code>Access-Control-Expose-Headers</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Max-Age"><code>Access-Control-Max-Age</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Request-Headers"><code>Access-Control-Request-Headers</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Access-Control-Request-Method"><code>Access-Control-Request-Method</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Age"><code>Age</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Allow"><code>Allow</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Alt-Svc"><code>Alt-Svc</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Alt-Svc$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Authorization"><code>Authorization</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Cache-Control"><code>Cache-Control</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Clear-Site-Data"><code>Clear-Site-Data</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Connection"><code>Connection</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Disposition"><code>Content-Disposition</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Encoding"><code>Content-Encoding</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Language"><code>Content-Language</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Length"><code>Content-Length</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Location"><code>Content-Location</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Range"><code>Content-Range</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only"><code>Content-Security-Policy-Report-Only</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Cookie"><code>Cookie</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="これは廃止されたAPIであり、今後の動作は保障されていません。ご注意下さい。"><i class="icon-trash"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Cookie2"><code>Cookie2</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/DNT"><code>DNT</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Date"><code>Date</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/ETag"><code>ETag</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Early-Data"><code>Early-Data</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Expect"><code>Expect</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Expect-CT"><code>Expect-CT</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Expires"><code>Expires</code></a></li><li><span class="sidebar-icon"><span title="これは実験段階の API です。製品内のコードで使用しないようご注意ください。"><i class="icon-beaker"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy"><code>Feature-Policy</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Forwarded"><code>Forwarded</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/From"><code>From</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Host"><code>Host</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/If-Match"><code>If-Match</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/If-Modified-Since"><code>If-Modified-Since</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/If-None-Match"><code>If-None-Match</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/If-Range"><code>If-Range</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/If-Unmodified-Since"><code>If-Unmodified-Since</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Index"><code>索引</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Keep-Alive"><code>Keep-Alive</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="この API は標準化されていません。"><i class="icon-warning-sign"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Large-Allocation"><code>Large-Allocation</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Large-Allocation$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Last-Modified"><code>Last-Modified</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Location"><code>Location</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Origin"><code>Origin</code></a></li><li><span class="sidebar-icon"><span title="これは非推奨 API です。未だ動作しているかも知れませんが、将来的に削除される可能性があります。"><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Pragma"><code>Pragma</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Proxy-Authenticate"><code>Proxy-Authenticate</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Proxy-Authorization"><code>Proxy-Authorization</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Proxy-Authorization$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Public-Key-Pins"><code>Public-Key-Pins</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Public-Key-Pins$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Public-Key-Pins-Report-Only"><code>Public-Key-Pins-Report-Only</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Public-Key-Pins-Report-Only$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Range"><code>Range</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Referer"><code>Referer</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Referrer-Policy"><code>Referrer-Policy</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Retry-After"><code>Retry-After</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Sec-WebSocket-Accept"><code>Sec-WebSocket-Accept</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Sec-WebSocket-Accept$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Server"><code>Server</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Server-Timing"><code>Server-Timing</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Set-Cookie"><code>Set-Cookie</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="これは廃止されたAPIであり、今後の動作は保障されていません。ご注意下さい。"><i class="icon-trash"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Set-Cookie2"><code>Set-Cookie2</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/SourceMap"><code>SourceMap</code></a></li><li><a href="/ja/docs/Web/Security/HTTP_Strict_Transport_Security"><code>HTTP Strict Transport Security</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/TE"><code>TE</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/TE$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Timing-Allow-Origin"><code>Timing-Allow-Origin</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Timing-Allow-Origin$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Tk"><code>Tk</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Trailer"><code>Trailer</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Trailer$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Transfer-Encoding"><code>Transfer-Encoding</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Upgrade-Insecure-Requests"><code>Upgrade-Insecure-Requests</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Upgrade-Insecure-Requests$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/User-Agent"><code>User-Agent</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Vary"><code>Vary</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Via"><code>Via</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Via$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/WWW-Authenticate"><code>WWW-Authenticate</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Warning"><code>Warning</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Warning$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/X-Content-Type-Options"><code>X-Content-Type-Options</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/X-Content-Type-Options$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control"><code>X-DNS-Prefetch-Control</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="この API は標準化されていません。"><i class="icon-warning-sign"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/X-Forwarded-For"><code>X-Forwarded-For</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="この API は標準化されていません。"><i class="icon-warning-sign"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/X-Forwarded-Host"><code>X-Forwarded-Host</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="この API は標準化されていません。"><i class="icon-warning-sign"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/X-Forwarded-Proto"><code>X-Forwarded-Proto</code></a></li><li><a href="/ja/docs/Web/HTTP/X-Frame-Options"><code>X-Frame-Options</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/X-XSS-Protection"><code>X-XSS-Protection</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>HTTP request methods</summary>
            <ol><li><a href="/ja/docs/Web/HTTP/Methods/CONNECT"><code>CONNECT</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Methods/CONNECT$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Methods/DELETE"><code>DELETE</code></a></li><li><a href="/ja/docs/Web/HTTP/Methods/GET"><code>GET</code></a></li><li><a href="/ja/docs/Web/HTTP/Methods/HEAD"><code>HEAD</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Methods/HEAD$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Methods/OPTIONS"><code>OPTIONS</code></a></li><li><a href="/ja/docs/Web/HTTP/Methods/PATCH"><code>PATCH</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Methods/PATCH$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Methods/POST"><code>POST</code></a></li><li><a href="/ja/docs/Web/HTTP/Methods/PUT"><code>PUT</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Methods/PUT$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Methods/TRACE"><code>TRACE</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>HTTP response status codes</summary>
          <ol><li><a href="/ja/docs/Web/HTTP/Status/100"><code>100 Continue</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/101"><code>101 Switching Protocols</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/200"><code>200 OK</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/201"><code>201 Created</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/202"><code>202 Accepted</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/203"><code>203 Non-Authoritative Information</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/204"><code>204 No Content</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/205"><code>205 Reset Content</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/206"><code>206 Partial Content</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/300"><code>300 Multiple Choices</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/301"><code>301 Moved Permanently</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/302"><code>302 Found</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/303"><code>303 See Other</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/304"><code>304 Not Modified</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/307"><code>307 Temporary Redirect</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/308"><code>308 Permanent Redirect</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/400"><code>400 Bad Request</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/401"><code>401 Unauthorized</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/403"><code>403 Forbidden</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/404"><code>404 Not Found</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/405"><code>405 Method Not Allowed</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/406"><code>406 Not Acceptable</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/407"><code>407 Proxy Authentication Required</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/408"><code>408 Request Timeout</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/409"><code>409 Conflict</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/410"><code>410 Gone</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/411"><code>411 Length Required</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/412"><code>412 Precondition Failed</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/413"><code>413 Payload Too Large</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/414"><code>414 URI Too Long</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/415"><code>415 Unsupported Media Type</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/416"><code>416 Range Not Satisfiable</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/417"><code>417 Expectation Failed</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/418"><code>418 I&apos;m a teapot</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/422"><code>422 Unprocessable Entity</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/425"><code>425 Too Early</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/426"><code>426 Upgrade Required</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/428"><code>428 Precondition Required</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/429"><code>429 Too Many Requests</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/431"><code>431 Request Header Fields Too Large</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/451"><code>451 Unavailable For Legal Reasons</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/500"><code>500 Internal Server Error</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/501"><code>501 Not Implemented</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/502"><code>502 Bad Gateway</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/503"><code>503 Service Unavailable</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/504"><code>504 Gateway Timeout</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/505"><code>505 HTTP Version Not Supported</code></a></li><li><a href="/ja/docs/Web/HTTP/Status/511"><code>511 Network Authentication Required</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>CSP directives</summary>
          <ol><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/base-uri"><code>CSP: base-uri</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/block-all-mixed-content"><code>CSP: block-all-mixed-content</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/child-src"><code>CSP: child-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/child-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src"><code>CSP: connect-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/connect-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/default-src"><code>CSP: default-src</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/font-src"><code>CSP: font-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/font-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/form-action"><code>CSP: form-action</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/form-action$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors"><code>CSP: frame-ancestors</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src"><code>CSP: frame-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/frame-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/img-src"><code>CSP: img-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/img-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src"><code>CSP: manifest-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/manifest-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/media-src"><code>CSP: media-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/media-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/object-src"><code>CSP: object-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/object-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types"><code>CSP: plugin-types</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/plugin-types$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/referrer"><code>CSP: referrer</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri"><code>CSP: report-uri</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/require-sri-for"><code>CSP: require-sri-for</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/require-sri-for$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox"><code>CSP: sandbox</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/script-src"><code>CSP: script-src</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/style-src"><code>CSP: style-src</code></a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/style-src$translate">[翻訳する]</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/upgrade-insecure-requests"><code>CSP: upgrade-insecure-requests</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/worker-src"><code>CSP: worker-src</code></a></li><li><a href="/ja/docs/Web/HTTP/Headers/Content-Security-Policy/report-to"><code>report-to</code></a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>CORS errors</summary>
          <ol><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSDisabled">Reason: CORS disabled</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSAllowOriginNotMatchingOrigin">Reason: CORS header &apos;Access-Control-Allow-Origin&apos; does not match &apos;xyz&apos;</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSMissingAllowOrigin">Reason: CORS header &apos;Access-Control-Allow-Origin&apos; missing</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSOriginHeaderNotAdded">Reason: CORS header ‘Origin’ cannot be added</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSPreflightDidNotSucceed">Reason: CORS preflight channel did not succeed</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSDidNotSucceed">Reason: CORS request did not succeed</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSExternalRedirectNotAllowed">Reason: CORS request external redirect not allowed</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp">Reason: CORS request not HTTP</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSNotSupportingCredentials">Reason: Credential is not supported if the CORS header ‘Access-Control-Allow-Origin’ is ‘*’</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSMethodNotFound">Reason: Did not find method in CORS header ‘Access-Control-Allow-Methods’</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSMultipleAllowOriginNotAllowed">Reason: Multiple CORS header &apos;Access-Control-Allow-Origin&apos; not allowed</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSMIssingAllowCredentials">Reason: expected ‘true’ in CORS header ‘Access-Control-Allow-Credentials’</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowHeader">Reason: invalid token ‘xyz’ in CORS header ‘Access-Control-Allow-Headers’</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSInvalidAllowMethod">Reason: invalid token ‘xyz’ in CORS header ‘Access-Control-Allow-Methods’</a></li><li><a href="/ja/docs/Web/HTTP/CORS/Errors/CORSMissingAllowHeaderFromPreflight">Reason: missing token ‘xyz’ in CORS header ‘Access-Control-Allow-Headers’ from CORS preflight channel</a></li></ol>
        </details>
    </li>
    <li class="toggle">
        <details>
          <summary>Feature-Policy directives</summary>
          <ol><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/autoplay">Feature-Policy: autoplay</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/camera">Feature-Policy: camera</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/encrypted-media">Feature-Policy: encrypted-media</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/fullscreen">Feature-Policy:fullscreen</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/geolocation">Feature-Policy:geolocation</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/microphone">Feature-Policy:microphone</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/midi">Feature-Policy: midi</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/payment">Feature-Policy: payment</a></li><li><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/vr">Feature-Policy: vr</a></li><li><span class="sidebar-icon"><span title="これは実験段階の API です。製品内のコードで使用しないようご注意ください。"><i class="icon-beaker"> </i></span></span><a href="/ja/docs/Web/HTTP/Headers/Feature-Policy/document-domain">document-domain</a> <a style="opacity: 0.5;" href="/ja/docs/Web/HTTP/Headers/Feature-Policy/document-domain$translate">[翻訳する]</a></li></ol>
        </details>
    </li>
  </ol>
</section><p></p>

<p class="summary">HTTP には<em>条件付きリクエスト</em>の概念があり、対象となるリソースと<em>検証子</em>の値とを比較することで、リクエストの結果や、成功か失敗かまでもが変化することがあります。このようなリクエストは、キャッシュの内容を検証して、無用な制御を避けたり、ダウンロードの再開の時などに文書の整合性を検証したり、サーバー上の文書をアップロードまたは変更するときに更新内容を失うことを避ける場合などに役立つことがあります。</p>

<h2 id="Principles" name="Principles">原理</h2>

<p>HTTP 条件付きリクエストは、特定のヘッダーの値に応じて異なる処理が行われるリクエストです。これらのヘッダーは前提条件を定義しており、リクエストの結果は前提条件に一致するか否かに応じて変わります。</p>

<p>リクエストで使用したメソッドや前提条件で使用したヘッダー一式によって、さまざまな動作が定義されています。</p>

<ul>
 <li><a href="/ja/docs/Web/HTTP/Methods/GET" title="HTTP の GET メソッドは、特定のリソースの表現をリクエストします。 GET を使用したリクエストはデータを受け取るだけです。"><code>GET</code></a> などの<a href="/ja/docs/Glossary/safe" class="glossaryLink" title="安全な: HTTPメソッドが安全とは、そのHTTPメソッドがサーバーの状態を変更しないということです。言い換えれば、読み取り専用操作につながる場合、メソッドは安全です。一般的なHTTPメソッドのうちでは  GET、HEAD、OPTIONS が安全です。安全なHTTPメソッドはすべて冪等 (idempotent) でもあります。一方で、安全でないメソッドでも PUT や DELETE などは冪等ですが、すべてではありません。">安全な</a>メソッドは、一般に文書を取得するメソッドであり、条件付きリクエストは関連する文書のみを返信するために利用することができます。これによって、帯域を節約します。</li>
 <li><a href="/ja/docs/Web/HTTP/Methods/PUT" title="この項目についての文書はまだ書かれていません。書いてみませんか？"><code>PUT</code></a> などの<a href="/ja/docs/Glossary/safe" class="glossaryLink" title="安全ではない: HTTPメソッドが安全とは、そのHTTPメソッドがサーバーの状態を変更しないということです。言い換えれば、読み取り専用操作につながる場合、メソッドは安全です。一般的なHTTPメソッドのうちでは  GET、HEAD、OPTIONS が安全です。安全なHTTPメソッドはすべて冪等 (idempotent) でもあります。一方で、安全でないメソッドでも PUT や DELETE などは冪等ですが、すべてではありません。">安全ではない</a>メソッドは、一般に文書をアップロードするメソッドであり、条件付きリクエストは文書がサーバーに格納されているものと同じものに基づいたものである場合に限ってアップロードするようにするために利用することができます。</li>
</ul>

<h2 id="Validators" name="Validators">検証子</h2>

<p>すべての条件ヘッダーは、サーバーに保存されているリソースが特定のバージョンに一致するか確認を試みます。このため、条件付きリクエストではリソースのバージョンを示す必要があります。リソース全体をバイト単位で比較することは不可能であり、常に望まれていることとは限らないので、リクエストはバージョンを記述する値を送信します。このような値は<em>検証子</em>と呼ばれ、二種類があります。</p>

<ul>
 <li>文書が最後に変更された日時である <em>last-modified</em> の日時</li>
 <li><em>エンティティタグ</em>または <em>etag</em> と呼ばれる、各バージョンを一意に識別する不透明な文字列。</li>
</ul>

<p>同じリソースのバージョンの比較は少々複雑です。状況によって、二種類の<em>確認方法</em>があります。</p>

<ul>
 <li><ruby>強い検証<rp> (</rp><rt>Strong validation</rt><rp>) </rp></ruby>は、ダウンロードを再開するときなど、バイト単位の同一性が求められる場合に使用します。</li>
 <li><ruby>弱い検証<rp> (</rp><rt>Weak validation</rt><rp>) </rp></ruby>は、ユーザーエージェントが二つのリソースが同じであることを確認することだけが必要である場合に使用します。これは広告の違いやフッターの日付の違いなど、小さな違いがある場合も含みます。</li>
</ul>

<p>検証の種類と使用される検証子は独立しています。 <a href="/ja/docs/Web/HTTP/Headers/Last-Modified" title="HTTP の Last-Modified レスポンスヘッダーは、リソースが最後に変更されたとオリジンのサーバーが判断している日時を含みます。これは受信または保存されたリソースが、同じものであるかを判断する検証材料として使用されます。 ETag ヘッダーよりも精度は低く、その代替手段になります。 If-Modified-Since や If-Unmodified-Since ヘッダーを含む条件付きリクエストはこのフィールドを使用します。"><code>Last-Modified</code></a> と <a href="/ja/docs/Web/HTTP/Headers/ETag" title="ETag HTTP レスポンスヘッダーは、特定のバージョンのリソースの識別子です。Web サーバーはコンテンツが変更されていない場合に完全なレスポンスを送信する必要がないため、キャッシュの効率を高め、帯域幅を節約できます。 一方、コンテンツが変更された場合、etags はリソースの同時更新がお互いを上書きする(&quot;空中衝突&quot;)のを防ぐのに役立ちます。

 指定された URL のリソースが変更された場合は、新しい Etag 値を生成する必要があります。したがって Etags はフィンガープリントに似ており、一部のサーバーでの追跡目的でも使用される可能性があります。これらを比較することで、リソースの2つの表現が同じかどうかを素早く判断できますが、トラッキングサーバーによって無限に保持されるように設定することもできます。"><code>ETag</code></a> はどちらの種類の検証もできますが、サーバー側の実装の複雑さは異なります。 HTTP は既定で強い検証を使用し、弱い検証を使用するときはそれを指定します。</p>

<h3 id="Strong_validation" name="Strong_validation">強い検証</h3>

<p id="sect1">強い検証は、比較対象のリソースがバイト単位で同一であることを保証します。これは一部の条件ヘッダーで必須、また他のヘッダーでは既定の要件です。強い検証はとても厳密であり、サーバーレベルで保証することが困難である場合もありますが、時には性能を犠牲にしても、データが失われていないことを常に保証します。</p>

<p><a href="/ja/docs/Web/HTTP/Headers/Last-Modified" title="HTTP の Last-Modified レスポンスヘッダーは、リソースが最後に変更されたとオリジンのサーバーが判断している日時を含みます。これは受信または保存されたリソースが、同じものであるかを判断する検証材料として使用されます。 ETag ヘッダーよりも精度は低く、その代替手段になります。 If-Modified-Since や If-Unmodified-Since ヘッダーを含む条件付きリクエストはこのフィールドを使用します。"><code>Last-Modified</code></a> で強い検証のための一意な識別子を持つことは、とても困難です。多くの場合、リソースの MD5 ハッシュ (あるいはその派生物) を持つ <a href="/ja/docs/Web/HTTP/Headers/ETag" title="ETag HTTP レスポンスヘッダーは、特定のバージョンのリソースの識別子です。Web サーバーはコンテンツが変更されていない場合に完全なレスポンスを送信する必要がないため、キャッシュの効率を高め、帯域幅を節約できます。 一方、コンテンツが変更された場合、etags はリソースの同時更新がお互いを上書きする(&quot;空中衝突&quot;)のを防ぐのに役立ちます。

 指定された URL のリソースが変更された場合は、新しい Etag 値を生成する必要があります。したがって Etags はフィンガープリントに似ており、一部のサーバーでの追跡目的でも使用される可能性があります。これらを比較することで、リソースの2つの表現が同じかどうかを素早く判断できますが、トラッキングサーバーによって無限に保持されるように設定することもできます。"><code>ETag</code></a> を使用します。</p>

<h3 id="Weak_validation" name="Weak_validation">弱い検証</h3>

<p>弱い検証は、内容が等価であるなら二つのバージョンの文書が等しいと見なされるという点で、強い検証と異なります。例えばフッターの日付だけ、あるいは広告だけが異なる二つのページは、弱い検証では<em>同一</em>であるとみなされますが、強い検証では異なるものとみなされます。弱い検証を作り出す etag のシステムを構築することは、ページのさまざまな要素の重要性を知ることが伴うため複雑になるかもしれませんが、キャッシュの性能を最適化するためにとても役に立ちます。</p>

<h2 id="Conditional_headers" name="Conditional_headers">条件ヘッダー</h2>

<p>条件ヘッダーと呼ばれるいくつかの HTTP ヘッダーが、条件付きリクエストをもたらします。</p>

<dl>
 <dt><a href="/ja/docs/Web/HTTP/Headers/If-Match" title="HTTP の If-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、リストされた ETag のいずれかと一致する場合にのみ、サーバーは要求されたリソースを返します。PUT と他の安全ではないメソッドでは、この場合のみリソースをアップロードします。"><code>If-Match</code></a></dt>
 <dd>遠方のリソースの <a href="/ja/docs/Web/HTTP/Headers/ETag" title="ETag HTTP レスポンスヘッダーは、特定のバージョンのリソースの識別子です。Web サーバーはコンテンツが変更されていない場合に完全なレスポンスを送信する必要がないため、キャッシュの効率を高め、帯域幅を節約できます。 一方、コンテンツが変更された場合、etags はリソースの同時更新がお互いを上書きする(&quot;空中衝突&quot;)のを防ぐのに役立ちます。

 指定された URL のリソースが変更された場合は、新しい Etag 値を生成する必要があります。したがって Etags はフィンガープリントに似ており、一部のサーバーでの追跡目的でも使用される可能性があります。これらを比較することで、リソースの2つの表現が同じかどうかを素早く判断できますが、トラッキングサーバーによって無限に保持されるように設定することもできます。"><code>ETag</code></a> と、このヘッダーに載せた etag が等しければ成功します。デフォルトでは etag に接頭辞 <code>&apos;W/&apos;</code> がついていない限り、強い検証を行います。</dd>
 <dt><a href="/ja/docs/Web/HTTP/Headers/If-None-Match" title="HTTP の If-None-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、指定されたものの中に要求されたリソースの ETag に一致するものがない場合のみ、サーバーはリソースを 200 ステータスで返します。その他のメソッドの場合、最終的に存在するリソースの ETag が列挙されたいずれの値とも一致しない場合にのみ処理します。"><code>If-None-Match</code></a></dt>
 <dd>遠方のリソースの <a href="/ja/docs/Web/HTTP/Headers/ETag" title="ETag HTTP レスポンスヘッダーは、特定のバージョンのリソースの識別子です。Web サーバーはコンテンツが変更されていない場合に完全なレスポンスを送信する必要がないため、キャッシュの効率を高め、帯域幅を節約できます。 一方、コンテンツが変更された場合、etags はリソースの同時更新がお互いを上書きする(&quot;空中衝突&quot;)のを防ぐのに役立ちます。

 指定された URL のリソースが変更された場合は、新しい Etag 値を生成する必要があります。したがって Etags はフィンガープリントに似ており、一部のサーバーでの追跡目的でも使用される可能性があります。これらを比較することで、リソースの2つの表現が同じかどうかを素早く判断できますが、トラッキングサーバーによって無限に保持されるように設定することもできます。"><code>ETag</code></a> と、このヘッダーに載せたそれぞれの etag が異なっていれば成功します。デフォルトでは etag に接頭辞 <code>&apos;W/&apos;</code> がついていない限り、強い検証を行います。</dd>
 <dt><a href="/ja/docs/Web/HTTP/Headers/If-Modified-Since" title="HTTP の If-Modified-Since リクエストヘッダーは、リクエストを条件付にします。サーバーは最後にリソースが変更された時刻が、リクエストにより与えられた時刻より後の場合にのみ、リクエストされたリソースを 200 ステータスと共に返却します。もしリクエストにより与えられた時刻以降にリソースが変更されていなければ、レスポンスは本文を持たない 304 になります。前回のリクエストの Last-Modified レスポンスヘッダーは、最後にリソースが変更された時刻を含みます。 If-Unmodified-Since とは異なり、 If-Modified-Since は GET もしくは HEAD でのみ使用できます。"><code>If-Modified-Since</code></a></dt>
 <dd>遠方のリソースの <a href="/ja/docs/Web/HTTP/Headers/Last-Modified" title="HTTP の Last-Modified レスポンスヘッダーは、リソースが最後に変更されたとオリジンのサーバーが判断している日時を含みます。これは受信または保存されたリソースが、同じものであるかを判断する検証材料として使用されます。 ETag ヘッダーよりも精度は低く、その代替手段になります。 If-Modified-Since や If-Unmodified-Since ヘッダーを含む条件付きリクエストはこのフィールドを使用します。"><code>Last-Modified</code></a> の日時が、このヘッダーで指定した日時より新しければ成功します。</dd>
 <dt><a href="/ja/docs/Web/HTTP/Headers/If-Unmodified-Since" title="HTTP の If-Unmodified-Since リクエストヘッダーは、リクエストを条件付きにします。サーバーはリソースが指定された日時以降に変更されていない場合のみ、要求されたリソースを返信したり、 POST などの安全ではないメソッドをの場合はそれを受け付けたりします。リソースが指定された日時以降に変更されていた場合は、レスポンスは412 (Precondition Failed) エラーになります。"><code>If-Unmodified-Since</code></a></dt>
 <dd>遠方のリソースの <a href="/ja/docs/Web/HTTP/Headers/Last-Modified" title="HTTP の Last-Modified レスポンスヘッダーは、リソースが最後に変更されたとオリジンのサーバーが判断している日時を含みます。これは受信または保存されたリソースが、同じものであるかを判断する検証材料として使用されます。 ETag ヘッダーよりも精度は低く、その代替手段になります。 If-Modified-Since や If-Unmodified-Since ヘッダーを含む条件付きリクエストはこのフィールドを使用します。"><code>Last-Modified</code></a> の日時が、このヘッダーで指定した日時より過去または同一であれば成功します。</dd>
 <dt><a href="/ja/docs/Web/HTTP/Headers/If-Range" title="If-Range HTTP リクエストヘッダはレンジリクエストを条件付きにします：条件が満たされれば、レンジリクエストが発行され、サーバは適切なボディを持つ 206 Partial Content 回答を返します。条件が満たされていない場合、 200 の状態でリソース全体が返送されます。"><code>If-Range</code></a></dt>
 <dd><a href="/ja/docs/Web/HTTP/Headers/If-Match" title="HTTP の If-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、リストされた ETag のいずれかと一致する場合にのみ、サーバーは要求されたリソースを返します。PUT と他の安全ではないメソッドでは、この場合のみリソースをアップロードします。"><code>If-Match</code></a> や <a href="/ja/docs/Web/HTTP/Headers/If-Unmodified-Since" title="HTTP の If-Unmodified-Since リクエストヘッダーは、リクエストを条件付きにします。サーバーはリソースが指定された日時以降に変更されていない場合のみ、要求されたリソースを返信したり、 POST などの安全ではないメソッドをの場合はそれを受け付けたりします。リソースが指定された日時以降に変更されていた場合は、レスポンスは412 (Precondition Failed) エラーになります。"><code>If-Unmodified-Since</code></a> に似ていますが、 etag または日時をひとつしか持つことができません。条件が失敗すると範囲指定リクエストも失敗して、 <a href="/ja/docs/Web/HTTP/Status/206" title="HTTP の成功ステータスレスポンスコード 206 Partial Content は、そのリクエストが成功したこと、そしてリクエストヘッダの Range に記述された、要求されている範囲のデータが body に含まれていることを示します。"><code>206</code></a> <code>Partial Content</code> レスポンスの代わりに <a href="/ja/docs/Web/HTTP/Status/200" title="HTTP 200 OK はリクエストが成功した場合に返すレスポンスコード。200のレスポンスはデフォルトでキャッシュしてよい。"><code>200</code></a> <code>OK</code> でリソース全体を送信します。</dd>
</dl>

<h2 id="Use_cases" name="Use_cases">使用例</h2>

<h3 id="Cache_update" name="Cache_update">キャッシュの更新</h3>

<p>条件付きリクエストのもっとも一般的な使用例は、キャッシュの更新です。キャッシュが空である、あるいはキャッシュを使用しない状態では <a href="/ja/docs/Web/HTTP/Status/200" title="HTTP 200 OK はリクエストが成功した場合に返すレスポンスコード。200のレスポンスはデフォルトでキャッシュしてよい。"><code>200</code></a> <code>OK</code> ステータスと共に、要求したリソースが送信されます。</p>

<p><img src="https://mdn.mozillademos.org/files/13729/Cache1.png" alt="The request issued when the cache is empty triggers the resource to be downloaded, with both validator value sent as headers. The cache is then filled." style="height: 265px; width: 741px;"></p>

<p>リソースと共に、ヘッダーで検証子を送信します。この例では <a href="/ja/docs/Web/HTTP/Headers/Last-Modified" title="HTTP の Last-Modified レスポンスヘッダーは、リソースが最後に変更されたとオリジンのサーバーが判断している日時を含みます。これは受信または保存されたリソースが、同じものであるかを判断する検証材料として使用されます。 ETag ヘッダーよりも精度は低く、その代替手段になります。 If-Modified-Since や If-Unmodified-Since ヘッダーを含む条件付きリクエストはこのフィールドを使用します。"><code>Last-Modified</code></a> と <a href="/ja/docs/Web/HTTP/Headers/ETag" title="ETag HTTP レスポンスヘッダーは、特定のバージョンのリソースの識別子です。Web サーバーはコンテンツが変更されていない場合に完全なレスポンスを送信する必要がないため、キャッシュの効率を高め、帯域幅を節約できます。 一方、コンテンツが変更された場合、etags はリソースの同時更新がお互いを上書きする(&quot;空中衝突&quot;)のを防ぐのに役立ちます。

 指定された URL のリソースが変更された場合は、新しい Etag 値を生成する必要があります。したがって Etags はフィンガープリントに似ており、一部のサーバーでの追跡目的でも使用される可能性があります。これらを比較することで、リソースの2つの表現が同じかどうかを素早く判断できますが、トラッキングサーバーによって無限に保持されるように設定することもできます。"><code>ETag</code></a> の両方を送信していますが、どちらか一方しか使用しません。これらの検証子はリソースと共に (すべてのヘッダーのように) キャッシュへ保存され、キャッシュが陳腐化したときに条件付きリクエストを作成するために使用します。</p>

<p>キャッシュが陳腐化していなければ、条件付きリクエストは行いません。しかしキャッシュが陳腐化すると主に <a href="/ja/docs/Web/HTTP/Headers/Cache-Control" title="Cache-Control 一般ヘッダーフィールドは、リクエストとレスポンスの両方のキャッシュ規則を指定するために用います。キャッシュの指定は単一方向で、つまり、リクエストの定義がレスポンスの定義と同じにはなりません。"><code>Cache-Control</code></a> ヘッダーに制御されて、クライアントはキャッシュされた値を直接使用せず、<a href="/ja/docs/Web/HTTP/Headers/If-Modified-Since" title="HTTP の If-Modified-Since リクエストヘッダーは、リクエストを条件付にします。サーバーは最後にリソースが変更された時刻が、リクエストにより与えられた時刻より後の場合にのみ、リクエストされたリソースを 200 ステータスと共に返却します。もしリクエストにより与えられた時刻以降にリソースが変更されていなければ、レスポンスは本文を持たない 304 になります。前回のリクエストの Last-Modified レスポンスヘッダーは、最後にリソースが変更された時刻を含みます。 If-Unmodified-Since とは異なり、 If-Modified-Since は GET もしくは HEAD でのみ使用できます。"><code>If-Modified-Since</code></a> または <a href="/ja/docs/Web/HTTP/Headers/If-Match" title="HTTP の If-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、リストされた ETag のいずれかと一致する場合にのみ、サーバーは要求されたリソースを返します。PUT と他の安全ではないメソッドでは、この場合のみリソースをアップロードします。"><code>If-Match</code></a> ヘッダーに検証子の値を指定した<em>条件付きリクエスト</em>を発行します。</p>

<p>リソースが変更されていなければ、サーバーは <a href="/ja/docs/Web/HTTP/Status/304" title="HTTP 304 Not Modified クライアントリダイレクトレスポンスコードは、リクエストされたリソースを再送する必要がないことを示します。これはキャッシュされたリソースへの暗黙のリダイレクトです。これは、GET や HEAD リクエストのようなリクエストメソッドが safe である場合、またはリクエストが条件付きで If-None-Match もしくは If-Modified-Since ヘッダーを使用しているときに発生します。"><code>304</code></a> <code>Not Modified</code> レスポンスを返します。これはキャッシュを再び新鮮な状態にして、クライアントはキャッシュされたリソースを使用します。これはリソースをいくらか消費するレスポンスとリクエストのやり取りが発生しますが、通信網でリソース全体を再度転送するよりも効率的です。</p>

<p><img src="https://mdn.mozillademos.org/files/13731/HTTPCache2.png" alt="With a stale cache, the conditional request is sent. The server can determine if the resource changed, and, as in this case, decide not to send it again as it is the same." style="height: 265px; width: 741px;"></p>

<p>リソースが変更された場合は、サーバーは条件付きではないリクエストと同様に <a href="/ja/docs/Web/HTTP/Status/200" title="HTTP 200 OK はリクエストが成功した場合に返すレスポンスコード。200のレスポンスはデフォルトでキャッシュしてよい。"><code>200</code></a><code> OK</code> レスポンスで新しいバージョンのリソースを送信します。そして、クライアントは新しいリソースを使用します (また、それをキャッシュします)。</p>

<p><img src="https://mdn.mozillademos.org/files/13733/HTTPCache3.png" alt="In the case where the resource was changed, it is sent back as if the request wasn&apos;t conditional."></p>

<p>サーバー側で検証子を設定することをを除いて、この仕組みは透過的です。どのブラウザーもウェブ開発者が特別な作業を行うことなく、キャッシュを管理してこのような条件付きリクエストを送信します。</p>

<h3 id="Integrity_of_a_partial_download" name="Integrity_of_a_partial_download">部分ダウンロードの整合性</h3>

<p>ファイルの部分ダウンロードは、以前の操作を再開することが可能な HTTP の機能であり、すでに取得済みの情報を保持することによって帯域や時間を節約します。</p>

<p><img src="https://mdn.mozillademos.org/files/16190/HTTPResume1.png" alt="A download has been stopped and only partial content has been retrieved." style="height: 397px; width: 764px;"></p>

<p>部分ダウンロードをサポートするサーバーは、<a href="/ja/docs/Web/HTTP/Headers/Accept-Ranges" title="HTTP の Accept-Ranges レスポンスヘッダーは、サーバーが部分的なリクエストに対応していることを周知するために使用するマーカーです。このフィールドの値は、範囲の定義に使用できる単位を示します。"><code>Accept-Ranges</code></a> ヘッダーを送信してそのことを知らせます。このヘッダーが送信されると、クライアントは <a href="/ja/docs/Web/HTTP/Headers/Ranges" title="この項目についての文書はまだ書かれていません。書いてみませんか？"><code>Ranges</code></a> ヘッダーで欠落している範囲を送信することで、ダウンロードを再開できます。</p>

<p><img src="https://mdn.mozillademos.org/files/13737/HTTPResume2.png" alt="The client resumes the requests by indicating the range he needs and preconditions checking the validators of the partially obtained request."></p>

<p>この原理はシンプルですが、潜在的な問題がひとつあります。2 回のダウンロードの間にリソースが変更されると、取得した範囲が 2 つの異なるバージョンのリソースに対応してしまい、最終的な文書が壊れてしまうでしょう。</p>

<p>これを防ぐため、条件付きリクエストを使用します。範囲についてこれを行うための方法が 2 つあります。より柔軟な方法は <a href="/ja/docs/Web/HTTP/Headers/If-Modified-Since" title="HTTP の If-Modified-Since リクエストヘッダーは、リクエストを条件付にします。サーバーは最後にリソースが変更された時刻が、リクエストにより与えられた時刻より後の場合にのみ、リクエストされたリソースを 200 ステータスと共に返却します。もしリクエストにより与えられた時刻以降にリソースが変更されていなければ、レスポンスは本文を持たない 304 になります。前回のリクエストの Last-Modified レスポンスヘッダーは、最後にリソースが変更された時刻を含みます。 If-Unmodified-Since とは異なり、 If-Modified-Since は GET もしくは HEAD でのみ使用できます。"><code>If-Modified-Since</code></a> と <a href="/ja/docs/Web/HTTP/Headers/If-Match" title="HTTP の If-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、リストされた ETag のいずれかと一致する場合にのみ、サーバーは要求されたリソースを返します。PUT と他の安全ではないメソッドでは、この場合のみリソースをアップロードします。"><code>If-Match</code></a> を使用することであり、前提条件に合わない場合はサーバーがエラーを返します。すると、クライアントはダウンロードを始めから再実行します。</p>

<p><img src="https://mdn.mozillademos.org/files/13739/HTTPResume3.png" alt="When the partially downloaded resource has been modified, the preconditions will fail and the resource will have to be downloaded again completely."></p>

<p>この方法でも動作しますが、文書が変更されると余分なレスポンスやリクエストの交換が発生します。これはパフォーマンスを低下させますので HTTP には、この問題を避けるために特化した追加ヘッダーである <a href="/ja/docs/Web/HTTP/Headers/If-Range" title="If-Range HTTP リクエストヘッダはレンジリクエストを条件付きにします：条件が満たされれば、レンジリクエストが発行され、サーバは適切なボディを持つ 206 Partial Content 回答を返します。条件が満たされていない場合、 200 の状態でリソース全体が返送されます。"><code>If-Range</code></a> があります。</p>

<p><img src="https://mdn.mozillademos.org/files/13741/HTTPResume4.png" alt="The If-Range headers allows the server to directly send back the complete resource if it has been modified, no need to send a 412 error and wait for the client to re-initiate the download." style="height: 263px; width: 770px;"></p>

<p>この解決策はより効率的ですが、柔軟性が若干劣ります (条件で etag をひとつしか使用できません)。ただし、これ以上の柔軟性はほとんど必要ありません。</p>

<h3 id="Avoiding_the_lost_update_problem_with_optimistic_locking" name="Avoiding_the_lost_update_problem_with_optimistic_locking">楽観的ロックでロストアップデートを避ける</h3>

<p>リモートの文書の<em>更新</em>は、ウェブアプリケーションで一般的な操作です。これはファイルシステムやソース管理アプリケーションではごく一般的ですが、リモートにリソースを保存できるようにするにはこのような仕組みが必要です。同様に、wiki のような一般的なウェブサイトや他の CMS でも必要です。</p>

<p><a href="/ja/docs/Web/HTTP/Methods/PUT" title="この項目についての文書はまだ書かれていません。書いてみませんか？"><code>PUT</code></a> を使用して、この機能を実装できます。クライアントは始めに元のファイルを読み込んで、変更した後にサーバーへ送信します。</p>

<p><img src="https://mdn.mozillademos.org/files/13743/HTTPLock1.png" alt="Updating a file with a PUT is very simple when concurrency is not involved."></p>

<p>残念ながら、並行処理を考慮すると若干の間違いが出てきます。あるクライアントがリソースの新たな複製をローカルで変更している間に、第二のクライアントが同じリソースを取得して、クライアント側で同じことを行えます。これにより、とても不幸なことが発生します。両者がリソースを引き渡すと、最初のクライアントが渡した変更点が次に渡されたものによって破棄されて、第二のクライアントは新たな変更点に気づきません。誰が勝ち取ったかの結果は他者には伝わりませんが、どのクライアントの変更点が反映されるかは引き渡す速度によって変わります。またその速度はクライアントやサーバーのパフォーマンス、さらにはクライアント側で人間が文書を編集するパフォーマンスに依存します。勝ち取る者は、その時々で変わります。これは<a href="/ja/docs/Glossary/race_condition" class="glossaryLink" title="この用語 (競合状態) の定義はまだ書かれていません。ぜひご寄稿ください！">競合状態</a>であり、検出やデバッグが難しい不確かな動作をもたらします。</p>

<p><img src="https://mdn.mozillademos.org/files/13749/HTTPLock2.png" alt="When several clients update the same resource in parallel, we are facing a race condition: the slowest win, and the others don&apos;t even know they lost. Problematic!" style="height: 504px; width: 904px;"></p>

<p>2 つのクライアントの片方を困らせることなく、この問題に対処する方法はありません。しかし、ロストアップデートや競合状態は避けるべきです。予測可能な結果や、クライアントが変更点を却下されたときに通知を受けることを望みます。</p>

<p>条件付きリクエストで、<em>楽観的ロックアルゴリズム</em> (ほとんどの wiki やソース管理システムで使用されています) を実装できます。この考え方ではすべてのクライアントに、リソースの複製の取得を許可してローカルで変更することを許可します。そして、最初のクライアントが更新内容を送信することを許可して成功させて、以降の古いバージョンになったリソースに基づく更新は拒否します。</p>

<p><img src="https://mdn.mozillademos.org/files/13751/HTTPLock3.png" alt="Conditional requests allow to implement optimistic locking: now the quickest wins, and the others get an error." style="height: 471px; width: 904px;"></p>

<p>これは <a href="/ja/docs/Web/HTTP/Headers/If-Match" title="HTTP の If-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、リストされた ETag のいずれかと一致する場合にのみ、サーバーは要求されたリソースを返します。PUT と他の安全ではないメソッドでは、この場合のみリソースをアップロードします。"><code>If-Match</code></a> および <a href="/ja/docs/Web/HTTP/Headers/If-Unmodified-Since" title="HTTP の If-Unmodified-Since リクエストヘッダーは、リクエストを条件付きにします。サーバーはリソースが指定された日時以降に変更されていない場合のみ、要求されたリソースを返信したり、 POST などの安全ではないメソッドをの場合はそれを受け付けたりします。リソースが指定された日時以降に変更されていた場合は、レスポンスは412 (Precondition Failed) エラーになります。"><code>If-Unmodified-Since</code></a> ヘッダーを使用して実装します。etag が元のファイルと一致しない、あるいはファイルが取得したときから変更されている場合は、変更点が <a href="/ja/docs/Web/HTTP/Status/412" title="HyperText Transfer Protocol (HTTP) 412 Precondition Failed クライアントエラーレスポンスコードは、ターゲットリソースへのアクセスが拒否されたことを示します。これは、If-Unmodified-Since または If-None-Match ヘッダーで定義された条件が満たされていない場合に、GET もしくは HEAD 以外のメソッドの条件付きリクエストで発生します。その場合、リクエスト (通常はリソースのアップロードまたは変更) を行うことができず、このエラーレスポンスが返されます。"><code>412</code></a> <code>Precondition Failed</code> エラーで拒否されます。このエラーへの対処はクライアント次第であり、今度は最新のバージョンで再び実行するよう人間に通知する、あるいは &quot;diff&quot; を表示して変更点を維持するかを人間が選択できるように支援します。</p>

<h3 id="Dealing_with_the_first_upload_of_a_resource" name="Dealing_with_the_first_upload_of_a_resource">リソースの最初のアップロードに対処する</h3>

<p>リソースの最初のアップロードは、前述の状況の特別なケースです。リソースの更新と同様に、2 つのクライアントが同時 (あるいはほぼ同時) にアップロードしようとする競合状態を仮定します。これを防ぐために条件付きリクエストを使用できます。すべての etag を表す特別な値 <code>&apos;*&apos;</code> を持つ <a href="/ja/docs/Web/HTTP/Headers/If-None-Match" title="HTTP の If-None-Match リクエストヘッダーは、リクエストを条件付きにします。 GET および HEAD メソッドの場合、指定されたものの中に要求されたリソースの ETag に一致するものがない場合のみ、サーバーはリソースを 200 ステータスで返します。その他のメソッドの場合、最終的に存在するリソースの ETag が列挙されたいずれの値とも一致しない場合にのみ処理します。"><code>If-None-Match</code></a> を追加することで、それより前のリクエストが存在しない場合に限り、リクエストが成功します。</p>

<p><img src="https://mdn.mozillademos.org/files/13753/HTTPFirst.png" alt="Like for a regular upload, the first upload of a resource is subject to a race condition: If-None-Match can prevent it." style="height: 311px; width: 895px;"></p>

<p><code>If-None-Match</code> は HTTP/1.1 (およびそれ以降) に準拠するサーバーのみで動作します。サーバーが対応しているかが不明である場合は、始めに確認用の <a href="/ja/docs/Web/HTTP/Methods/HEAD" title="この項目についての文書はまだ書かれていません。書いてみませんか？"><code>HEAD</code></a> リクエストをリソースに対して発行しなければなりません。</p>

<h2 id="Conclusion" name="Conclusion">まとめ</h2>

<p>条件付きリクエストは HTTP の重要な機能であり、効率的で複雑なアプリケーションの構築を可能にします。キャッシュやダウンロードの再開について、ウェブマスターに求められる作業はサーバーを適切に設定することだけです (一部の環境では正しい etag を設定することが難しいかもしれません)。また、ブラウザーが適切な条件付きリクエストを実行しますので、ウェブ開発者に求められる作業はありません</p>

<p>一方、ロックの仕組みでは、ウェブ開発者が適切なヘッダーを伴ってリクエストを発行しなければなりません。ウェブマスターはほとんどの場合、それらの確認をアプリケーションに頼ることができるでしょう。</p>

<p>どちらにせよ、条件付きリクエストはウェブの重要な機能であることは明らかです。</p>
