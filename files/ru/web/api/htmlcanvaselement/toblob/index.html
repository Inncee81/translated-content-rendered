---
title: HTMLCanvasElement.toBlob()
slug: Web/API/HTMLCanvasElement/toBlob
translation_of: Web/API/HTMLCanvasElement/toBlob
---
<div>
<div>
<div><section class="Quick_links" id="Quick_Links"><ol><li><strong><a href="/ru/docs/Web/API/Canvas_API">Canvas API</a></strong></li><li><strong><a href="/ru/docs/Web/API/HTMLCanvasElement"><code>HTMLCanvasElement</code></a></strong></li><li class="toggle"><details open><summary>Свойства</summary><ol><li><a href="/ru/docs/Web/API/HTMLCanvasElement/height"><code>height</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/height$translate" style="opacity: 0.5;">[Перевести]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="Это API не было стандартизировано."><i class="icon-warning-sign"> </i></span></span><span class="sidebar-icon"><span class="icon-only-inline" title="Это устаревшее API больше не должно использоваться, но оно по-прежнему может работать."><i class="icon-thumbs-down-alt"> </i></span></span><a href="/ru/docs/Web/API/HTMLCanvasElement/mozOpaque"><code>mozOpaque</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/mozOpaque$translate" style="opacity: 0.5;">[Перевести]</a></li><li><a href="/ru/docs/Web/API/HTMLCanvasElement/width"><code>width</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/width$translate" style="opacity: 0.5;">[Перевести]</a></li></ol></details></li><li class="toggle"><details open><summary>Методы</summary><ol><li><span class="sidebar-icon"><span class="icon-only-inline" title="Это экспериментальное API, которое не должно использоваться в рабочем коде."><i class="icon-beaker"> </i></span></span><a href="/ru/docs/Web/API/HTMLCanvasElement/captureStream"><code>captureStream()</code></a></li><li><a href="/ru/docs/Web/API/HTMLCanvasElement/getContext"><code>getContext()</code></a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="Этот API вышел из употребления и его работа больше не гарантируется."><i class="icon-trash"> </i></span></span><s class="obsoleteElement"><a href="/ru/docs/Web/API/HTMLCanvasElement/mozFetchAsStream"><code>mozFetchAsStream()</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/mozFetchAsStream$translate" style="opacity: 0.5;">[Перевести]</a></s></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="Это API не было стандартизировано."><i class="icon-warning-sign"> </i></span></span><a href="/ru/docs/Web/API/HTMLCanvasElement/mozGetAsFile"><code>mozGetAsFile()</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/mozGetAsFile$translate" style="opacity: 0.5;">[Перевести]</a></li><li><em><code>toBlob()</code></em></li><li><a href="/ru/docs/Web/API/HTMLCanvasElement/toDataURL"><code>toDataURL()</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/toDataURL$translate" style="opacity: 0.5;">[Перевести]</a></li><li><span class="sidebar-icon"><span class="icon-only-inline" title="Это экспериментальное API, которое не должно использоваться в рабочем коде."><i class="icon-beaker"> </i></span></span><a href="/ru/docs/Web/API/HTMLCanvasElement/transferControlToOffscreen"><code>transferControlToOffscreen()</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/transferControlToOffscreen$translate" style="opacity: 0.5;">[Перевести]</a></li></ol></details></li><li class="toggle"><details open><summary>События</summary><ol><li><a href="/ru/docs/Web/API/HTMLCanvasElement/webglcontextlost_event"><code>webglcontextlost</code></a> <a href="/ru/docs/Web/API/HTMLCanvasElement/webglcontextlost_event$translate" style="opacity: 0.5;">[Перевести]</a></li></ol></details></li><li class="toggle"><details open><summary>Наследование:</summary><ol><li><a href="/ru/docs/Web/API/HTMLElement"><code>HTMLElement</code></a></li><li><a href="/ru/docs/Web/API/Element"><code>Element</code></a></li><li><a href="/ru/docs/Web/API/Node"><code>Node</code></a></li><li><a href="/ru/docs/Web/API/EventTarget"><code>EventTarget</code></a></li></ol></details></li><li class="toggle"><details open><summary>Похожие страницы для Canvas API</summary><ol><li><a href="/ru/docs/Web/API/Canvas"><code>Canvas</code></a></li><li><a href="/ru/docs/Web/API/CanvasGradient"><code>CanvasGradient</code></a></li><li><a href="/ru/docs/Web/API/CanvasImageSource"><code>CanvasImageSource</code></a></li><li><a href="/ru/docs/Web/API/CanvasPattern"><code>CanvasPattern</code></a></li><li><a href="/ru/docs/Web/API/CanvasRenderingContext2D"><code>CanvasRenderingContext2D</code></a></li><li><a href="/ru/docs/Web/API/ImageBitmap"><code>ImageBitmap</code></a></li><li><a href="/ru/docs/Web/API/ImageBitmapFactories"><code>ImageBitmapFactories</code></a></li><li><a href="/ru/docs/Web/API/ImageBitmapRenderingContext"><code>ImageBitmapRenderingContext</code></a></li><li><a href="/ru/docs/Web/API/ImageData"><code>ImageData</code></a></li><li><a href="/ru/docs/Web/API/OffscreenCanvas"><code>OffscreenCanvas</code></a></li><li><a href="/ru/docs/Web/API/Path2D"><code>Path2D</code></a></li><li><a href="/ru/docs/Web/API/RenderingContext"><code>RenderingContext</code></a></li><li><a href="/ru/docs/Web/API/TextMetrics"><code>TextMetrics</code></a></li></ol></details></li></ol></section></div>
</div>
</div>

<p>Метод <strong><code>HTMLCanvasElement.toBlob()</code></strong> создаёт объект <a href="/ru/docs/Web/API/Blob" title="Объект Blob представляет из себя объект наподобие файла с неизменяемыми, необработанными данными. Blob-ы представляют данные, которые могут быть не в родном формате JavaScript. Интерфейс File основан на Blob, наследует функциональность Blob и расширяет его для поддержки файлов на стороне пользователя."><code>Blob</code></a> представляющий изображение, содержащееся в <code>canvas</code>; этот файл может быть закеширован на диске или храниться в памяти на усмотрение пользователя (<em>at the discretion of the user agent</em>). Если параметр <code>mimeType</code> не определён, типом изображения считается <code>image/png</code>. Созданное изображение имеет разрешение 96dpi.</p>

<p>Третий аргумент используется для изображений с MIME-типом <code>image/jpeg</code> для определения его качества.</p>

<h2 id="Синтаксис">Синтаксис</h2>

<pre class="syntaxbox">void <var>canvas</var>.toBlob(<var>callback</var>, <var>mimeType</var>, <var>qualityArgument</var>);
</pre>

<h3 id="Параметры">Параметры</h3>

<dl>
 <dt>callback</dt>
 <dd>Callback-функция с результирующим объектом <a href="/ru/docs/Web/API/Blob" title="Объект Blob представляет из себя объект наподобие файла с неизменяемыми, необработанными данными. Blob-ы представляют данные, которые могут быть не в родном формате JavaScript. Интерфейс File основан на Blob, наследует функциональность Blob и расширяет его для поддержки файлов на стороне пользователя."><code>Blob</code></a> в качестве единственного аргумента.</dd>
 <dt><code>mimeType</code> <span class="optional optionalInline notecard inline">Необязательный</span></dt>
 <dd>Аргумент типа <a href="/ru/docs/Web/API/DOMString" title="DOMString - это UTF-16 String. Так как JavaScript уже использует такие строки, DOMString непосредственно соответствует String."><code>DOMString</code></a> определяющий формат изображения. По умолчанию <code>image/png</code>.</dd>
 <dt><code>qualityArgument</code> <span class="optional optionalInline notecard inline">Необязательный</span></dt>
 <dd>Аргумент типа <a href="/ru/docs/Web/JavaScript/Reference/Global_Objects/Number" title="Объект Number является объектом-обёрткой, позволяющей вам работать с числовыми значениями. Объект Number создаётся через конструктор Number()."><code>Number</code></a> со значением от <code>0</code> до <code>1</code>, определяющий качество изображения, если заявлен MIME-тип <code>image/jpeg</code> или <code>image/webp</code>. Если этот аргумент содержит нечто иное, для определения качества изображения будет использовано значение по умолчанию. Остальные аргументы проигнорируются.</dd>
</dl>

<h3 id="Возвращаемое_значение">Возвращаемое значение</h3>

<p>Не возвращает ничего.</p>

<h2 id="Примеры">Примеры</h2>

<h3 id="Получение_файла_представленного_в_canvas">Получение файла, представленного в canvas</h3>

<p>Как только вы нарисовали содержимое в <code>canvas</code>, вы можете сконвертировать его в файл изображения любого поддерживаемого формата. Ниже приведён фрагмент кода, для примера, принимает изображение в элементе <a href="/ru/docs/Web/HTML/Element/canvas" title="HTML &lt;canvas&gt; Элемент может быть использован для отрисовки графики через скрипты (обычно используется JavaScript). На пример, его можно использовать для отрисовки графиков, делать композиции фото или даже выполнять анимации. Вы можете (и должны) дать альтернативное содержание внури блока &lt;canvas&gt;. Этот контент будет рендерится в обоих браузерах, в старых которые не поддерживают canvas и в браузерах с отключённым JavaScript."><code>&lt;canvas&gt;</code></a> с ID = &quot;canvas&quot; и получает его копию в виде PNG изображения, затем добавляет в документ новый элемент <a href="/ru/docs/Web/HTML/Element/img" title="HTML-элемент &lt;img&gt; встраивает изображение в документ. Это замещаемый элемент."><code>&lt;img&gt;</code></a>, исходное изображение которого создано с помощью холста.</p>

<pre class="brush: js">var canvas = document.getElementById(&apos;canvas&apos;);

canvas.toBlob(function(blob) {
  var newImg = document.createElement(&apos;img&apos;),
      url = URL.createObjectURL(blob);

  newImg.onload = function() {
    // больше не нужно читать blob, поэтому он отменен
    URL.revokeObjectURL(url);
  };

  newImg.src = url;
  document.body.appendChild(newImg);
});
</pre>

<p>Обратите внимание, что здесь мы создаём изображение PNG; если вы добавите второй параметр в вызов <code>toBlob()</code>, вы сможете определить тип необходимого изображения. Например, чтобы получить изображение в формате JPEG:</p>

<pre class="brush: js"> canvas.toBlob(function(blob){...}, &apos;image/jpeg&apos;, 0.95); // JPEG в 95% качестве</pre>

<div>
<h3 id="A_way_to_convert_a_canvas_to_an_ico_Mozilla_only">A way to convert a canvas to an ico (Mozilla only)</h3>

<p>Это использует <code>-moz-parse</code> для преобразования cnavas в ICO. Windows XP не поддерживает преобразование из PNG в ico, поэтому вместо этого использует bmp. Ссылка для загрузки создается путем установки атрибута загрузки. Значение атрибута загрузки - это имя, которое он будет использовать в качестве имени файла.</p>

<pre class="brush: js">var canvas = document.getElementById(&apos;canvas&apos;);
var d = canvas.width;
ctx = canvas.getContext(&apos;2d&apos;);
ctx.beginPath();
ctx.moveTo(d / 2, 0);
ctx.lineTo(d, d);
ctx.lineTo(0, d);
ctx.closePath();
ctx.fillStyle = &apos;yellow&apos;;
ctx.fill();

function blobCallback(iconName) {
  return function(b) {
    var a = document.createElement(&apos;a&apos;);
    a.textContent = &apos;Download&apos;;
    document.body.appendChild(a);
    a.style.display = &apos;block&apos;;
    a.download = iconName + &apos;.ico&apos;;
    a.href = window.URL.createObjectURL(b);
  }
}
canvas.toBlob(blobCallback(&apos;passThisString&apos;), &apos;image/vnd.microsoft.icon&apos;,
              &apos;-moz-parse-options:format=bmp;bpp=32&apos;);</pre>
</div>

<h3 id="Сохранение_toBlob_на_диске_ОСchromeadd-on_context_only">Сохранение toBlob на диске ОС(chrome/add-on context only)</h3>

<div class="note">
<p>Этот метод сохраняет его на рабочем столе и полезен только в контексте Firefox chrome или дополнительном коде, поскольку API ОС не присутствуют на веб-сайтах.</p>
</div>

<pre class="brush: js">var canvas = document.getElementById(&apos;canvas&apos;);
var d = canvas.width;
ctx = canvas.getContext(&apos;2d&apos;);
ctx.beginPath();
ctx.moveTo(d / 2, 0);
ctx.lineTo(d, d);
ctx.lineTo(0, d);
ctx.closePath();
ctx.fillStyle = &apos;yellow&apos;;
ctx.fill();

function blobCallback(iconName) {
  return function(b) {
    var r = new FileReader();
    r.onloadend = function () {
    // r.result contains the ArrayBuffer.
    Cu.import(&apos;resource://gre/modules/osfile.jsm&apos;);
    var writePath = OS.Path.join(OS.Constants.Path.desktopDir,
                                 iconName + &apos;.ico&apos;);
    var promise = OS.File.writeAtomic(writePath, new Uint8Array(r.result),
                                      {tmpPath:writePath + &apos;.tmp&apos;});
    promise.then(
      function() {
        console.log(&apos;successfully wrote file&apos;);
      },
      function() {
        console.log(&apos;failure writing file&apos;)
      }
    );
  };
  r.readAsArrayBuffer(b);
  }
}

canvas.toBlob(blobCallback(&apos;passThisString&apos;), &apos;image/vnd.microsoft.icon&apos;,
              &apos;-moz-parse-options:format=bmp;bpp=32&apos;);</pre>

<h2 id="Спецификации">Спецификации</h2>

<table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Specification</th>
   <th scope="col">Status</th>
   <th scope="col">Comment</th>
  </tr>
  <tr>
   <td><a class="external" href="https://html.spec.whatwg.org/multipage/scripting.html#dom-canvas-toblob" hreflang="en" lang="en">HTML Living Standard<br><small lang="ru">Определение &apos;HTMLCanvasElement.toBlob&apos; в этой спецификации.</small></a></td>
   <td><span class="spec-Living">Живой стандарт</span></td>
   <td>No change since the latest snapshot, <a class="external" href="https://www.w3.org/TR/html50/" hreflang="en" lang="en" title="Спецификация &apos;HTML5&apos;">HTML5</a></td>
  </tr>
  <tr>
   <td><a class="external" href="https://www.w3.org/TR/html51/scripting-1.html#dom-canvas-toblob" hreflang="en" lang="en">HTML 5.1<br><small lang="ru">Определение &apos;HTMLCanvasElement.toBlob&apos; в этой спецификации.</small></a></td>
   <td><span class="spec-REC">Рекомендация</span></td>
   <td>No change</td>
  </tr>
  <tr>
   <td><a class="external" href="https://www.w3.org/TR/html50/scripting-1.html#dom-canvas-toblob" hreflang="en" lang="en">HTML5<br><small lang="ru">Определение &apos;HTMLCanvasElement.toBlob&apos; в этой спецификации.</small></a></td>
   <td><span class="spec-REC">Рекомендация</span></td>
   <td>Snapshot of the <a class="external" href="https://html.spec.whatwg.org/multipage/" hreflang="en" lang="en" title="Спецификация &apos;HTML Living Standard&apos;">HTML Living Standard</a> containing the initial definition.</td>
  </tr>
 </tbody>
</table>

<h2 id="Поддержка_браузерами">Поддержка браузерами</h2>

<div class="warning notecard"><strong><a href="https://github.com/mdn/browser-compat-data">We&apos;re converting our compatibility data into a machine-readable JSON format</a></strong>.
            This compatibility table still uses the old format,
            because we haven&apos;t yet converted the data it contains.
            <strong><a href="/ru/docs/MDN/Contribute/Structures/Compatibility_tables">Find out how you can help!</a></strong></div>

<div class="htab">
    <a id="AutoCompatibilityTable" name="AutoCompatibilityTable"></a>
    <ul>
        <li class="selected"><a>Настольные</a></li>
        <li><a>Мобильные</a></li>
    </ul>
</div>

<div id="compat-desktop">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Chrome</th>
   <th>Firefox (Gecko)</th>
   <th>Internet Explorer</th>
   <th>Opera</th>
   <th>Safari</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td>50</td>
   <td><a href="/en-US/Firefox/Releases/19" title="Выпущен 2013-02-19.">19</a> (19)</td>
   <td>10<span class="prefixBox prefixBoxInline notecard inline" title="prefix"><a href="/ru/docs/Web/Guide/Prefixes" title="Эта возможность с префиксом с версии &apos;ms&apos; этого браузера, считается экспериментальной">ms</a></span></td>
   <td><span style="color: #888;" title="Пожалуйста, замените этот шаблон на указание самой ранней поддерживаемой версии.">(Да)</span></td>
   <td><span style="color: #888;" title="Пожалуйста, замените этот шаблон на указание самой ранней поддерживаемой версии.">(Да)</span><sup>[1]</sup></td>
  </tr>
  <tr>
   <td>Image quality parameter</td>
   <td>50</td>
   <td><a href="/en-US/Firefox/Releases/25" title="Выпущен 2013-10-29.">25</a> (25)</td>
   <td><span style="color: #f00;">Нет</span></td>
   <td><span style="color: #888;" title="Пожалуйста, замените этот шаблон на указание самой ранней поддерживаемой версии.">(Да)</span></td>
   <td><span style="color: #f00;">Нет</span></td>
  </tr>
 </tbody>
</table>
</div>

<div id="compat-mobile">
<table class="compat-table">
 <tbody>
  <tr>
   <th>Feature</th>
   <th>Android</th>
   <th>Android Webview</th>
   <th>Firefox Mobile (Gecko)</th>
   <th>IE Mobile</th>
   <th>Opera Mobile</th>
   <th>Safari Mobile</th>
   <th>Chrome for Android</th>
  </tr>
  <tr>
   <td>Basic support</td>
   <td><span style="color: #f00;">Нет</span></td>
   <td>50</td>
   <td>19.0 (19)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Совместимость неизвестна; пожалуйста, обновите информацию.">?</span></td>
   <td><span style="color: #f00;">Нет</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Совместимость неизвестна; пожалуйста, обновите информацию.">?</span></td>
   <td>50</td>
  </tr>
  <tr>
   <td>Image quality parameter</td>
   <td><span style="color: #f00;">Нет</span></td>
   <td>50</td>
   <td>25.0 (25)</td>
   <td><span style="color: rgb(255, 153, 0);" title="Совместимость неизвестна; пожалуйста, обновите информацию.">?</span></td>
   <td><span style="color: #f00;">Нет</span></td>
   <td><span style="color: rgb(255, 153, 0);" title="Совместимость неизвестна; пожалуйста, обновите информацию.">?</span></td>
   <td>50</td>
  </tr>
 </tbody>
</table>
</div>

<p>[1] See <a class="external" href="https://bugs.webkit.org/show_bug.cgi?id=71270" rel="external" title>Баг WebKit 71270</a>.</p>

<h2 id="Полифилл">Полифилл</h2>

<p>Полифилл, основанный на toDataURL, со слабой производительностью.</p>

<pre>if (!HTMLCanvasElement.prototype.toBlob) {
  Object.defineProperty(HTMLCanvasElement.prototype, &apos;toBlob&apos;, {
    value: function (callback, type, quality) {
      var dataURL = this.toDataURL(type, quality).split(&apos;,&apos;)[1];
      setTimeout(function() {

        var binStr = atob( dataURL ),
            len = binStr.length,
            arr = new Uint8Array(len);

        for (var i = 0; i &lt; len; i++ ) {
          arr[i] = binStr.charCodeAt(i);
        }

        callback( new Blob( [arr], {type: type || &apos;image/png&apos;} ) );

      });
    }
  });
}</pre>

<h2 id="Смотрите_также">Смотрите также</h2>

<ul>
 <li>The interface defining it, <a href="/ru/docs/Web/API/HTMLCanvasElement"><code>HTMLCanvasElement</code></a>.</li>
 <li><a href="/ru/docs/Web/API/Blob"><code>Blob</code></a></li>
</ul>
