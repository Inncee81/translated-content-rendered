---
title: L'audio dans les jeux Web
slug: Games/Techniques/Audio_for_Web_Games
tags:
  - API
  - Audio
  - Jeux
  - Web Audio API
  - audio sprites
translation_of: Games/Techniques/Audio_for_Web_Games
---
<div><section class="Quick_links" id="Quick_Links">
  <ol>
    <li class="toggle">
        <details>
            <summary>Introduction</summary>
            <ol>
              <li><a href="/fr/docs/Games/Introduction">Introduction</a></li>
              <li><a href="/fr/docs/Games/Anatomy">Anatomie d'un jeu vidéo</a></li>
              <li><a href="/fr/docs/Games/Examples">Exemples</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>API pour le développement de jeux</summary>
            <ol>
              <li><a href="/fr/docs/Web/API/Canvas_API">Canvas</a></li>
              <li><a href="/fr/docs/Web/CSS">CSS</a></li>
              <li><a href="/fr/docs/Web/Apps/Fundamentals/User_notifications/Full_screen_api">Full Screen (plein écran)</a></li>
              <li><a href="/fr/docs/Web/API/Gamepad_API">Gamepad (manette)</a></li>
              <li><a href="/fr/docs/Web/API/IndexedDB_API">IndexedDB</a></li>
              <li><a href="/fr/docs/Web/JavaScript">JavaScript</a></li>
              <li><a href="/fr/docs/Web/API/Pointer_Lock_API">Pointer Lock (verrou de pointeur)</a></li>
              <li><a href="/fr/docs/Web/SVG">SVG</a></li>
              <li><a href="/fr/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">Typed Arrays (tableaux typés)</a></li>
              <li><a href="/fr/docs/Web/API/Web_Audio_API">Web Audio</a></li>
              <li><a href="/fr/docs/Web/API/WebGL_API">WebGL</a></li>
              <li><a href="/fr/docs/Web/API/WebRTC_API">WebRTC</a></li>
              <li><a href="/fr/docs/Web/API/WebSockets_API">WebSockets</a></li>
              <li><a href="/fr/docs/Web/API/WebVR_API">WebVR (réalité virtuelle)</a></li>
              <li><a href="/fr/docs/Web/API/Web_Workers_API">Web Workers</a></li>
              <li><a href="/fr/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Techniques</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/Async_scripts">Utiliser des scripts asynchrones pour asm.js</a></li>
              <li><a href="/fr/docs/Web/Apps/Developing/Optimizing_startup_performance">Optimiser les performances de démarrage</a></li>
              <li><a href="/fr/docs/Games/Techniques/WebRTC_data_channels">Utiliser WebRTC - canaux de données pair-à-pair</a></li>
              <li><a href="/fr/docs/Games/Techniques/Efficient_animation_for_web_games">Animation efficace pour un jeu internet</a></li>
              <li><a href="/fr/docs/Games/Techniques/Audio_for_Web_Games">Audio pour les jeux web</a></li>
              <li><a href="/fr/docs/Games/Techniques/2D_collision_detection">Détection de collision 2D</a></li>
              <li><a href="/fr/docs/Games/Techniques/Tilemaps">Carreaux et carrelages</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Jeux 3D sur le Web</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web">Aperçu des jeux 3D sur le Web</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Basic_theory">Théorie de base sur la 3D</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_A-Frame">Construire une démo avec A-Frame</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Babylon.js">Construire une démo avec Babylon.js</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_PlayCanvas">Construire une démo avec PlayCanvas</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/Building_up_a_basic_demo_with_Three.js">Construire une démo avec Three.js</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_on_the_web/WebVR">WebVR (réalité virtuelle)</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_collision_detection">Détection de collision en 3D</a></li>
              <li><a href="/fr/docs/Games/Techniques/3D_collision_detection/Bounding_volume_collision_detection_with_THREE.js">Détection de collision de volumes avec THREE.js</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Mise en place des contrôle du jeu</summary>
            <ol>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms">Aperçu des mécanismes de contrôle du jeu</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Mobile_touch">Commandes tactiles mobiles</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Desktop_with_mouse_and_keyboard">Commandes à la souris et au clavier</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Desktop_with_gamepad">Commandes à la manette</a></li>
              <li><a href="/fr/docs/Games/Techniques/Control_mechanisms/Other">Contrôles non conventionnels</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Tutoriels</summary>
            <ol>
              <li><a href="/fr/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript">Jeu de casse-briques 2D avec du pur JavaScript</a></li>
              <li><a href="/fr/docs/Games/Tutorials/2D_breakout_game_Phaser">Jeu de casse-tête 2D avec Phaser</a></li>
              <li><a href="/fr/docs/Games/Tutorials/HTML5_Gamedev_Phaser_Device_Orientation">Jeu de labyrinthe 2D avec orientation du périphérique</a></li>
              <li><a href="https://mozdevs.github.io/html5-games-workshop/en/guides/platformer/start-here/">Jeu de plateforme 2D avec Phaser</a></li>
            </ol>
        </details>
    </li>
    <li class="toggle">
        <details>
            <summary>Publication de jeux</summary>
            <ol>
              <li><a href="/fr/docs/Games/Publishing_games">Aperçu des outils de publication des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_distribution">Distribution des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_promotion">Promotion des jeux</a></li>
              <li><a href="/fr/docs/Games/Publishing_games/Game_monetization">Monétisation des jeux</a></li>
            </ol>
        </details>
    </li>
  </ol>
</section></div><p>  </p>

<div class="summary">
<p>L'audio représente une chose essentielle dans n'importe quel jeu vidéo; il apporte de l'information et contribue à l'atmosphère du jeu. La prise en charge de l'audio a évolué de manière rapide mais il reste encore beaucoup de différences de prise en charge entre les navigateurs. Nous avons souvent besoin de décider quelles parties de notre contenu audio est intéressant et laquelle ne l'est pas, et mettre en place une stratégie en conséquence. Cet article fournit un guide détaillé sur l'implémentation de l'audio dans les jeux HTML5, détaillant quels choix technologiques fonctionneront sur le plus grand nombre de navigateurs.</p>
</div>

<h2 id="Avertissement_sur_l'audio_sur_mobile">Avertissement sur l'audio sur mobile</h2>

<p>Les plateformes mobiles sont de loin les plateformes où il est le plus difficile de mettre en place l'audio. Malheureusement c'est la plateforme la plus utilisée par les joueurs. Il y a certaines différences entre les plateformes de bureau (desktop) habituelles et les plateformes mobiles qui ont sûrement poussé les éditeurs de navigateur à faire des choix qui peuvent rendre difficle l'implémentation de l'audio par les utilisateurs. Regardons ensemble ces différences.</p>

<h3 id="Lecture_automatique">Lecture automatique</h3>

<p>Beaucoup de navigateurs mobiles vont simplement ignorer n'importe quelle requête de lancement automatique de musique faite par votre jeu; à la place, l'utilisateur va être obligé de lancer lui même la lecture via une action quelconque. Cela signifie que vous allez devoir prendre en compte cette diférence lors de l'implementation de votre lecture automatique. Ce problème est généralement <span lang="fr" id="result_box"><span>atténué en chargeant l'audio à l'avance et en l'amorçant sur un événement initié par l'utilisateur.</span></span></p>

<p><span lang="fr" id="result_box"><span>Pour une lecture automatique audio plus passive, par exemple une musique de fond qui commence dès qu'un jeu se charge, une astuce consiste à détecter l'événement * any * initié par l'utilisateur et à démarrer la lecture.</span> <span>Pour d'autres sons plus actifs qui seront utilisés pendant le jeu, nous pouvons envisager de les amorcer dès que l'on appuie sur un bouton de démarrage.</span></span></p>

<p><span lang="fr" id="result_box"><span>Pour faire primer l'audio de cette façon, nous voulons en jouer une partie ;</span> <span>pour cette raison, il est utile d'inclure un moment de silence à la fin de votre échantillon audio.</span> <span>Ce silence signifiera que nous pouvons maintenant utiliser JavaScript pour lire ce fichier à des points arbitraires.</span></span></p>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>Jouer une partie de votre fichier au volume zéro pourrait également fonctionner si le navigateur vous permet de changer le volume (voir ci-dessous).</span> <span>Notez également que la lecture et la mise en pause immédiate de votre audio ne garantissent pas qu'un petit morceau d'audio ne sera pas lu.</span></span></p>
</div>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>L'ajout d'une application Web sur votre écran d'accueil mobile peut changer ses capacités.</span> <span>Dans le cas d'une lecture automatique sur iOS, cela semble être le cas actuellement.</span> <span>Si possible, vous devriez essayer votre code sur plusieurs appareils et platesformes pour voir comment cela fonctionne.</span></span></p>
</div>

<h3 id="Volume">Volume</h3>

<p><span lang="fr" id="result_box"><span>Le contrôle du volume programmé peut être désactivé dans les navigateurs mobiles.</span> <span>La raison souvent donnée est que l'utilisateur doit maîtriser le volume au niveau du système d'exploitation et cela ne doit pas être ignoré.</span></span></p>

<h3 id="Mise_en_mémoire_tampon_et_préchargement"><span lang="fr" class="short_text" id="result_box"><span>Mise en mémoire tampon et préchargement</span></span></h3>

<p><span lang="fr" id="result_box"><span>Probablement comme une tentative d'atténuation de l'utilisation des données du réseau mobile, nous trouvons souvent que la mise en mémoire tampon est désactivée avant que la lecture n'ait été lancée.</span> <span>La mise en mémoire tampon est le processus par lequel le navigateur télécharge le média à l'avance, ce que nous devons souvent faire pour assurer une lecture fluide.</span></span></p>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>À bien des égards, le concept de mise en mémoire tampon est obsolète.</span> <span>Tant que les demandes de plage d'octets sont acceptées (ce qui est le comportement par défaut), nous devrions pouvoir sauter à un point spécifique de l'audio sans avoir à télécharger le contenu précédent.</span> <span>Cependant, le préchargement est toujours utile;</span> <span>sans cela, il faudrait toujours avoir une certaine communication client-serveur avant de commencer à jouer.</span></span></p>
</div>

<h3 id="Lecture_audio_simultanée"><span lang="fr" class="short_text" id="result_box"><span>Lecture audio simultanée</span></span></h3>

<p><span lang="fr" id="result_box"><span>Une exigence de nombreux jeux est de jouer plus d'un morceau audio en même temps ;</span> <span>par exemple, il peut y avoir de la musique de fond et des effets sonores pour diverses actions se produisant dans le jeu.</span> <span>Bien que la situation évolue rapidement avec l'adoption de l'</span></span> <a href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API">API Web Audio</a> <span lang="fr"><span>, la méthode actuellement la plus largement supportée, utilisant l'élément vanilla <a href="/fr/docs/Web/HTML/Element/audio" title="L'élément HTML &lt;audio> est utilisé afin d'intégrer un contenu sonore dans un document. Il peut contenir une ou plusieurs sources audio représentées avec l'attribut src ou l'élément &lt;source>. S'il y a plusieurs sources, l'agent utilisateur choisira celle qui convient le mieux."><code>&lt;audio&gt;</code></a>, produit des résultats inégaux sur les appareils mobiles.</span></span></p>

<h3 id="Test_et_support"><span lang="fr" class="short_text" id="result_box"><span>Test et support</span></span></h3>

<p><span lang="fr" id="result_box"><span>Voici un tableau qui montre quelles plateformes mobiles prennent en charge les fonctionnalités mentionnées ci-dessus.</span></span></p>

<table class="standard-table">
 <caption>Mobile support for web audio features</caption>
 <thead>
  <tr>
   <th scope="row">Navigateur de mobile</th>
   <th scope="col">Version</th>
   <th scope="col">Lecture simultanée</th>
   <th scope="col">Lecture automatique</th>
   <th scope="col">Ajustement du volume</th>
   <th scope="col">Préchargement</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <th scope="row">Chrome (Android)</th>
   <td>32+</td>
   <td>Oui</td>
   <td>Non</td>
   <td>Non</td>
   <td>Non</td>
  </tr>
  <tr>
   <th scope="row">Firefox (Android)</th>
   <td>26+</td>
   <td>Oui</td>
   <td>Oui</td>
   <td>Non</td>
   <td>Non</td>
  </tr>
  <tr>
   <th scope="row">Firefox OS</th>
   <td>1.2+</td>
   <td>Oui</td>
   <td>Oui</td>
   <td>Oui</td>
   <td>Oui</td>
  </tr>
  <tr>
   <th scope="row">IE Mobile</th>
   <td>11+</td>
   <td>Oui</td>
   <td>Oui</td>
   <td>Non</td>
   <td>Oui</td>
  </tr>
  <tr>
   <th scope="row">Opera Mobile</th>
   <td>11+</td>
   <td>Non</td>
   <td>Non</td>
   <td>Non</td>
   <td>Non</td>
  </tr>
  <tr>
   <th scope="row">Safari (iOS)</th>
   <td>7+</td>
   <td>Oui/Non*</td>
   <td>Non</td>
   <td>Non</td>
   <td>Oui</td>
  </tr>
  <tr>
   <th scope="row">Android Browser</th>
   <td>2.3+</td>
   <td>Non</td>
   <td>Non</td>
   <td>Non</td>
   <td>Non</td>
  </tr>
 </tbody>
</table>

<div class="note">
<p><strong>* Note </strong>: <span lang="fr" id="result_box"><span>Safari 7 a des problèmes à jouer si vous essayez de démarrer tous les morceaux audio simultanément.</span> <span>Si vous échelonnez la lecture, vous aurez peut-être un certain succès.</span></span></p>
</div>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>La lecture audio simultanée est testée à l'aide de notre <a href="http://jsfiddle.net/dmkyaq0r/">exemple de test audio simultané</a>, avec lequel nous essayons de lire trois morceaux en même temps en utilisant l'API audio standard.</span></span></p>
</div>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>La fonctionnalité de lecture automatique simple est testée avec notre</span></span> <a href="http://jsfiddle.net/vpdspp2b/">exemp;e test lecture automatique</a>.</p>
</div>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" class="short_text" id="result_box"><span>La variabilité du volume est testée avec notre</span></span> <a href="http://jsfiddle.net/7ta12vw4/">exemple test volume</a>.</p>
</div>

<h2 id="Solutions_de_contournement_pour_mobile"><span lang="fr" class="short_text" id="result_box"><span>Solutions de contournement pour mobile</span></span></h2>

<p><span lang="fr" id="result_box"><span>Bien que les navigateurs mobiles puissent présenter les problèmes évoqués ci-dessus, il existe des moyens de les contourner.</span></span></p>

<h3 id="Les_sprites_audio">Les "sprites" audio</h3>

<p><span lang="fr" id="result_box"><span>Les "sprites" audio empruntent leur nom aux <a href="https://developer.mozilla.org/fr/docs/Web/CSS/CSS_Images/Sprites_CSS">"sprites" CSS</a> ; c'est une technique visuelle permettant d'utiliser CSS avec une seule ressource graphique pour la découper en une série d'objets-images.</span> <span>Nous pouvons appliquer le même principe à l'audio, au lieu de disposer d'un petit nombre de petits fichiers audio qui prennent du temps à charger et à lire, nous avons un fichier audio plus grand contenant tous les fragments audio plus petits dont nous avons besoin.</span> <span>Pour lire un son spécifique à partir du fichier, nous utilisons simplement les périodes de début et de fin connues pour chaque "sprite" audio.</span></span></p>

<p><span lang="fr" id="result_box"><span>L'avantage est que nous pouvons amorcer un morceau d'audio et avoir nos "sprites" prêts à partir.</span> <span>Pour ce faire, nous pouvons juste jouer et mettre en pause instantanément la plus grande partie de l'audio.</span> <span>Nous réduisons également le nombre de demandes de serveur et économisons de la bande passante.</span></span></p>

<pre class="brush: js">var myAudio = document.createElement("audio");
myAudio.src = "mysprite.mp3";
myAudio.play();
myAudio.pause();</pre>

<p><span lang="fr" id="result_box"><span>Vous aurez besoin d'échantillonner l'heure actuelle pour savoir quand l'arrêter.</span> <span>Si vous espacez vos sons individuels d'au moins 500 ms, l'utilisation de l'événement <code>timeUpdate</code> (qui se déclenche toutes les 250 ms) devrait suffire.</span> <span>Vos fichiers peuvent être légèrement plus longs que ce qu'ils devraient être, mais le silence se compresse bien.</span></span></p>

<p><span lang="fr" id="result_box"><span>Voici un exemple d'un lecteur de "sprite" audio - nous allons d'abord configurer l'interface utilisateur en HTML :</span></span></p>

<pre class="brush: html line-numbers  language-html"><code class="language-html"><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>audio</span> <span class="attr-name token">id</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>myAudio<span class="punctuation token">"</span></span> <span class="attr-name token">src</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/tmp/countdown.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>audio</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>18<span class="punctuation token">"</span></span> <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>19<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>0<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>16<span class="punctuation token">"</span></span> <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>17<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>1<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>14<span class="punctuation token">"</span></span> <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>15<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>2<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>12<span class="punctuation token">"</span></span> <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>13<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>3<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>10<span class="punctuation token">"</span></span> <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>11<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>4<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>8<span class="punctuation token">"</span></span>  <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>9<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>5<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>6<span class="punctuation token">"</span></span>  <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>7<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>6<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>4<span class="punctuation token">"</span></span>  <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>5<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>7<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>2<span class="punctuation token">"</span></span>  <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>8<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>button</span> <span class="attr-name token">data-start</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>0<span class="punctuation token">"</span></span>  <span class="attr-name token">data-stop</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>1<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>9<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>button</span><span class="punctuation token">&gt;</span></span></code></pre>

<p><span lang="fr" id="result_box"><span>Maintenant, nous avons des boutons avec des heures de début et de fin en quelques secondes.</span> <span>Le fichier MP3 "countdown.mp3" se compose d'un numéro qui est prononcé toutes les 2 secondes, l'idée étant de lire ce numéro lorsque le bouton correspondant est pressé.</span></span></p>

<p><span lang="fr" class="short_text" id="result_box"><span>Ajoutons du JavaScript pour que ça marche:</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">var</span> myAudio <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementById</span><span class="punctuation token">(</span><span class="string token">'myAudio'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> buttons <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementsByTagName</span><span class="punctuation token">(</span><span class="string token">'button'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> stopTime <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>

<span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span> i <span class="operator token">&lt;</span> buttons<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  buttons<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">'click'</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
    myAudio<span class="punctuation token">.</span>currentTime <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span><span class="function token">getAttribute</span><span class="punctuation token">(</span><span class="string token">"data-start"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    stopTime <span class="operator token">=</span> <span class="keyword token">this</span><span class="punctuation token">.</span><span class="function token">getAttribute</span><span class="punctuation token">(</span><span class="string token">"data-stop"</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    myAudio<span class="punctuation token">.</span><span class="function token">play</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span><span class="punctuation token">,</span> <span class="keyword token">false</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

myAudio<span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">'timeupdate'</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">if</span> <span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>currentTime <span class="operator token">&gt;</span> stopTime<span class="punctuation token">)</span> <span class="punctuation token">{</span>
    <span class="keyword token">this</span><span class="punctuation token">.</span><span class="function token">pause</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span>
<span class="punctuation token">}</span><span class="punctuation token">,</span> <span class="keyword token">false</span><span class="punctuation token">)</span><span class="punctuation token">;</span></code></pre>

<div class="note">
<p><strong>Note </strong>: Vous pouvez <a href="http://jsfiddle.net/59vwaame/">essayer notre lecteur de sprite audio</a> sur JSFiddle.</p>
</div>

<div class="note">
<p><strong>Note </strong>: Sur mobile <span lang="fr" id="result_box"><span>nous pouvons avoir besoin de déclencher ce code à partir d'un événement initié par l'utilisateur, tel qu'un bouton de démarrage pressé, comme décrit ci-dessus.</span></span></p>
</div>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>Attention aux débits binaires.</span> <span>L'encodage de votre audio à des débits binaires inférieurs signifie des tailles de fichier plus petites, mais une précision de recherche plus faible.</span></span></p>
</div>

<h2 id="Musique_de_fond">Musique de fond</h2>

<p><span lang="fr" id="result_box"><span>La musique dans les jeux peut avoir un effet émotionnel puissant.</span> <span>Vous pouvez mélanger et assortir divers échantillons de musique et, en supposant que vous pouvez contrôler le volume de votre élément audio, vous pouvez fondre différentes pièces musicales.</span> <span>En utilisant la méthode </span></span> <code><a href="https://developer.mozilla.org/fr/Apps/Fundamentals/Audio_and_video_delivery/WebAudio_playbackRate_explained">playbackRate()</a></code> <span lang="fr"><span>, vous pouvez même ajuster la vitesse de votre musique sans affecter la hauteur, pour mieux la synchroniser avec l'action.</span></span><br>
 <br>
 <span lang="fr" id="result_box"><span>Tout ceci est possible en utilisant l'élément standard <a href="/fr/docs/Web/HTML/Element/audio" title="L'élément HTML &lt;audio> est utilisé afin d'intégrer un contenu sonore dans un document. Il peut contenir une ou plusieurs sources audio représentées avec l'attribut src ou l'élément &lt;source>. S'il y a plusieurs sources, l'agent utilisateur choisira celle qui convient le mieux."><code>&lt;audio&gt;</code></a> associé à l'API </span></span> <a href="/fr/docs/Web/API/HTMLMediaElement" title="L'interface HTMLMediaElement ajoute à HTMLElement les propriétés et les méthodes nécessaires pour prendre en charge les fonctionnalités de base liées aux médias qui sont communes aux vidéos et aux documents audios. HTMLVideoElement et HTMLAudioElement héritent de cette interface."><code>HTMLMediaElement</code></a> <span lang="fr"><span>, mais il devient beaucoup plus facile et flexible avec l'<a href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API">API Web Audio</a>.</span></span></p>

<h2 id="API_Web_Audio_pour_les_jeux">API Web Audio pour les jeux</h2>

<p><span lang="fr" id="result_box"><span>Maintenant qu'il est supporté dans tous les navigateurs modernes à l'exception d'Opera Mini et d'Internet Explorer (<a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/status/webaudioapi/">bien que Microsoft travaille maintenant dessus</a>), une approche acceptable pour de nombreuses situations est d'utiliser l'<a href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API">API Web Audio</a></span></span><span lang="fr"><span> (voir la page </span></span><a href="http://caniuse.com/#search=web%20audio%20api">Puis-je utiliser l'API Web Audio ?</a> <span lang="fr"><span>pour plus d'informations</span> <span>sur la compatibilité du navigateur).</span> <span>L'API Web Audio est une API JavaScript audio avancée, idéale pour l'audio du jeu.</span> <span>Les développeurs peuvent générer de l'audio et manipuler des échantillons audio tout en positionnant le son dans l'espace de jeu 3D.</span></span></p>

<p><span lang="fr" id="result_box"><span>Une stratégie inter-navigateurs envisageable serait de fournir un son basique à l'aide de l'élément standard <a href="/fr/docs/Web/HTML/Element/audio" title="L'élément HTML &lt;audio> est utilisé afin d'intégrer un contenu sonore dans un document. Il peut contenir une ou plusieurs sources audio représentées avec l'attribut src ou l'élément &lt;source>. S'il y a plusieurs sources, l'agent utilisateur choisira celle qui convient le mieux."><code>&lt;audio&gt;</code></a> et, là où cela est pris en charge, d'améliorer l'expérience en utilisant l'API Web Audio.</span></span></p>

<div class="note">
<p><strong>Note</strong> : <span lang="fr" id="result_box"><span>De manière significative, iOS Safari prend désormais en charge l'API Web Audio, ce qui signifie qu'il est désormais possible d'écrire des jeux Web avec de l'audio de qualité native pour iOS.</span></span></p>
</div>

<p><span lang="fr" id="result_box"><span>Comme l'API Web Audio permet un timing et un contrôle précis de la lecture audio, nous pouvons l'utiliser pour jouer des échantillons à des moments spécifiques, ce qui est un aspect immersif crucial du jeu.</span> <span>Vous voulez que ces explosions soient<strong> accompagnées</strong> par un boom tonitruant, pas <strong>l'un après les autres</strong>, après tout.</span></span></p>

<h3 id="Musique_de_fond_avec_l'API_Web_Audio">Musique de fond avec l'API Web Audio</h3>

<p><span lang="fr" id="result_box"><span>Bien que nous puissions utiliser l'élément <a href="/fr/docs/Web/HTML/Element/audio" title="L'élément HTML &lt;audio> est utilisé afin d'intégrer un contenu sonore dans un document. Il peut contenir une ou plusieurs sources audio représentées avec l'attribut src ou l'élément &lt;source>. S'il y a plusieurs sources, l'agent utilisateur choisira celle qui convient le mieux."><code>&lt;audio&gt;</code></a> pour fournir une musique de fond linéaire, qui ne change pas en réaction à l'environnement du jeu, l'API Web Audio est idéale pour implémenter une expérience musicale plus dynamique.</span> <span>Vous pouvez vouloir que la musique change selon que vous essayez de créer du suspense ou d'encourager le joueur d'une manière ou d'une autre.</span> <span>La musique est une partie importante de l'expérience de jeu et, selon le type de jeu, vous voudrez peut-être investir des efforts considérables pour bien faire les choses.</span></span></p>

<p><span lang="fr" id="result_box"><span>Une façon de rendre votre musique plus dynamique est de la diviser en boucles ou en pistes de composant.</span> <span>C'est souvent la façon dont les musiciens composent la musique de toute façon, et l'API Web Audio est extrêmement efficace pour garder ces parties synchronisées.</span> <span>Une fois que vous avez les différentes pistes qui composent votre morceau, vous pouvez apporter des pistes ou en retirer de la façon appropriée.</span></span></p>

<p><span lang="fr" id="result_box"><span>Vous pouvez également appliquer des filtres ou des effets à la musique.</span> <span>Votre personnage est-il dans une grotte ?</span> <span>Augmentez l'écho.</span> <span>Peut-être que vous avez des scènes sous-marines, alors appliquez un filtre qui étouffe le son.</span></span></p>

<p><span lang="fr" id="result_box"><span>Regardons quelques techniques de l'API Web Audio pour ajuster dynamiquement la musique à partir de ses pistes de base.</span></span></p>

<h3 id="Chargement_des_pistes"><span lang="fr" class="short_text" id="result_box"><span>Chargement des pistes</span></span></h3>

<p><span lang="fr" id="result_box"><span>Avec l'API Web Audio, vous pouvez charger individuellement des pistes et des boucles séparées en utilisant </span></span> <a href="https://developer.mozilla.org/fr/docs/Web/API/XMLHttpRequest"><code>XMLHttpRequest</code></a>, <span lang="fr"><span>ce qui signifie que vous pouvez les charger de manière synchrone ou en parallèle.</span> <span>Le chargement synchrone peut signifier que certaines parties de votre musique sont prêtes plus tôt et vous pouvez commencer à les jouer pendant que d'autres se chargent.</span></span></p>

<p><span lang="fr" id="result_box"><span>De toute façon, vous pouvez vouloir synchroniser des pistes ou des boucles.</span> <span>L'API Web Audio contient la notion d'horloge interne qui commence à cocher le moment où vous créez un contexte audio.</span> <span>Vous devez prendre en compte le temps entre la création d'un contexte audio et le moment où la première piste audio commence à jouer.</span> <span>L'enregistrement de ce décalage et l'interrogation de l'heure actuelle de la piste de lecture vous donnent suffisamment d'informations pour synchroniser des morceaux audio distincts.</span></span></p>

<p><span lang="fr" id="result_box"><span>Pour voir cela en action, mettons en place des pistes distinctes :</span></span></p>

<pre class="brush: html line-numbers  language-html"><code class="language-html"><span class="tag token"><span class="tag token">ul</span><span class="punctuation token">&gt;</span></span>
  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>li</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>a</span> <span class="attr-name token">class</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>track<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/audio/mp3/gbreggae-leadguitar.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>Lead Guitar<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>a</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>li</span><span class="punctuation token">&gt;</span></span>
  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>li</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>a</span> <span class="attr-name token">class</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>track<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/audio/mp3/gbreggae-drums.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>Drums<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>a</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>li</span><span class="punctuation token">&gt;</span></span>
  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>li</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>a</span> <span class="attr-name token">class</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>track<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/audio/mp3/gbreggae-bassguitar.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>Bass Guitar<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>a</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>li</span><span class="punctuation token">&gt;</span></span>
  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>li</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>a</span> <span class="attr-name token">class</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>track<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/audio/mp3/gbreggae-horns.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>Horns<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>a</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>li</span><span class="punctuation token">&gt;</span></span>
  <span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>li</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;</span>a</span> <span class="attr-name token">class</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>track<span class="punctuation token">"</span></span> <span class="attr-name token">href</span><span class="attr-value token"><span class="punctuation token">=</span><span class="punctuation token">"</span>http://jPlayer.org/audio/mp3/gbreggae-clav.mp3<span class="punctuation token">"</span></span><span class="punctuation token">&gt;</span></span>Clavi<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>a</span><span class="punctuation token">&gt;</span></span><span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>li</span><span class="punctuation token">&gt;</span></span>
<span class="tag token"><span class="tag token"><span class="punctuation token">&lt;/</span>ul</span><span class="punctuation token">&gt;</span></span></code></pre>

<p><span lang="fr" id="result_box"><span>Toutes ces pistes ont le même tempo et sont conçues pour être synchronisées les unes avec les autres.</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js">window<span class="punctuation token">.</span>AudioContext <span class="operator token">=</span> window<span class="punctuation token">.</span>AudioContext <span class="operator token">||</span> window<span class="punctuation token">.</span>webkitAudioContext<span class="punctuation token">;</span>

<span class="keyword token">var</span> offset <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">;</span>
<span class="keyword token">var</span> context <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">AudioContext</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

<span class="keyword token">function</span> <span class="function token">playTrack</span><span class="punctuation token">(</span>url<span class="punctuation token">)</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> request <span class="operator token">=</span> <span class="keyword token">new</span> <span class="class-name token">XMLHttpRequest</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  request<span class="punctuation token">.</span><span class="function token">open</span><span class="punctuation token">(</span><span class="string token">'GET'</span><span class="punctuation token">,</span> url<span class="punctuation token">,</span> <span class="keyword token">true</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  request<span class="punctuation token">.</span>responseType <span class="operator token">=</span> <span class="string token">'arraybuffer'</span><span class="punctuation token">;</span>

  <span class="keyword token">var</span> audiobuffer<span class="punctuation token">;</span>

  <span class="comment token">// Decode asynchronously</span>
  request<span class="punctuation token">.</span>onload <span class="operator token">=</span> <span class="keyword token">function</span><span class="punctuation token">(</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>

    <span class="keyword token">if</span> <span class="punctuation token">(</span>request<span class="punctuation token">.</span>status <span class="operator token">==</span> <span class="number token">200</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>

      context<span class="punctuation token">.</span><span class="function token">decodeAudioData</span><span class="punctuation token">(</span>request<span class="punctuation token">.</span>response<span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>buffer<span class="punctuation token">)</span> <span class="punctuation token">{</span>
        <span class="keyword token">var</span> source <span class="operator token">=</span> context<span class="punctuation token">.</span><span class="function token">createBufferSource</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
        source<span class="punctuation token">.</span>buffer <span class="operator token">=</span> buffer<span class="punctuation token">;</span>
        source<span class="punctuation token">.</span><span class="function token">connect</span><span class="punctuation token">(</span>context<span class="punctuation token">.</span>destination<span class="punctuation token">)</span><span class="punctuation token">;</span>
        console<span class="punctuation token">.</span><span class="function token">log</span><span class="punctuation token">(</span><span class="string token">'context.currentTime '</span> <span class="operator token">+</span> context<span class="punctuation token">.</span>currentTime<span class="punctuation token">)</span><span class="punctuation token">;</span>

        <span class="keyword token">if</span> <span class="punctuation token">(</span>offset <span class="operator token">==</span> <span class="number token">0</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
          source<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
          offset <span class="operator token">=</span> context<span class="punctuation token">.</span>currentTime<span class="punctuation token">;</span>
        <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
          source<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="number token">0</span><span class="punctuation token">,</span>context<span class="punctuation token">.</span>currentTime <span class="operator token">-</span> offset<span class="punctuation token">)</span><span class="punctuation token">;</span>
        <span class="punctuation token">}</span>

      <span class="punctuation token">}</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span> <span class="punctuation token">{</span>
        console<span class="punctuation token">.</span><span class="function token">log</span><span class="punctuation token">(</span><span class="string token">'Error decoding audio data:'</span> <span class="operator token">+</span> e<span class="punctuation token">)</span><span class="punctuation token">;</span>
      <span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
      console<span class="punctuation token">.</span><span class="function token">log</span><span class="punctuation token">(</span><span class="string token">'Audio didn\'t load successfully; error code:'</span> <span class="operator token">+</span> request<span class="punctuation token">.</span>statusText<span class="punctuation token">)</span><span class="punctuation token">;</span>
    <span class="punctuation token">}</span>
  <span class="punctuation token">}</span>
  request<span class="punctuation token">.</span><span class="function token">send</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span>

<span class="keyword token">var</span> tracks <span class="operator token">=</span> document<span class="punctuation token">.</span><span class="function token">getElementsByClassName</span><span class="punctuation token">(</span><span class="string token">'track'</span><span class="punctuation token">)</span><span class="punctuation token">;</span>

<span class="keyword token">for</span> <span class="punctuation token">(</span><span class="keyword token">var</span> i <span class="operator token">=</span> <span class="number token">0</span><span class="punctuation token">,</span> len <span class="operator token">=</span> tracks<span class="punctuation token">.</span>length<span class="punctuation token">;</span> i <span class="operator token">&lt;</span> len<span class="punctuation token">;</span> i<span class="operator token">++</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  tracks<span class="punctuation token">[</span>i<span class="punctuation token">]</span><span class="punctuation token">.</span><span class="function token">addEventListener</span><span class="punctuation token">(</span><span class="string token">'click'</span><span class="punctuation token">,</span> <span class="keyword token">function</span><span class="punctuation token">(</span>e<span class="punctuation token">)</span><span class="punctuation token">{</span>

    <span class="function token">playTrack</span><span class="punctuation token">(</span><span class="keyword token">this</span><span class="punctuation token">.</span>href<span class="punctuation token">)</span><span class="punctuation token">;</span>
    e<span class="punctuation token">.</span><span class="function token">preventDefault</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="punctuation token">}</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<div class="note">
<p><strong>Note</strong>: Vous pouvez essayer notre <a href="http://jsfiddle.net/c87z11jj/1/">démo multipiste API Web Audio</a> sur JSFiddle.</p>
</div>

<p><span lang="fr" id="result_box"><span>Regardons maintenant le code.</span> <span>Nous créons d'abord un nouveau <a href="/fr/docs/Web/API/AudioContext" title="L'interface AudioContext représente un graphe de traitement audio fait de modules audio reliés entre eux, chaque module correspondant à un AudioNode. Un contexte audio contrôle à la fois la création des nœuds qu'il contient et l'exécution du traitement audio, ou du décodage. On commence toujours par créer un contexte audio, et tout ce qui va se passer ensuite se situera dans ce contexte."><code>AudioContext</code></a> et créons une fonction <code>(playTrack ())</code> qui charge et commence à jouer une piste.</span></span></p>

<p><code>start()</code> <span lang="fr" id="result_box"><span>(anciennement appelé <code>noteOn ())</code> commence à lire un élément audio.</span> <span><code>start ()</code> demande trois paramètres (facultatifs) :</span></span></p>

<ol>
 <li>when <em>(quand)</em> : <span lang="fr" class="short_text" id="result_box"><span>le temps absolu pour commencer la lecture</span></span> .</li>
 <li>where (offset) <em>(où)</em> : la partie de l'audio qui doit commencer à être jouée.</li>
 <li>how long <em>(combien de temps)</em> : la durée pendant laquelle elle doit être jouée.</li>
</ol>

<p><code>stop()</code> <span lang="fr" id="result_box"><span>prend un paramètre facultatif - </span></span>when<span lang="fr"><span> - qui est le délai avant l'arrêt.</span></span><br>
 <br>
 <span lang="fr" id="result_box"><span>Si le second paramètre de <code>start ()</code></span></span> — <span lang="fr"><span> </span></span> the offset (<span lang="fr"><span><em>le décalage</em>) </span></span> — <span lang="fr"><span> est nul, nous commençons à jouer dès le début l'audio donné ; ce que nous faisons en premier.</span> <span>Nous stockons ensuite le <a href="/fr/docs/Web/API/AudioContext/currentTime" title="Cette documentation n'a pas encore été rédigée, vous pouvez aider en contribuant !"><code>AudioContext.currentTime</code></a> </span></span> — <span lang="fr"><span> le décalage de la première lecture de la pièce, soustrayons celle des temps actuels pour calculer l'heure réelle, et utilisons cela pour synchroniser nos pistes.</span></span><br>
 <br>
 <span lang="fr" id="result_box"><span>Dans le contexte de votre monde de jeu, vous pouvez avoir des boucles et des échantillons qui sont joués dans différentes circonstances, et il peut être utile de pouvoir les synchroniser avec d'autres pistes pour une expérience plus transparente.</span></span></p>

<div class="note">
<p><strong>Note </strong>: <span lang="fr" id="result_box"><span>Cet exemple n'attend pas la fin du battement avant d'introduire le morceau suivant;</span> <span>nous pourrions le faire si nous connaissions le BPM (battement par minute) des pistes.</span></span></p>
</div>

<p><span lang="fr" id="result_box"><span>Vous pouvez trouver que l'introduction d'une nouvelle piste sonne plus naturelle si elle entre dans le battement, la mesure ou la phrase, selon l'unité que vous voulez pour votre musique de fond.</span></span></p>

<p><span lang="fr" id="result_box"><span>Pour ce faire, avant de jouer la piste que vous voulez synchroniser, vous devez calculer combien de temps cela va durer jusqu'au début de la prochaine unité musicale.</span></span></p>

<p><span lang="fr" id="result_box"><span>Voici un peu de code qui donne un tempo (le temps en secondes de votre battement / mesure), calcule combien de temps attendre pour jouer la partie suivante </span></span> — <span lang="fr"><span> vous alimentez la valeur initiale de la fonction <code>start ()</code> avec le premier paramètre qui</span> <span>prend le temps absolu de début de la lecture.</span> <span>Notez que le deuxième paramètre (où commencer à jouer à partir de la nouvelle piste) est relatif :</span></span></p>

<pre class="brush: js line-numbers  language-js"><code class="language-js"><span class="keyword token">if</span> <span class="punctuation token">(</span>offset <span class="operator token">==</span> <span class="number token">0</span><span class="punctuation token">)</span> <span class="punctuation token">{</span>
  source<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span><span class="punctuation token">)</span><span class="punctuation token">;</span>
  offset <span class="operator token">=</span> context<span class="punctuation token">.</span>currentTime<span class="punctuation token">;</span>
<span class="punctuation token">}</span> <span class="keyword token">else</span> <span class="punctuation token">{</span>
  <span class="keyword token">var</span> relativeTime <span class="operator token">=</span> context<span class="punctuation token">.</span>currentTime <span class="operator token">-</span> offset<span class="punctuation token">;</span>
  <span class="keyword token">var</span> beats <span class="operator token">=</span> relativeTime <span class="operator token">/</span> tempo<span class="punctuation token">;</span>
  <span class="keyword token">var</span> remainder <span class="operator token">=</span> beats <span class="operator token">-</span> Math<span class="punctuation token">.</span><span class="function token">floor</span><span class="punctuation token">(</span>beats<span class="punctuation token">)</span><span class="punctuation token">;</span>
  <span class="keyword token">var</span> delay <span class="operator token">=</span> tempo <span class="operator token">-</span> <span class="punctuation token">(</span>remainder<span class="operator token">*</span>tempo<span class="punctuation token">)</span><span class="punctuation token">;</span>
  source<span class="punctuation token">.</span><span class="function token">start</span><span class="punctuation token">(</span>context<span class="punctuation token">.</span>currentTime<span class="operator token">+</span>delay<span class="punctuation token">,</span> relativeTime<span class="operator token">+</span>delay<span class="punctuation token">)</span><span class="punctuation token">;</span>
<span class="punctuation token">}</span></code></pre>

<div class="note">
<p><strong>Note</strong>: Ici, vous pouvez <a href="http://jsfiddle.net/c87z11jj/2/">essayer notre code calculateur d'attente</a> , sur JSFiddle (synchronisé à la mesure).</p>
</div>

<div class="note">
<p><strong>Note</strong>: Si le premier paramètre est 0 ou inférieur au contexte <code>currentTime</code>, la musique commence immédiatement.</p>
</div>

<h3 id="Audio_positionnel">Audio positionnel</h3>

<p><span lang="fr" id="result_box"><span>L'audio positionnel peut être une technique importante pour faire de l'audio un élément clé d'une expérience de jeu immersive.</span> <span>L'API Web Audio permet non seulement de positionner un certain nombre de sources audio dans un espace tridimensionnel, mais également d'appliquer des filtres qui rendent cet audio plus réaliste.</span></span></p>

<p><span lang="fr" id="result_box"><span>En bref, en utilisant les capacités positionnelles de l'API Web Audio, nous pouvons relier d'autres informations sur le monde du jeu pour le joueur.</span></span></p>

<p>Nous pouvons relier :</p>

<ul>
 <li>la position des objets</li>
 <li>la direction des objets (mouvement de position et génération de l'effet Doppler)</li>
 <li>l'environnement (caverneux, sous-marin, etc.)</li>
</ul>

<p><span lang="fr" id="result_box"><span>Ceci est particulièrement utile dans un environnement tridimensionnel rendu en utilisant</span></span> <a href="https://developer.mozilla.org/fr/docs/Web/API/WebGL_API">WebGL</a>, <span lang="fr" id="result_box"><span>avec lequel l'API Web Audio permet d'associer l'audio aux objets et aux points de vue</span></span> .</p>

<div class="note">
<p><strong>Note</strong> : Voir <a href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API/Web_audio_spatialization_basics">Web Audio API Spatialization Basics</a> <em>(Bases de la spacialisation de l'API Web Audio)</em> pour plus de détails.</p>
</div>

<h2 id="See_Also">See Also</h2>

<ul>
 <li><a href="https://developer.mozilla.org/fr/docs/Web/API/Web_Audio_API">Web Audio API sur MDN</a></li>
 <li><a href="https://developer.mozilla.org/fr/docs/Web/HTML/Element/audio"><code>&lt;audio&gt;</code> sur MDN</a></li>
 <li><a href="http://www.html5rocks.com/en/tutorials/webaudio/games/">Developing Game Audio with the Web Audio API (HTML5Rocks) (en)</a></li>
 <li><a href="http://www.html5rocks.com/en/tutorials/webaudio/positional_audio/">Mixing Positional Audio and WebGL (HTML5Rocks) (en)</a></li>
 <li><a href="https://hacks.mozilla.org/2013/10/songs-of-diridum-pushing-the-web-audio-api-to-its-limits/">Songs of Diridum: Pushing the Web Audio API to Its Limits (en)</a></li>
 <li><a href="http://pupunzi.open-lab.com/2013/03/13/making-html5-audio-actually-work-on-mobile/">Making HTML5 Audio Actually Work on Mobile (en)</a></li>
 <li><a href="http://remysharp.com/2010/12/23/audio-sprites/">Audio Sprites (and fixes for iOS) (en)</a><br>
   </li>
</ul>
